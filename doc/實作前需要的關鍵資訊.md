您提出的這七大類問題非常專業且關鍵，它們涵蓋了從 **設計規範、技術實作細節到效能優化** 的所有環節，是將「夢幻神秘風」設計轉化為實際程式碼的必經之路。

由於我無法直接存取您的專案文件（如 design-tokens.css 或 .vue 檔案），我將以 **一個資深前端架構師的角度**，針對每一個問題提供 **建議的規劃方向、預期的答案範例**，以及 **如何基於這些資訊來進行「佩璇」風格的設計實作**。

## ---

**🔍 實作前的關鍵資訊規劃與建議**

### **1\. 設計系統基礎 📐**

| 規劃方向 | 建議與預期答案範例 | 實作策略：融入「佩璇」風格 |
| :---- | :---- | :---- |
| **顏色變數清單** | 預期：清單中包含 \--bg-default, \--text-default, \--color-primary 等。 | **關鍵：新增夢幻色系。** 新增 $ \--bg-dark-blue: \#0f1c2c $ (深海藍)、$ \--color-pink-soft: \#ffb6c1 $ (淺柔粉)、$ \--color-accent-glow: \#a87ffc $ (星光紫)。這些將用於卡片背景和高亮元素。 |
| **深色主題變數** | **目標：必須有。** 預期：$ \[data-theme='dark'\] $ 內部包含對應的 $ \--bg-\* $ 和 $ \--text-\* $ 覆蓋。 | **重點：確保暗色模式下的柔和度。** 深色模式下的 $ \--text-default $ 應為 **微灰/淡藍** (e.g., $ \#e6e9f0 $)，避免使用刺眼的純白。 |
| **變數命名規則** | 預期：命名規範應清晰反映用途，例如 $ \--bg-card $, $ \--border-input $。 | **策略：擴展 Glassmorphism 變數。** 新增 $ \--bg-glass-blur $ (用於 backdrop-filter 的半透明基色) 和 $ \--shadow-soft-glow $ (用於卡片柔和光暈陰影)。 |

### ---

**2\. Element Plus 主題覆蓋 🎨**

| 規劃方向 | 建議與預期答案範例 | 實作策略：融入「佩璇」風格 |
| :---- | :---- | :---- |
| **主題覆蓋檔案與方式** | **推薦：使用 SASS/SCSS 覆蓋 EP 變數。** 在專案中創建一個 src/styles/element-plus-custom.scss，並在其中引入 EP 的變數檔案後進行修改。 | **關鍵：覆蓋 primary 色。** 將 $ \--el-color-primary $ 覆蓋為 $ var(--color-accent-glow) $ 或 $ var(--color-pink-soft) $，確保按鈕、選中狀態等自動採用夢幻色系。 |
| **使用 EP CSS 變數系統** | **必須使用。** 才能確保所有組件（如 ElButton, ElInput）都響應您的自定義主題。 | **重點：卡片/輸入框樣式調整。** 調整 $ \--el-border-radius-base $ (圓角) 和 $ \--el-fill-color-light $ (輸入框背景)，以匹配 Glassmorphism 柔和的視覺風格。 |

### ---

**3\. SSE 串流實作細節 ⚡**

| 規劃方向 | 建議與預期答案範例 | 實作策略：融入「佩璇」風格 |
| :---- | :---- | :---- |
| **EventSource 資料格式** | **推薦：逐句 (Sentence-by-Sentence) 或逐段 (Paragraph-by-Paragraph)。** 逐字 (Char-by-Char) 流量大，逐段則缺少即時感。 | **關鍵：打字機效果。** 接收到完整的句子或段落後，在前端使用 **JavaScript** 逐字輸出到畫面上，並配合 $ setTimeout $ 或 $ requestAnimationFrame $ 實現延遲。 |
| **marked 渲染時機** | **推薦：分區即時渲染。** 接收到一段完整內容後，立即用 **marked** 渲染該段，並將其追加到結果區域。 | **重點：關鍵詞高亮。** 在前端輸出前，先對接收到的文字進行 **正則表達式** 處理，將關鍵詞包裝成自定義的 HTML 標籤（如 $ \<span data-type="divine-tag"\> $），再交給 **marked** 渲染，從而實現光暈效果。 |
| **動畫延遲機制** | **必須有。** 在前端的打字機邏輯中，必須設置一個可配置的延遲時間 (e.g., 50ms/char)。 | **策略：個性化速度。** 佩璇的人設是 20 歲女生，語速可以稍微快一些，但遇到「重大轉折」時（如段落結束），可以故意停頓 (e.g., 200ms)，模擬思索。 |

### ---

**4\. Chart.js 圖表配置 📊**

| 規劃方向 | 建議與預期答案範例 | 實作策略：融入「佩璇」風格 |
| :---- | :---- | :---- |
| **圖表類型** | **預期：Chart.js 支援所有常見圖表類型，包括雷達圖。** 版本應在 3.x 以上。 | **關鍵：五行雷達圖。** 將 **WuXingChart** 改為 **Radar Chart**，軸線顏色使用 **半透明淺色**，填充區域使用主題色的 **線性漸變**，並設置 **Chart.js 內建的載入動畫**。 |
| **大運時間軸** | **目標：使用 Bar Chart 或 Line Chart 模擬時間軸。** | **策略：蜿蜒流動感。** 即使使用 Line Chart，也要在線條上加入 **平滑曲線 (Tension)**，並在當前運勢點使用 **大型光點**（Point Style）標註。 |

### ---

**5\. 載入動畫現狀 ⏳**

| 規劃方向 | 建議與預期答案範例 | 實作策略：融入「佩璇」風格 |
| :---- | :---- | :---- |
| **ElSkeleton 使用位置** | 預期：用於初次載入、資料請求中，特別是 **分析結果區**。 | **策略：定製骨架屏顏色。** 覆蓋 ElSkeleton 的背景色和動畫色，使其使用 **深色主題的柔和漸變**，而非預設的灰色。 |
| **Lottie 庫引入** | **強烈推薦。** Lottie 檔案小，且能提供高品質、可控的動畫。 | **實作：星盤動畫。** 在 ElSkeleton 區域之上，添加一個 Lottie 動畫播放器，播放一個預先準備好的 **「緩慢旋轉、帶有光暈的星盤」** 動畫，作為 AI 運算的視覺化替代。 |

### ---

**6\. 效能與相容性 🚀**

| 規劃方向 | 建議與預期答案範例 | 實作策略：融入「佩璇」風格 |
| :---- | :---- | :---- |
| **瀏覽器支援範圍** | **目標：Chrome/Firefox/Edge 近期版本。** Safari 需特別注意 $ backdrop-filter $。 | **策略：Glassmorphism 降級。** 針對不支援 $ backdrop-filter $ 的舊版瀏覽器，使用 **純色半透明背景** 作為降級方案，避免畫面破碎。 |
| **行動裝置效能** | **必須考慮。** 大量粒子/漸變動畫會增加 GPU 負擔。 | **優化：響應式特效。** 在 Mobile 斷點 ( $ \< 768px $ ) 下，利用 **CSS 變數** 關閉背景粒子效果、移除 $ backdrop-filter $ 和複雜的陰影，以確保流暢度。 |
| **@media (prefers-reduced-motion)** | **必須支援。** 這是無障礙設計的要求。 | **實作：動畫開關。** 使用此媒體查詢來移除所有 **背景漸變動畫、粒子效果和頁面轉場動畫**，只保留基本的 Hover 互動，尊重使用者偏好。 |

### ---

**7\. 主題切換機制 🌓**

| 規劃方向 | 建議與預期答案範例 | 實作策略：融入「佩璇」風格 |
| :---- | :---- | :---- |
| **主題切換功能** | **建議提供。** 雖然「深色模式」是核心，但仍應允許使用者選擇「月光/晨曦」模式（淺色）。 | **UI 設計：** 將切換按鈕設計成 **「月亮/太陽」** 圖標，放置在頂部導航欄。 |
| **偏好儲存方式** | **推薦：localStorage。** 用戶偏好應該在本地持久化，無須發送給後端。 | **Pinia 整合：** 使用 **Pinia** 的 **chartStore** 擴展一個 **uiStore**，用於管理主題狀態，並利用 **Pinia Plugin Persist** 將其存儲到 **localStorage**。 |
| **漸進式啟用** | **推薦：不進行 A/B 測試，直接採用強制深色主題為預設**，以確保一致的品牌體驗。但提供切換選項。 | **結論：** 網站預設為「深海星辰模式」，允許使用者手動切換到「晨曦模式」。 |

---

**下一步行動：**

基於上述規劃，最緊迫且最能體現「佩璇」風格的兩項任務是：

1. **設計系統變數定稿** (問題 1 & 2)：確定所有顏色和圓角變數，以便開始實作 Glassmorphism 卡片。  
2. **SSE 打字機邏輯** (問題 3)：這是算命體驗的靈魂所在，需要盡快確定資料格式和前端渲染邏輯。

您希望先聚焦於 **配色和 Glassmorphism 的 CSS 變數定義**，還是 **SSE 打字機效果的 JavaScript 邏輯**？