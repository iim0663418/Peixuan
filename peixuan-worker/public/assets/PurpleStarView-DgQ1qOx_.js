var Oe=Object.defineProperty;var Fe=(z,d,g)=>d in z?Oe(z,d,{enumerable:!0,configurable:!0,writable:!0,value:g}):z[d]=g;var Pe=(z,d,g)=>Fe(z,typeof d!="symbol"?d+"":d,g);import{d as ue,r as j,m as Te,h as ge,p as xe,q as te,w as P,f as w,g as J,e as Y,t as s,c as a,b as h,F as T,l as M,s as de,v as je,x as $e,E as W,y as ze,o as t,a as e,n as O,_ as pe,j as q,z as ve,A as Le,B as Ge,C as Ve,i as Be,D as be,k as Re,G as Ue,H as Q,I as Ze,J as Xe,K as He,L as Ye,M as qe,N as Ke,O as Je,P as We,Q as Qe,R as et,S as tt,T as at,U as Ae}from"./index-BkKrQnZY.js";import{a as Ee,I as st,A as Me}from"./astrologyIntegrationService-CSw67lFs.js";import{S as nt}from"./StorageStatusIndicator-DeMNEoxz.js";class Se{static async geocodeAddress(d){var g,r;try{if(!d||d.trim().length===0)return{success:!1,candidates:[],error:"請輸入有效地址"};const v={SingleLine:d.trim(),f:"json",outSR:JSON.stringify({wkid:4326}),outFields:"Addr_type,Match_addr,StAddr,City",maxLocations:6},G=await Ee.get(this.BASE_URL,{params:v,timeout:1e4});if(!G.data||!G.data.candidates)return{success:!1,candidates:[],error:"API 回應格式錯誤"};const _=G.data.candidates.filter(B=>B.score>=60);return{success:!0,candidates:_,error:_.length===0?"找不到匹配的地址，請檢查地址格式":void 0}}catch(v){console.error("Geocoding API error:",v);let G="地址解析服務暫時無法使用，請稍後再試";return Ee.isAxiosError(v)&&(v.code==="ECONNABORTED"?G="請求超時，請檢查網路連線":((g=v.response)==null?void 0:g.status)===429?G="請求過於頻繁，請稍後再試":((r=v.response)==null?void 0:r.status)>=500&&(G="服務器錯誤，請稍後再試")),{success:!1,candidates:[],error:G}}}static formatCandidateForDisplay(d){const g=this.getAccuracyText(d.score);return`${d.attributes.Match_addr} (${g})`}static getAccuracyText(d){return d>=95?"準確":d>=80?"良好":d>=60?"模糊":"不準確"}static formatCoordinates(d,g){return{longitude:Number(d.toFixed(6)),latitude:Number(g.toFixed(6))}}}Pe(Se,"BASE_URL","https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates");const lt={key:0,class:"geocode-status",style:{"margin-top":"5px"}},ot=ue({__name:"PurpleStarInputForm",emits:["submit"],setup(z,{emit:d}){const g=d,r=j([{label:"亞洲/台北 (GMT+8)",value:"Asia/Taipei"},{label:"亞洲/上海 (GMT+8)",value:"Asia/Shanghai"},{label:"亞洲/香港 (GMT+8)",value:"Asia/Hong_Kong"},{label:"亞洲/東京 (GMT+9)",value:"Asia/Tokyo"},{label:"亞洲/首爾 (GMT+9)",value:"Asia/Seoul"},{label:"亞洲/新加坡 (GMT+8)",value:"Asia/Singapore"},{label:"澳洲/悉尼 (GMT+10)",value:"Australia/Sydney"},{label:"歐洲/倫敦 (GMT+0)",value:"Europe/London"},{label:"歐洲/巴黎 (GMT+1)",value:"Europe/Paris"},{label:"美洲/紐約 (GMT-5)",value:"America/New_York"},{label:"美洲/洛杉磯 (GMT-8)",value:"America/Los_Angeles"},{label:"美洲/溫哥華 (GMT-8)",value:"America/Vancouver"}]),v=Te({birthDate:"",birthTime:"",gender:"male",longitude:null,latitude:null,timezone:"Asia/Taipei"}),G=j(""),_=j(""),B=j(!1),f=j([]),S=j(null),$=Te({message:"",type:"info"});let C=null;const k=j([{label:"台北, 台灣",value:"taipei",longitude:121.5654,latitude:25.033,timezone:"Asia/Taipei"},{label:"高雄, 台灣",value:"kaohsiung",longitude:120.3014,latitude:22.6273,timezone:"Asia/Taipei"},{label:"台中, 台灣",value:"taichung",longitude:120.6736,latitude:24.1477,timezone:"Asia/Taipei"},{label:"上海, 中國",value:"shanghai",longitude:121.4737,latitude:31.2304,timezone:"Asia/Shanghai"},{label:"北京, 中國",value:"beijing",longitude:116.4074,latitude:39.9042,timezone:"Asia/Shanghai"},{label:"香港",value:"hongkong",longitude:114.1694,latitude:22.3193,timezone:"Asia/Hong_Kong"},{label:"東京, 日本",value:"tokyo",longitude:139.6917,latitude:35.6895,timezone:"Asia/Tokyo"},{label:"首爾, 韓國",value:"seoul",longitude:126.978,latitude:37.5665,timezone:"Asia/Seoul"},{label:"新加坡",value:"singapore",longitude:103.8198,latitude:1.3521,timezone:"Asia/Singapore"},{label:"倫敦, 英國",value:"london",longitude:-.1276,latitude:51.5074,timezone:"Europe/London"},{label:"紐約, 美國",value:"newyork",longitude:-74.006,latitude:40.7128,timezone:"America/New_York"},{label:"洛杉磯, 美國",value:"losangeles",longitude:-118.2437,latitude:34.0522,timezone:"America/Los_Angeles"}]),E=()=>{C&&clearTimeout(C),y(),f.value=[],S.value=null,!(!_.value||_.value.trim().length<3)&&(C=setTimeout(()=>{L()},800))},L=async()=>{if(!(!_.value||B.value)){B.value=!0,y();try{const A=await Se.geocodeAddress(_.value);A.success&&A.candidates.length>0?(f.value=A.candidates,A.candidates.length===1?(H(A.candidates[0]),c("地址解析成功！座標已自動填入","success")):c(`找到 ${A.candidates.length} 個匹配地址，請選擇最準確的`,"warning")):(c(A.error||"找不到匹配的地址，請檢查地址格式","danger"),f.value=[])}catch(A){console.error("Geocoding error:",A),c("地址解析失敗，請稍後再試","danger")}finally{B.value=!1}}},H=A=>{var n,p;const u=Se.formatCoordinates(A.location.x,A.location.y);v.longitude=u.longitude,v.latitude=u.latitude,((n=A.attributes.Match_addr)!=null&&n.includes("台灣")||(p=A.attributes.City)!=null&&p.includes("台")||A.location.x>119&&A.location.x<122&&A.location.y>21&&A.location.y<26)&&(v.timezone="Asia/Taipei")},D=A=>{f.value[A]&&(H(f.value[A]),c("座標已填入，請確認是否正確","success"),setTimeout(()=>{f.value=[f.value[A]]},1e3))},b=A=>Se.formatCandidateForDisplay(A),c=(A,u)=>{$.message=A,$.type=u},y=()=>{$.message="",$.type="info"},m=A=>{const u=k.value.find(n=>n.value===A);u&&(!_.value||f.value.length===0)&&(v.longitude=u.longitude,v.latitude=u.latitude,v.timezone=u.timezone,y())};ge(()=>{const A=xe();A&&A.timeZone&&(v.timezone=A.timeZone)});const x={birthDate:[{required:!0,message:"請選擇出生日期",trigger:"change"}],birthTime:[{required:!0,message:"請選擇出生時間",trigger:"change"}],gender:[{required:!0,message:"請選擇性別",trigger:"change"}],location:[{validator:(A,u,n)=>{if(v.longitude===null||v.longitude===void 0){n(new Error("請輸入出生地經度（可選擇城市自動填入）"));return}if(v.longitude<-180||v.longitude>180){n(new Error("經度必須在 -180 到 180 之間"));return}if(v.latitude===null||v.latitude===void 0){n(new Error("請輸入出生地緯度（可選擇城市自動填入）"));return}if(v.latitude<-90||v.latitude>90){n(new Error("緯度必須在 -90 到 90 之間"));return}if(!v.timezone){n(new Error("請選擇時區"));return}n()},trigger:"blur"}]},K=j(),ee=async()=>{if(K.value)try{if(await K.value.validate()){if(!v.birthDate||!v.birthTime||!v.gender){W.error("請填寫完整的出生資訊");return}const[u,n,p]=v.birthDate.split("-").map(Number),[V,I]=v.birthTime.split(":").map(Number);if(isNaN(u)||isNaN(n)||isNaN(p)||isNaN(V)||isNaN(I)){W.error("日期時間格式錯誤");return}if(typeof Solar>"u"||typeof Lunar>"u"){W.error("lunar-javascript 庫未正確載入，請重新整理頁面");return}console.log("農曆轉換輸入:",{year:u,month:n,day:p,hour:V,minute:I});const N=Solar.fromYmdHms(u,n,p,V,I,0).getLunar();if(ze(v.timezone,u),v.longitude===null||v.latitude===null){W.error("請提供完整的出生地理位置資訊（經度和緯度）");return}const Z={birthDate:v.birthDate,birthTime:v.birthTime,gender:v.gender,location:{longitude:v.longitude,latitude:v.latitude,timezone:v.timezone},lunarInfo:{year:N.getYear(),month:N.getMonth(),day:N.getDay(),hour:N.getHour(),yearGan:N.getYearGan(),yearZhi:N.getYearZhi(),monthGan:N.getMonthGan(),monthZhi:N.getMonthZhi(),dayGan:N.getDayGan(),dayZhi:N.getDayZhi(),timeGan:N.getTimeGan(),timeZhi:N.getTimeZhi(),yearInGanZhi:N.getYearInGanZhi(),monthInGanZhi:N.getMonthInGanZhi(),dayInGanZhi:N.getDayInGanZhi(),timeInGanZhi:N.getTimeInGanZhi()}};console.log("前端農曆轉換結果:",Z.lunarInfo),Z.lunarInfo.year&&!isNaN(Z.lunarInfo.year)&&Z.lunarInfo.month&&Z.lunarInfo.day?g("submit",Z):(console.error("農曆轉換結果無效:",Z.lunarInfo),W.error("農曆轉換失敗，請確認日期時間輸入正確"))}}catch(A){console.error("表單驗證或農曆轉換失敗:",A),W.error("農曆轉換或表單驗證失敗，請檢查輸入資料")}};return(A,u)=>{const n=J("el-form-item"),p=J("el-date-picker"),V=J("el-time-picker"),I=J("el-radio"),R=J("el-radio-group"),N=J("el-button"),Z=J("el-input"),le=J("el-text"),ae=J("el-option"),se=J("el-select"),me=J("el-col"),we=J("el-row"),ke=J("el-icon"),he=J("el-tooltip"),De=J("el-form");return t(),te(De,{ref_key:"purpleStarForm",ref:K,model:v,rules:x,onSubmit:$e(ee,["prevent"])},{default:P(()=>[w(n,{label:A.$t("astrology.purple_star_detail.form.title")},null,8,["label"]),w(n,{label:A.$t("astrology.purple_star_detail.form.birth_date"),prop:"birthDate"},{default:P(()=>[w(p,{modelValue:v.birthDate,"onUpdate:modelValue":u[0]||(u[0]=X=>v.birthDate=X),type:"date",placeholder:A.$t("astrology.purple_star_detail.form.birth_date"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),w(n,{label:A.$t("astrology.purple_star_detail.form.birth_time"),prop:"birthTime"},{default:P(()=>[w(V,{modelValue:v.birthTime,"onUpdate:modelValue":u[1]||(u[1]=X=>v.birthTime=X),placeholder:A.$t("astrology.purple_star_detail.form.birth_time"),format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),w(n,{label:A.$t("astrology.purple_star_detail.form.gender"),prop:"gender"},{default:P(()=>[w(R,{modelValue:v.gender,"onUpdate:modelValue":u[2]||(u[2]=X=>v.gender=X)},{default:P(()=>[w(I,{value:"male"},{default:P(()=>[Y(s(A.$t("form.genderOptions.male")),1)]),_:1}),w(I,{value:"female"},{default:P(()=>[Y(s(A.$t("form.genderOptions.female")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),w(n,{label:"出生地址（自動轉換座標）"},{default:P(()=>[w(Z,{modelValue:_.value,"onUpdate:modelValue":u[3]||(u[3]=X=>_.value=X),placeholder:"請輸入中文地址，例如：雲林縣虎尾鎮新生路74號",onInput:E,loading:B.value,clearable:""},{append:P(()=>[w(N,{onClick:L,loading:B.value,disabled:!_.value,type:"primary"},{default:P(()=>u[9]||(u[9]=[Y(" 查詢座標 ")])),_:1,__:[9]},8,["loading","disabled"])]),_:1},8,["modelValue","loading"]),$.message?(t(),a("div",lt,[w(le,{type:$.type,size:"small"},{default:P(()=>[Y(s($.message),1)]),_:1},8,["type"])])):h("",!0),f.value.length>1?(t(),te(se,{key:1,modelValue:S.value,"onUpdate:modelValue":u[4]||(u[4]=X=>S.value=X),placeholder:"發現多個匹配地址，請選擇最準確的",onChange:D,style:{width:"100%","margin-top":"8px"}},{default:P(()=>[(t(!0),a(T,null,M(f.value,(X,fe)=>(t(),te(ae,{key:fe,label:b(X),value:fe},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])):h("",!0)]),_:1}),w(n,{label:"出生地點座標（精確計算必需）",prop:"location"},{default:P(()=>[w(we,{gutter:12},{default:P(()=>[w(me,{span:10},{default:P(()=>[w(Z,{modelValue:v.longitude,"onUpdate:modelValue":u[5]||(u[5]=X=>v.longitude=X),modelModifiers:{number:!0},placeholder:"經度",type:"number",min:-180,max:180,step:1e-6},{prepend:P(()=>u[10]||(u[10]=[Y("經度")])),_:1},8,["modelValue"])]),_:1}),w(me,{span:10},{default:P(()=>[w(Z,{modelValue:v.latitude,"onUpdate:modelValue":u[6]||(u[6]=X=>v.latitude=X),modelModifiers:{number:!0},placeholder:"緯度",type:"number",min:-90,max:90,step:1e-6},{prepend:P(()=>u[11]||(u[11]=[Y("緯度")])),_:1},8,["modelValue"])]),_:1}),w(me,{span:4},{default:P(()=>[w(se,{modelValue:v.timezone,"onUpdate:modelValue":u[7]||(u[7]=X=>v.timezone=X),filterable:"",placeholder:"時區",style:{width:"100%"}},{default:P(()=>[(t(!0),a(T,null,M(r.value,X=>(t(),te(ae,{key:X.value,label:X.label,value:X.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),w(le,{type:"warning",size:"small",style:{"margin-top":"5px",display:"block"}},{default:P(()=>[u[12]||(u[12]=Y(" ⚠️ 精確的經緯度和時區資訊對紫微斗數計算準確性至關重要 ")),w(he,{content:"可輸入中文地址自動轉換，或手動輸入經緯度座標"},{default:P(()=>[w(ke,null,{default:P(()=>[w(de(je))]),_:1})]),_:1})]),_:1,__:[12]})]),_:1}),w(n,{label:"或選擇常用城市（自動填入座標）"},{default:P(()=>[w(se,{modelValue:G.value,"onUpdate:modelValue":u[8]||(u[8]=X=>G.value=X),filterable:"",placeholder:"選擇城市快速填入座標",style:{width:"100%"},onChange:m,clearable:""},{default:P(()=>[(t(!0),a(T,null,M(k.value,X=>(t(),te(ae,{key:X.value,label:X.label,value:X.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),w(n,null,{default:P(()=>[w(N,{type:"primary",onClick:ee},{default:P(()=>[Y(s(A.$t("form.submit")),1)]),_:1})]),_:1})]),_:1},8,["model"])}}}),rt={class:"star-brightness-indicator"},it=["title"],ct=ue({__name:"StarBrightnessIndicator",props:{brightness:{}},setup(z){const d=g=>({廟:"星曜最強勢，能量發揮到極致",旺:"星曜強勢，表現優異",得地:"星曜穩定，表現良好",利益:"星曜平穩，有一定助益",平和:"星曜中性，影響適中",不得地:"星曜較弱，影響有限",落陷:"星曜最弱，需要調和"})[g||""]||"亮度未知";return(g,r)=>(t(),a("div",rt,[e("span",{class:O(["brightness-badge",`brightness-${g.brightness}`]),title:d(g.brightness)},s(g.brightness),11,it)]))}}),Ie=pe(ct,[["__scopeId","data-v-41ae3d7c"]]),dt={class:"pattern-analysis-panel"},ut={class:"panel-header"},pt={class:"arrow"},vt={key:0,class:"panel-content"},mt={key:0,class:"patterns-overview"},gt={class:"patterns-count"},ht={class:"count-badge"},ft={class:"patterns-types"},yt={class:"type-count"},_t={class:"patterns-list"},bt={class:"pattern-header"},$t={class:"pattern-description"},kt={class:"pattern-impact"},St={class:"impact-level"},wt={class:"impact-bars"},Dt={key:1,class:"no-patterns"},Ct={key:2,class:"pattern-advice"},At={class:"advice-content"},Et={key:0,class:"advice-section positive"},It={key:1,class:"advice-section cautionary"},Pt=ue({__name:"PatternAnalysisPanel",props:{patterns:{}},setup(z){const d=z,g=j(!0),r=()=>{g.value=!g.value},v=k=>k.split("：")[0]||k,G=k=>{const E=k.split("：");return E.length>1?E[1]:"格局描述未提供"},_=k=>{const E=v(k),L=["紫府夾命格","左右夾命格","文昌文曲格","財蔭夾印格","殺破狼格","機月同梁格"],H=["日月反背格","火鈴夾命格","羊陀夾命格","空劫夾命格"];return L.some(D=>E.includes(D))?"auspicious":H.some(D=>E.includes(D))?"inauspicious":"neutral"},B=k=>({auspicious:"吉格",inauspicious:"凶格",neutral:"中性格局"})[k]||"未知",f=k=>{const E=v(k);return["殺破狼格","機月同梁格","日月反背格"].some(L=>E.includes(L))?5:["紫府夾命格","左右夾命格","火鈴夾命格","羊陀夾命格"].some(L=>E.includes(L))?4:["文昌文曲格","空劫夾命格"].some(L=>E.includes(L))?3:2},S=q(()=>{if(!d.patterns)return[];const k={auspicious:{name:"吉格",count:0,type:"auspicious"},inauspicious:{name:"凶格",count:0,type:"inauspicious"},neutral:{name:"中性",count:0,type:"neutral"}};return d.patterns.forEach(E=>{const L=_(E);k[L]&&k[L].count++}),Object.values(k).filter(E=>E.count>0)}),$=q(()=>{var k;return((k=d.patterns)==null?void 0:k.some(E=>_(E)==="auspicious"))||!1}),C=q(()=>{var k;return((k=d.patterns)==null?void 0:k.some(E=>_(E)==="inauspicious"))||!1});return(k,E)=>(t(),a("div",dt,[e("div",ut,[E[0]||(E[0]=e("h3",null,[e("span",{class:"icon"},"🔮"),Y(" 格局分析 ")],-1)),e("button",{onClick:r,class:O(["expand-button",{expanded:g.value}])},[e("span",null,s(g.value?"收起":"展開"),1),e("span",pt,s(g.value?"▲":"▼"),1)],2)]),g.value?(t(),a("div",vt,[k.patterns&&k.patterns.length>0?(t(),a("div",mt,[e("div",gt,[e("span",ht,s(k.patterns.length),1),E[1]||(E[1]=e("span",{class:"count-text"},"個格局特徵",-1))]),e("div",ft,[(t(!0),a(T,null,M(S.value,L=>(t(),a("div",{key:L.type,class:"pattern-type-summary"},[e("span",{class:O(["type-indicator",`type-${L.type}`])},s(L.name),3),e("span",yt,s(L.count),1)]))),128))])])):h("",!0),e("div",_t,[(t(!0),a(T,null,M(k.patterns,(L,H)=>(t(),a("div",{key:`pattern-${H}`,class:"pattern-item"},[e("div",bt,[e("span",{class:O(["pattern-name",`pattern-${_(L)}`])},s(v(L)),3),e("span",{class:O(["pattern-badge",`badge-${_(L)}`])},s(B(_(L))),3)]),e("div",$t,s(G(L)),1),e("div",kt,[e("div",St,[E[2]||(E[2]=e("span",{class:"impact-label"},"影響程度：",-1)),e("div",wt,[(t(),a(T,null,M(5,D=>e("div",{key:D,class:O(["impact-bar",{active:D<=f(L)}])},null,2)),64))])])])]))),128))]),!k.patterns||k.patterns.length===0?(t(),a("div",Dt,E[3]||(E[3]=[ve('<div class="no-patterns-icon" data-v-2d3b48db>📋</div><p class="no-patterns-text" data-v-2d3b48db> 此命盤未發現明顯的特殊格局，屬於一般格局類型。 <br data-v-2d3b48db> 這代表您的人生道路相對平穩，可以透過努力學習和積累來創造成就。 <br data-v-2d3b48db> 請參考星曜亮度和雜曜分析來了解個人特質。 </p><div class="no-patterns-explanation" data-v-2d3b48db><h4 data-v-2d3b48db>💡 一般格局的優勢：</h4><ul data-v-2d3b48db><li data-v-2d3b48db>人生較少極端起伏，能夠穩健發展</li><li data-v-2d3b48db>有更大的自主空間來塑造自己的命運</li><li data-v-2d3b48db>可以透過後天努力來彌補先天的不足</li><li data-v-2d3b48db>較容易適應環境變化，具有彈性</li></ul></div>',3)]))):h("",!0),k.patterns&&k.patterns.length>0?(t(),a("div",Ct,[E[7]||(E[7]=e("h4",null,"格局建議",-1)),e("div",At,[$.value?(t(),a("div",Et,E[4]||(E[4]=[e("span",{class:"advice-icon"},"✨",-1),e("p",null,"命盤中的吉格為您帶來天賦優勢，建議善用這些特質來發展事業和人際關係。",-1)]))):h("",!0),C.value?(t(),a("div",It,E[5]||(E[5]=[e("span",{class:"advice-icon"},"⚠️",-1),e("p",null,"注意命盤中的挑戰格局，透過自我修煉和智慧決策可以化解不利影響。",-1)]))):h("",!0),E[6]||(E[6]=e("div",{class:"advice-section general"},[e("span",{class:"advice-icon"},"💡"),e("p",null,"格局分析提供人生方向的參考，最終的成就仍需要個人努力和正確的選擇。")],-1))])])):h("",!0)])):h("",!0)]))}}),Tt=pe(Pt,[["__scopeId","data-v-2d3b48db"]]),Mt={class:"minor-stars-panel"},Lt={class:"panel-header"},Gt={class:"panel-controls"},Vt={key:0,class:"panel-content"},Nt={class:"minor-stars-summary"},Ot={class:"summary-stats"},Ft={class:"stat-item"},xt={class:"stat-number"},jt={class:"stat-item"},zt={class:"stat-number"},Bt={class:"stat-item"},Rt={class:"stat-number"},Ut={class:"stat-item"},Zt={class:"stat-number"},Xt={class:"category-tabs"},Ht=["onClick"],Yt={class:"tab-count"},qt={class:"minor-stars-list"},Kt={class:"star-info"},Jt={class:"star-header"},Wt={class:"star-location"},Qt={class:"palace-name"},ea={class:"palace-zhi"},ta={class:"star-description"},aa={key:0,class:"star-influence"},sa={class:"influence-content"},na={key:1,class:"star-transformations"},la={key:0,class:"minor-stars-impact"},oa={class:"impact-content"},ra={key:0,class:"impact-positive"},ia={key:1,class:"impact-negative"},ca={class:"impact-suggestions"},da={key:1,class:"no-minor-stars"},ua={key:0,class:"no-stars-explanation"},pa=ue({__name:"MinorStarsPanel",props:{palaces:{}},setup(z){const d=z,g=j(!1),r=j("all"),v=()=>{g.value=!g.value},G=D=>{const b={桃花:["天姚","紅鸞","天喜","咸池"],文藝:["龍池","鳳閣","天才","天壽"],德星:["天德","月德","解神"],煞星:["擎羊","陀羅","火星","鈴星","天刑","孤辰","寡宿","天月","陰煞"],其他:["天馬","天巫","台輔","封誥"]};for(const[c,y]of Object.entries(b))if(y.includes(D))return c;return"其他"},_=D=>({all:"全部",桃花:"桃花",文藝:"文藝",德星:"德星",煞星:"煞星",其他:"其他"})[D]||D,B=q(()=>{const D=[];return d.palaces.forEach(b=>{b.stars.forEach(c=>{c.type==="minor"&&D.push({star:c,palace:b})})}),D}),f=q(()=>r.value==="all"?B.value:B.value.filter(D=>G(D.star.name)===r.value)),S=q(()=>{const D=new Set(["all"]);return B.value.forEach(b=>{D.add(G(b.star.name))}),Array.from(D)}),$=D=>D==="all"?B.value.length:B.value.filter(b=>G(b.star.name)===D).length,C=q(()=>{const D={beneficial:0,malefic:0,neutral:0};return f.value.forEach(b=>{switch(b.star.attribute){case"吉":D.beneficial++;break;case"凶":D.malefic++;break;default:D.neutral++}}),D}),k=D=>{var m;const{star:b,palace:c}=D;return((m={天馬:{遷移宮:"增強外出運勢，利於旅行發展",官祿宮:"事業有變動機會，宜主動出擊"},天姚:{夫妻宮:"感情豐富，桃花運旺，需注意感情處理",命宮:"人緣佳，具有魅力，易得異性緣"},紅鸞:{夫妻宮:"婚姻運佳，感情順利，有喜慶之事",子女宮:"子女緣分深厚，家庭和樂"},天喜:{命宮:"人生多喜事，個性樂觀開朗",福德宮:"精神愉悦，享受生活樂趣"},龍池:{命宮:"具有藝術天賦，品味高雅",官祿宮:"工作與文藝創作相關，才華出眾"},鳳閣:{命宮:"具有美感，追求精緻生活",夫妻宮:"配偶有藝術氣質，夫妻生活優雅"},天德:{命宮:"有貴人相助，能逢凶化吉",疾厄宮:"身體健康，疾病易癒"},月德:{命宮:"心地善良，常得人助",父母宮:"與長輩關係良好，得到庇佑"}}[b.name])==null?void 0:m[c.name])||""},E=q(()=>{const D=[];return f.value.forEach(b=>{if(b.star.attribute==="吉")switch(G(b.star.name)){case"桃花":D.push("人際關係和諧，感情運勢良好");break;case"文藝":D.push("具有藝術天賦，品味高雅");break;case"德星":D.push("道德品格高尚，能獲得庇佑");break}}),[...new Set(D)]}),L=q(()=>{const D=[];return f.value.forEach(b=>{if(b.star.attribute==="凶"){switch(G(b.star.name)){case"煞星":D.push("需要注意人際關係，避免衝突");break}switch(b.star.name){case"孤辰":case"寡宿":D.push("容易感到孤獨，需主動建立社交圈");break;case"擎羊":case"陀羅":D.push("行事需謹慎，避免急躁冒進");break;case"火星":case"鈴星":D.push("情緒容易激動，需要冷靜處理問題");break}}}),[...new Set(D)]}),H=()=>{const D=C.value.beneficial,b=C.value.malefic;return D>b?"雜曜整體影響偏向正面，建議善用這些星曜帶來的特殊才能和機會。":b>D?"需要特別注意雜曜帶來的挑戰，透過修養和智慧來化解不利影響。":"雜曜影響平衡，關鍵在於如何運用智慧來趨吉避凶。"};return(D,b)=>(t(),a("div",Mt,[e("div",Lt,[b[2]||(b[2]=e("h3",null,[e("span",{class:"icon"},"⭐"),Y(" 雜曜分析 ")],-1)),e("div",Gt,[Le(e("select",{"onUpdate:modelValue":b[0]||(b[0]=c=>r.value=c),class:"category-selector"},b[1]||(b[1]=[ve('<option value="all" data-v-c3b2e4e7>全部雜曜</option><option value="桃花" data-v-c3b2e4e7>桃花類</option><option value="文藝" data-v-c3b2e4e7>文藝類</option><option value="德星" data-v-c3b2e4e7>德星類</option><option value="煞星" data-v-c3b2e4e7>煞星類</option><option value="其他" data-v-c3b2e4e7>其他類</option>',6)]),512),[[Ge,r.value]]),e("button",{onClick:v,class:O(["expand-button",{expanded:g.value}])},s(g.value?"收起":"展開"),3)])]),g.value?(t(),a("div",Vt,[e("div",Nt,[e("div",Ot,[e("div",Ft,[e("span",xt,s(f.value.length),1),b[3]||(b[3]=e("span",{class:"stat-label"},"顆雜曜",-1))]),e("div",jt,[e("span",zt,s(C.value.beneficial),1),b[4]||(b[4]=e("span",{class:"stat-label"},"吉星",-1))]),e("div",Bt,[e("span",Rt,s(C.value.malefic),1),b[5]||(b[5]=e("span",{class:"stat-label"},"凶星",-1))]),e("div",Ut,[e("span",Zt,s(C.value.neutral),1),b[6]||(b[6]=e("span",{class:"stat-label"},"中性",-1))])])]),e("div",Xt,[(t(!0),a(T,null,M(S.value,c=>(t(),a("button",{key:c,onClick:y=>r.value=c,class:O(["category-tab",{active:r.value===c}])},[Y(s(_(c))+" ",1),e("span",Yt,s($(c)),1)],10,Ht))),128))]),e("div",qt,[(t(!0),a(T,null,M(f.value,c=>(t(),a("div",{key:`${c.star.name}-${c.palace.name}`,class:"minor-star-item"},[e("div",Kt,[e("div",Jt,[e("span",{class:O(["star-name",`star-${c.star.attribute}`])},s(c.star.name),3),c.star.brightness?(t(),te(Ie,{key:0,brightness:c.star.brightness},null,8,["brightness"])):h("",!0),e("span",{class:O(["star-category-badge",`category-${G(c.star.name)}`])},s(_(G(c.star.name))),3)]),e("div",Wt,[b[7]||(b[7]=e("span",{class:"location-label"},"位於",-1)),e("span",Qt,s(c.palace.name),1),e("span",ea,s(c.palace.zhi)+"宮",1)]),e("div",ta,s(c.star.description),1),k(c)?(t(),a("div",aa,[b[8]||(b[8]=e("div",{class:"influence-header"},[e("span",{class:"influence-icon"},"💫"),e("span",{class:"influence-title"},"特殊影響")],-1)),e("div",sa,s(k(c)),1)])):h("",!0),c.star.transformations&&c.star.transformations.length>0?(t(),a("div",na,[b[9]||(b[9]=e("span",{class:"transformations-label"},"四化：",-1)),(t(!0),a(T,null,M(c.star.transformations,y=>(t(),a("span",{key:y,class:O(["transformation-badge",`transformation-${y}`])},s(y),3))),128))])):h("",!0)])]))),128))]),f.value.length>0?(t(),a("div",la,[b[13]||(b[13]=e("h4",null,"雜曜綜合影響",-1)),e("div",oa,[E.value.length>0?(t(),a("div",ra,[b[10]||(b[10]=e("h5",null,"正面影響",-1)),e("ul",null,[(t(!0),a(T,null,M(E.value,c=>(t(),a("li",{key:c},s(c),1))),128))])])):h("",!0),L.value.length>0?(t(),a("div",ia,[b[11]||(b[11]=e("h5",null,"需要注意",-1)),e("ul",null,[(t(!0),a(T,null,M(L.value,c=>(t(),a("li",{key:c},s(c),1))),128))])])):h("",!0),e("div",ca,[b[12]||(b[12]=e("h5",null,"建議",-1)),e("p",null,s(H()),1)])])])):h("",!0),f.value.length===0?(t(),a("div",da,[b[15]||(b[15]=e("div",{class:"no-stars-icon"},"🌟",-1)),e("p",null,s(r.value==="all"?"此命盤中未發現雜曜，這是正常情況。":`此命盤中未發現${_(r.value)}雜曜。`),1),r.value==="all"?(t(),a("div",ua,b[14]||(b[14]=[e("h4",null,"💡 沒有雜曜的意義：",-1),e("ul",null,[e("li",null,"生活相對簡單純粹，較少複雜的干擾因素"),e("li",null,"人生發展主要依靠主星的力量和個人努力"),e("li",null,"避免了某些雜曜可能帶來的負面影響"),e("li",null,"有更大的空間來發展自己的潛能")],-1)]))):h("",!0)])):h("",!0)])):h("",!0)]))}}),va=pe(pa,[["__scopeId","data-v-c3b2e4e7"]]),ma={class:"empty-palace-indicator"},ga={key:0,class:"borrowed-info"},ha={class:"borrowed-palace"},fa={class:"palace-name"},ya={class:"borrowed-stars"},_a={class:"star-name"},ba={key:1,class:"tooltip"},$a={class:"tooltip-content"},ka={key:0},Sa=ue({__name:"EmptyPalaceIndicator",props:{borrowedPalace:{},showTooltip:{type:Boolean,default:!1}},setup(z){return(d,g)=>(t(),a("div",ma,[g[5]||(g[5]=e("div",{class:"empty-badge"},[e("span",{class:"empty-icon"},"○"),e("span",{class:"empty-text"},"空宮")],-1)),d.borrowedPalace?(t(),a("div",ga,[g[1]||(g[1]=e("div",{class:"borrowed-label"},"借星",-1)),e("div",ha,[e("span",fa,s(d.borrowedPalace.name),1),e("div",ya,[(t(!0),a(T,null,M(d.borrowedPalace.mainStars,r=>(t(),a("div",{key:r.name,class:"borrowed-star"},[e("span",_a,s(r.name),1),r.brightness?(t(),te(Ie,{key:0,brightness:r.brightness},null,8,["brightness"])):h("",!0),g[0]||(g[0]=e("span",{class:"power-reduction"},"7成",-1))]))),128))])])])):h("",!0),d.showTooltip?(t(),a("div",ba,[e("div",$a,[g[2]||(g[2]=e("h4",null,"空宮說明",-1)),g[3]||(g[3]=e("p",null,"此宮位無主星，需借用對宮星曜進行分析。",-1)),d.borrowedPalace?(t(),a("p",ka," 借用【"+s(d.borrowedPalace.name)+"】的星曜，影響力約為七成。 ",1)):h("",!0),g[4]||(g[4]=e("div",{class:"interpretation-note"}," 空宮並非不好，而是代表此領域需要更多主動創造與學習。 ",-1))])])):h("",!0)]))}}),wa=pe(Sa,[["__scopeId","data-v-68400fec"]]),Da={class:"guide-content"},Ca={class:"guide-tabs desktop-tabs"},Aa=["onClick"],Ea={class:"tab-icon"},Ia={class:"tab-title full-title"},Pa={class:"tab-title short-title"},Ta={class:"mobile-tab-selector"},Ma=["value"],La={class:"current-tab-display"},Ga={class:"current-icon"},Va={class:"current-title"},Na={class:"tab-content"},Oa={key:0,class:"guide-section"},Fa={class:"brightness-levels"},xa={class:"level-info"},ja={class:"level-example"},za={key:1,class:"guide-section"},Ba={key:2,class:"guide-section"},Ra={key:3,class:"guide-section"},Ua=ue({__name:"PurpleStarGuideModal",props:{visible:{type:Boolean}},emits:["close"],setup(z,{emit:d}){const g=d,r=j("brightness"),v=[{id:"brightness",title:"星曜亮度",icon:"✨"},{id:"patterns",title:"格局分析",icon:"🔮"},{id:"empty",title:"空宮借星",icon:"○"},{id:"minor",title:"雜曜分析",icon:"⭐"}],G=[{name:"廟",title:"廟 - 最強勢",description:"星曜在此位置能量發揮到極致，如神明在廟中受到最高敬仰",meaning:"天賦異稟，在此領域有卓越表現，容易成為佼佼者"},{name:"旺",title:"旺 - 強勢",description:"星曜力量強大，表現優異，如春天萬物旺盛生長",meaning:"在此領域有優勢，努力就能獲得很好的成果"},{name:"得地",title:"得地 - 穩定",description:"星曜在適合的位置，表現穩定良好",meaning:"適合穩定發展，按部就班能有不錯的成就"},{name:"利益",title:"利益 - 平穩",description:"星曜表現平穩，有一定的助益",meaning:"需要努力才能見到成效，但付出會有回報"},{name:"平和",title:"平和 - 中性",description:"星曜影響適中，不特別強也不特別弱",meaning:"需要借助其他力量來加強，或通過學習來提升"},{name:"不得地",title:"不得地 - 較弱",description:"星曜在此位置較難發揮，影響有限",meaning:"需要加倍努力，或尋求他人協助來改善"},{name:"落陷",title:"落陷 - 最弱",description:"星曜力量最弱，需要調和與化解",meaning:"此領域是挑戰所在，需要特別的智慧和修養來轉化"}],_=()=>{g("close")},B=()=>v.find(S=>S.id===r.value)||v[0],f=S=>({星曜亮度:"亮度",格局分析:"格局",空宮借星:"空宮",雜曜分析:"雜曜"})[S]||S;return(S,$)=>S.visible?(t(),a("div",{key:0,class:"guide-modal-overlay",onClick:_},[e("div",{class:"guide-modal",onClick:$[1]||($[1]=$e(()=>{},["stop"]))},[e("div",{class:"guide-header"},[$[2]||($[2]=e("h2",null,"🔮 紫微斗數進階功能指南",-1)),e("button",{onClick:_,class:"close-button"},"×")]),e("div",Da,[e("div",Ca,[(t(),a(T,null,M(v,C=>e("button",{key:C.id,onClick:k=>r.value=C.id,class:O(["tab-button",{active:r.value===C.id}])},[e("span",Ea,s(C.icon),1),e("span",Ia,s(C.title),1),e("span",Pa,s(f(C.title)),1)],10,Aa)),64))]),e("div",Ta,[Le(e("select",{"onUpdate:modelValue":$[0]||($[0]=C=>r.value=C),class:"mobile-select"},[(t(),a(T,null,M(v,C=>e("option",{key:C.id,value:C.id},s(C.icon)+" "+s(C.title),9,Ma)),64))],512),[[Ge,r.value]]),e("div",La,[e("span",Ga,s(B().icon),1),e("span",Va,s(B().title),1)])]),e("div",Na,[r.value==="brightness"?(t(),a("div",Oa,[$[4]||($[4]=e("h3",null,"✨ 星曜亮度（廟旺陷落）",-1)),$[5]||($[5]=e("div",{class:"guide-intro"},[e("p",null,"星曜亮度是紫微斗數中評估星曜力量強弱的重要指標，就像星星在不同位置有不同的亮度一樣。")],-1)),e("div",Fa,[(t(),a(T,null,M(G,C=>e("div",{key:C.name,class:"level-item"},[e("span",{class:O(["level-badge",`brightness-${C.name}`])},s(C.name),3),e("div",xa,[e("h4",null,s(C.title),1),e("p",null,s(C.description),1),e("div",ja,[$[3]||($[3]=e("strong",null,"實際意義：",-1)),Y(s(C.meaning),1)])])])),64))]),$[6]||($[6]=ve('<div class="guide-tips" data-v-1e1e449c><h4 data-v-1e1e449c>💡 如何運用亮度資訊：</h4><ul data-v-1e1e449c><li data-v-1e1e449c><strong data-v-1e1e449c>廟、旺</strong>的星曜：發揮這些星曜的正面特質，是您的天賦優勢</li><li data-v-1e1e449c><strong data-v-1e1e449c>得地、利益</strong>：穩定發展的領域，適合長期投入</li><li data-v-1e1e449c><strong data-v-1e1e449c>平和</strong>：需要外力協助或後天努力來加強</li><li data-v-1e1e449c><strong data-v-1e1e449c>不得地、落陷</strong>：需要特別注意，透過學習和修養來改善</li></ul></div>',1))])):h("",!0),r.value==="patterns"?(t(),a("div",za,$[7]||($[7]=[ve('<h3 data-v-1e1e449c>🔮 格局分析</h3><div class="guide-intro" data-v-1e1e449c><p data-v-1e1e449c>格局是指命盤中星曜的特殊組合，就像音樂中的和弦一樣，不同的組合會產生不同的效果。</p></div><div class="pattern-types" data-v-1e1e449c><div class="pattern-type" data-v-1e1e449c><span class="pattern-badge auspicious" data-v-1e1e449c>吉格</span><div class="pattern-info" data-v-1e1e449c><h4 data-v-1e1e449c>吉利格局</h4><p data-v-1e1e449c>這些格局帶來正面的能量和機會，是您人生中的幸運模式。</p><div class="pattern-examples" data-v-1e1e449c><strong data-v-1e1e449c>常見吉格：</strong>紫府夾命格、左右夾命格、文昌文曲格等 </div></div></div><div class="pattern-type" data-v-1e1e449c><span class="pattern-badge inauspicious" data-v-1e1e449c>凶格</span><div class="pattern-info" data-v-1e1e449c><h4 data-v-1e1e449c>挑戰格局</h4><p data-v-1e1e449c>這些格局提醒您注意潛在的挑戰，透過智慧和努力可以化解。</p><div class="pattern-examples" data-v-1e1e449c><strong data-v-1e1e449c>常見凶格：</strong>火鈴夾命格、羊陀夾命格、日月反背格等 </div></div></div><div class="pattern-type" data-v-1e1e449c><span class="pattern-badge neutral" data-v-1e1e449c>中性格局</span><div class="pattern-info" data-v-1e1e449c><h4 data-v-1e1e449c>平衡格局</h4><p data-v-1e1e449c>這些格局較為中性，影響取決於其他因素和個人的運用方式。</p></div></div></div><div class="guide-tips" data-v-1e1e449c><h4 data-v-1e1e449c>💡 格局解讀要點：</h4><ul data-v-1e1e449c><li data-v-1e1e449c>格局是命盤的「主旋律」，影響人生的大方向</li><li data-v-1e1e449c>吉格要善用，凶格要化解，中性格局要用智慧引導</li><li data-v-1e1e449c>多個格局並存時，要綜合分析其相互影響</li><li data-v-1e1e449c>格局提供方向，但最終成就仍需要個人努力</li></ul></div>',4)]))):h("",!0),r.value==="empty"?(t(),a("div",Ba,$[8]||($[8]=[ve('<h3 data-v-1e1e449c>○ 空宮與借星</h3><div class="guide-intro" data-v-1e1e449c><p data-v-1e1e449c>空宮是指某個宮位沒有主星駐守，就像一間空房子。但在紫微斗數中，空宮可以「借用」對面宮位的星曜。</p></div><div class="empty-palace-concept" data-v-1e1e449c><div class="concept-item" data-v-1e1e449c><h4 data-v-1e1e449c>🏠 什麼是空宮？</h4><p data-v-1e1e449c>當某個宮位沒有主星（紫微、天機、太陽等14顆主星）時，就稱為空宮。</p></div><div class="concept-item" data-v-1e1e449c><h4 data-v-1e1e449c>⭐ 借星機制</h4><p data-v-1e1e449c>空宮可以借用正對面宮位的主星來進行分析，但影響力約為原本的七成。</p><div class="borrowing-example" data-v-1e1e449c><div class="example-palace" data-v-1e1e449c>命宮（空宮）</div><div class="arrow" data-v-1e1e449c>←借星←</div><div class="example-palace" data-v-1e1e449c>遷移宮（有主星）</div></div></div><div class="concept-item" data-v-1e1e449c><h4 data-v-1e1e449c>💪 空宮的意義</h4><p data-v-1e1e449c>空宮並非不好，而是代表這個領域需要：</p><ul data-v-1e1e449c><li data-v-1e1e449c><strong data-v-1e1e449c>主動學習</strong> - 沒有天生的優勢，需要後天努力</li><li data-v-1e1e449c><strong data-v-1e1e449c>創造機會</strong> - 要主動爭取，不能被動等待</li><li data-v-1e1e449c><strong data-v-1e1e449c>借助外力</strong> - 可以從對宮或他人身上學習</li><li data-v-1e1e449c><strong data-v-1e1e449c>彈性發展</strong> - 有更多可能性和變化空間</li></ul></div></div><div class="guide-tips" data-v-1e1e449c><h4 data-v-1e1e449c>💡 空宮應對策略：</h4><ul data-v-1e1e449c><li data-v-1e1e449c>不要害怕空宮，它代表更大的發展潛力</li><li data-v-1e1e449c>多學習對宮星曜的正面特質</li><li data-v-1e1e449c>主動出擊，不要等待機會自己來</li><li data-v-1e1e449c>借助他人的力量和經驗來成長</li></ul></div>',4)]))):h("",!0),r.value==="minor"?(t(),a("div",Ra,$[9]||($[9]=[ve('<h3 data-v-1e1e449c>⭐ 雜曜分析</h3><div class="guide-intro" data-v-1e1e449c><p data-v-1e1e449c>雜曜是輔助性的星曜，雖然力量不如主星強大，但能為命盤增添特殊的色彩和細節。</p></div><div class="minor-star-categories" data-v-1e1e449c><div class="category-item" data-v-1e1e449c><span class="category-badge peach" data-v-1e1e449c>桃花類</span><div class="category-info" data-v-1e1e449c><h4 data-v-1e1e449c>桃花雜曜</h4><p data-v-1e1e449c>影響人際關係、魅力、感情運勢</p><div class="star-examples" data-v-1e1e449c>如：天姚、紅鸞、天喜、咸池</div></div></div><div class="category-item" data-v-1e1e449c><span class="category-badge art" data-v-1e1e449c>文藝類</span><div class="category-info" data-v-1e1e449c><h4 data-v-1e1e449c>文藝雜曜</h4><p data-v-1e1e449c>增強藝術天分、品味、創造力</p><div class="star-examples" data-v-1e1e449c>如：龍池、鳳閣、天才、天壽</div></div></div><div class="category-item" data-v-1e1e449c><span class="category-badge virtue" data-v-1e1e449c>德星類</span><div class="category-info" data-v-1e1e449c><h4 data-v-1e1e449c>德星雜曜</h4><p data-v-1e1e449c>帶來貴人運、化解災難、道德品格</p><div class="star-examples" data-v-1e1e449c>如：天德、月德、解神</div></div></div><div class="category-item" data-v-1e1e449c><span class="category-badge malefic" data-v-1e1e449c>煞星類</span><div class="category-info" data-v-1e1e449c><h4 data-v-1e1e449c>煞星雜曜</h4><p data-v-1e1e449c>提醒注意的挑戰和障礙</p><div class="star-examples" data-v-1e1e449c>如：擎羊、陀羅、火星、鈴星</div></div></div></div><div class="guide-tips" data-v-1e1e449c><h4 data-v-1e1e449c>💡 雜曜運用原則：</h4><ul data-v-1e1e449c><li data-v-1e1e449c><strong data-v-1e1e449c>輔助參考</strong> - 雜曜是主星的補充，不是主要依據</li><li data-v-1e1e449c><strong data-v-1e1e449c>特殊才能</strong> - 關注文藝、桃花類雜曜帶來的特殊天賦</li><li data-v-1e1e449c><strong data-v-1e1e449c>趨吉避凶</strong> - 善用德星化解煞星的負面影響</li><li data-v-1e1e449c><strong data-v-1e1e449c>平衡發展</strong> - 不要因雜曜而忽視主星的重要性</li></ul></div>',4)]))):h("",!0)])]),$[10]||($[10]=e("div",{class:"guide-footer"},[e("div",{class:"footer-note"},[e("p",null,"💡 提示：這些進階功能幫助您更深入理解命盤，但請記住，命運掌握在自己手中！")])],-1))])])):h("",!0)}}),Za=pe(Ua,[["__scopeId","data-v-1e1e449c"]]),Xa={class:"feature-hints-display"},Ha={key:0,class:"brightness-hints"},Ya=["onClick","title"],qa={class:"hint-text"},Ka={key:1,class:"pattern-hints"},Ja=["onClick","title"],Wa={class:"hint-text"},Qa=["title"],es={key:0,class:"borrowed-hint"},ts={class:"borrowed-text"},as={key:3,class:"minor-star-hints"},ss=["onClick","title"],ns={class:"hint-text"},ls={class:"tooltip-header"},os={class:"tooltip-content"},rs={class:"tooltip-description"},is={key:0,class:"tooltip-influence"},cs={key:1,class:"tooltip-advice"},ds=ue({__name:"FeatureHintsDisplay",props:{palace:{},position:{},isEmpty:{type:Boolean},borrowedInfo:{}},setup(z){const d=z,g=j(!1),r=j({title:"",description:"",influence:"",advice:""}),v=j("top"),G=q(()=>{if(!d.palace)return[];const u=[];return d.palace.stars.forEach(n=>{n.brightness&&["廟","旺","落陷"].includes(n.brightness)&&u.push({star:n.name,level:n.brightness})}),u.slice(0,2)}),_=q(()=>{if(!d.palace)return[];const u=[],n=d.palace.stars.map(p=>p.name);return n.includes("紫微")&&n.includes("天府")&&u.push({type:"auspicious",description:"紫府同宮"}),n.includes("左輔")&&n.includes("右弼")&&u.push({type:"auspicious",description:"左右同宮"}),n.includes("文昌")&&n.includes("文曲")&&u.push({type:"auspicious",description:"昌曲同宮"}),u.slice(0,1)}),B=q(()=>{if(!d.palace)return[];const u=[],n=d.palace.stars.filter(V=>V.type==="minor"),p={桃花:["天姚","紅鸞","天喜","咸池"],文藝:["龍池","鳳閣","天才","天壽"],德星:["天德","月德","解神"],煞星:["擎羊","陀羅","火星","鈴星"]};for(const[V,I]of Object.entries(p))n.some(N=>I.includes(N.name))&&u.push({category:V.toLowerCase(),description:`${V}雜曜`});return u.slice(0,1)}),f=(u,n)=>{switch(u){case"brightness":r.value={title:`${n.star} - ${n.level}`,description:H(n.level),influence:D(n.level),advice:b(n.level)};break;case"pattern":r.value={title:n.description,description:c(n.description),influence:y(n.description),advice:m(n.description)};break;case"empty":r.value={title:"空宮",description:"本宮沒有主星，需要借對宮的星曜來論命。",influence:"空宮代表該領域需要更多主動創造和努力。",advice:n.borrowedInfo?`可借用${n.borrowedInfo.name}的星曜特質。`:"需要主動開創該領域的運勢。"};break;case"minor":r.value={title:n.description,description:x(n.category),influence:K(n.category),advice:ee(n.category)};break}v.value=$(),g.value=!0},S=()=>{g.value=!1},$=()=>"center",C=u=>`點擊查看 ${u.star}${u.level} 的詳細說明`,k=u=>`點擊查看 ${u.description} 格局的詳細說明`,E=()=>"點擊查看空宮的詳細說明",L=u=>`點擊查看 ${u.description} 的詳細說明`,H=u=>({廟:"星曜在此位置力量最強，發揮最佳效果。",旺:"星曜在此位置力量強盛，運作良好。",落陷:"星曜在此位置力量較弱，需要其他因素輔助。"})[u]||"",D=u=>({廟:"正面影響力最大，吉星更吉，凶星減凶。",旺:"正面影響力強，整體運勢提升。",落陷:"影響力減弱，需要配合其他星曜發揮作用。"})[u]||"",b=u=>({廟:"可充分發揮該星曜的特質，積極行動。",旺:"善用星曜優勢，把握機會。",落陷:"需要更多努力和配合，不宜過度依賴。"})[u]||"",c=u=>({紫府同宮:"紫微星與天府星同在一宮，為帝王格局之一。",左右同宮:"左輔右弼同宮，增強輔助力量。",昌曲同宮:"文昌文曲同宮，利於學習和文藝發展。"})[u]||"特殊星曜組合，具有獨特影響力。",y=u=>({紫府同宮:"具有領導能力和權威性，適合管理職位。",左右同宮:"人際關係良好，容易得到他人幫助。",昌曲同宮:"學習能力強，文藝天分高。"})[u]||"帶來正面的綜合影響。",m=u=>({紫府同宮:"可朝向領導管理方向發展，培養領袖氣質。",左右同宮:"多與人合作，善用人際網絡。",昌曲同宮:"加強學習和創作，發展文藝才能。"})[u]||"善用格局優勢，積極發展。",x=u=>({桃花:"與感情、人緣、異性緣相關的雜曜。",文藝:"與才華、藝術、創作能力相關的雜曜。",德星:"與道德、品格、貴人相關的雜曜。",煞星:"帶有阻礙、挑戰意義的雜曜。"})[u]||"特殊類型的雜曜。",K=u=>({桃花:"增強人際魅力，但需注意感情問題。",文藝:"提升創作才能和藝術天分。",德星:"帶來貴人運和正面品格。",煞星:"可能帶來挑戰，但也是成長機會。"})[u]||"帶來特殊的影響力。",ee=u=>({桃花:"保持適度社交，理性處理感情。",文藝:"多培養藝術興趣，發展創作能力。",德星:"保持正面品格，善待他人。",煞星:"化挑戰為動力，提升抗壓能力。"})[u]||"善用特質，平衡發展。",A=u=>{u.key==="Escape"&&S()};return ge(()=>{document.addEventListener("keydown",A)}),Ve(()=>{document.removeEventListener("keydown",A)}),(u,n)=>(t(),a("div",Xa,[G.value.length>0?(t(),a("div",Ha,[(t(!0),a(T,null,M(G.value,p=>(t(),a("div",{key:p.star,class:O(["brightness-hint",`brightness-${p.level}`]),onClick:V=>f("brightness",p),title:C(p)},[n[2]||(n[2]=e("span",{class:"hint-icon"},"✨",-1)),e("span",qa,s(p.star)+s(p.level),1),n[3]||(n[3]=e("span",{class:"info-indicator"},"ⓘ",-1))],10,Ya))),128))])):h("",!0),_.value.length>0?(t(),a("div",Ka,[(t(!0),a(T,null,M(_.value,p=>(t(),a("div",{key:p.type,class:O(["pattern-hint",`pattern-${p.type}`]),onClick:V=>f("pattern",p),title:k(p)},[n[4]||(n[4]=e("span",{class:"hint-icon"},"🔮",-1)),e("span",Wa,s(p.description),1),n[5]||(n[5]=e("span",{class:"info-indicator"},"ⓘ",-1))],10,Ja))),128))])):h("",!0),u.isEmpty?(t(),a("div",{key:2,class:"empty-palace-hint",onClick:n[0]||(n[0]=p=>f("empty",{borrowedInfo:u.borrowedInfo})),title:E()},[n[6]||(n[6]=e("span",{class:"hint-icon"},"○",-1)),n[7]||(n[7]=e("span",{class:"hint-text"},"空宮",-1)),u.borrowedInfo?(t(),a("div",es,[e("span",ts,"借"+s(u.borrowedInfo.name),1)])):h("",!0),n[8]||(n[8]=e("span",{class:"info-indicator"},"ⓘ",-1))],8,Qa)):h("",!0),B.value.length>0?(t(),a("div",as,[(t(!0),a(T,null,M(B.value,p=>(t(),a("div",{key:p.category,class:O(["minor-star-hint",`minor-${p.category}`]),onClick:V=>f("minor",p),title:L(p)},[n[9]||(n[9]=e("span",{class:"hint-icon"},"⭐",-1)),e("span",ns,s(p.description),1),n[10]||(n[10]=e("span",{class:"info-indicator"},"ⓘ",-1))],10,ss))),128))])):h("",!0),g.value?(t(),a("div",{key:4,class:O(["feature-tooltip",v.value]),onClick:n[1]||(n[1]=$e(()=>{},["stop"]))},[e("div",ls,[e("h4",null,s(r.value.title),1),e("button",{onClick:S,class:"close-tooltip"},"×")]),e("div",os,[e("p",rs,s(r.value.description),1),r.value.influence?(t(),a("div",is,[n[11]||(n[11]=e("strong",null,"影響：",-1)),Y(s(r.value.influence),1)])):h("",!0),r.value.advice?(t(),a("div",cs,[n[12]||(n[12]=e("strong",null,"建議：",-1)),Y(s(r.value.advice),1)])):h("",!0)])],2)):h("",!0),g.value?(t(),a("div",{key:5,class:"tooltip-backdrop",onClick:S})):h("",!0)]))}}),us=pe(ds,[["__scopeId","data-v-76599eae"]]),ps={class:"purple-star-chart-container"},vs={key:0,class:"loading-state"},ms={key:1,class:"error-state"},gs={key:2,class:"chart-content"},hs={class:"chart-header"},fs={class:"header-actions"},ys={key:1,class:"chart-summary"},_s={class:"summary-header"},bs={class:"summary-content"},$s={class:"summary-features"},ks={class:"feature-text"},Ss={class:"summary-detailed"},ws={key:0,class:"interaction-hint"},Ds={class:"hint-content"},Cs={class:"hint-text-container"},As={class:"hint-text"},Es={class:"swipe-hint"},Is={key:2,class:"show-summary-button-container"},Ps=["onClick"],Ts={key:0,class:"palace-center"},Ms={class:"center-info"},Ls={key:0},Gs={class:"palace-header"},Vs={class:"palace-name"},Ns={class:"palace-zhi"},Os={key:0,class:"ming-indicator"},Fs={key:1,class:"shen-indicator"},xs={class:"stars-container"},js=["onClick","title"],zs={class:"star-name"},Bs={key:3,class:"star-type-badge minor"},Rs={key:0,class:"feature-hints"},Us={key:1,class:"cycles-info"},Zs={key:0,class:"da-xian-info"},Xs={key:1,class:"xiao-xian-info"},Hs={key:3,class:"interpretation-section"},Ys={class:"interpretation-header"},qs={class:"interpretation-tabs"},Ks={key:2,class:"comprehensive-interpretation"},Js={class:"interpretation-card"},Ws={class:"interpretation-card"},Qs={class:"interpretation-card"},en={class:"interpretation-card"},tn={class:"interpretation-card"},an={key:0,class:"interpretation-card"},sn={class:"interpretation-card"},nn={class:"lifecycle-grid"},ln={class:"lifecycle-period"},on={class:"lifecycle-content"},rn={class:"lifecycle-theme"},cn={class:"lifecycle-focus"},dn={class:"interpretation-card"},un={key:3,class:"domain-analysis"},pn={class:"domain-tabs"},vn=["onClick"],mn={key:0,class:"domain-content"},gn={class:"domain-header"},hn={class:"domain-insights"},fn={class:"domain-influences"},yn={class:"domain-actions"},_n={class:"domain-periods"},bn={class:"periods-column"},$n={class:"periods-column"},kn={key:4,class:"palace-interpretation"},Sn={class:"palace-tabs"},wn=["onClick"],Dn={key:0,class:"palace-content"},Cn={class:"palace-section"},An={class:"trait-tags"},En={class:"palace-section"},In={class:"palace-section"},Pn={class:"palace-section"},Tn={class:"palace-section"},Mn={class:"palace-section"},Ln={key:4,class:"cycles-detail"},Gn={class:"cycles-detail-header"},Vn={class:"cycles-grid"},Nn={class:"cycle-header"},On={class:"cycle-age"},Fn={class:"cycle-palace"},xn={class:"cycle-zhi"},jn={class:"cycle-description"},zn={class:"modal-header"},Bn={class:"modal-body"},Rn={class:"star-attributes-section"},Un={key:0,class:"attribute-item"},Zn={key:1,class:"attribute-item"},Xn={class:"attribute-tag"},Hn={key:2,class:"attribute-item"},Yn={class:"attribute-tag"},qn={key:3,class:"attribute-item"},Kn={class:"attribute-tag"},Jn={key:0,class:"star-description"},Wn={key:1},Qn=ue({__name:"PurpleStarChartDisplay",props:{chartData:{default:null},calculationInfo:{default:null},isLoading:{type:Boolean,default:!1},error:{default:null},showCyclesDetail:{type:Boolean,default:!1}},emits:["retry","palaceClick","starClick","export"],setup(z,{emit:d}){const{t:g}=Be(),r=z,v=d,G=j("detailed");j("expanded");const _=j(null),B=j(null),f=j(!0),S=j(!0),$=j(!1),C=j("comprehensive"),k=j("career"),E=j(""),L=q(()=>{var ye,_e;if(!r.chartData||!r.chartData.palaces||!Array.isArray(r.chartData.palaces))return null;const l=r.chartData.palaces.flatMap(U=>U.stars&&Array.isArray(U.stars)?U.stars.filter(ne=>ne.type==="main"||ne.transformations&&ne.transformations.length):[]),o={吉:l.filter(U=>U.attribute==="吉").length,凶:l.filter(U=>U.attribute==="凶").length,中性:l.filter(U=>U.attribute==="中性").length},i=(ye=r.chartData.palaces[r.chartData.mingPalaceIndex])==null?void 0:ye.stars.some(U=>U.type==="main"&&U.attribute==="吉"),F=l.filter(U=>{var ne;return(ne=U.transformations)==null?void 0:ne.length}).length,oe=[];o.吉>o.凶?oe.push("吉星較多，整體運勢偏向正面"):o.凶>o.吉?oe.push("凶星較多，人生挑戰較大"):oe.push("吉凶星均衡，順逆交替"),i&&oe.push("命宮有吉星入駐，基礎運勢良好"),F>3&&oe.push("四化星豐富，命盤變化較大");const re=r.chartData.palaces[r.chartData.mingPalaceIndex];if(re){const U=re.stars.filter(Ce=>Ce.type==="main");U.length>2&&oe.push("命宮聚集多顆主星，命運變化豐富"),U.some(Ce=>Ce.name.includes("紫微"))&&oe.push("紫微星入命，具有領導才能與權威性")}let ce="";if((_e=r.chartData.comprehensiveInterpretation)!=null&&_e.overallLifePattern)ce=r.chartData.comprehensiveInterpretation.overallLifePattern;else{const U=(re==null?void 0:re.name)||"命宮",ne=o.吉>o.凶?"較為順遂":o.凶>o.吉?"較多挑戰":"順逆參半";ce=`此命盤以${U}為中心，整體運勢${ne}。命盤中共有${l.length}顆主要星曜，其中吉星${o.吉}顆，凶星${o.凶}顆。在紫微斗數的十二宮位結構中，每個宮位代表人生不同領域，宮位中的星曜組合則揭示了各領域的特質與發展。透過分析命宮、財帛宮、官祿宮等關鍵宮位的星曜組合，可進一步了解命主的潛能與挑戰。`}return{features:oe,detailedSummary:ce}}),H=q(()=>{var l;return(l=r.chartData)!=null&&l.domainAnalyses&&r.chartData.domainAnalyses.find(o=>o.domain===k.value)||null}),D=q(()=>{var l;return!((l=r.chartData)!=null&&l.palaceInterpretations)||!E.value?null:r.chartData.palaceInterpretations.find(o=>o.palaceName===E.value)||null}),b=["巳","午","未","申","辰","center","center","酉","卯","center","center","戌","寅","丑","子","亥"],c=l=>{if(!(!r.chartData||l==="center"))return r.chartData.palaces.find(o=>o.zhi===l)},y=(l,o)=>{const i=[`grid-position-${o}`];return l==="center"?i.push("center-position"):(i.push(`zhi-${l}`),K(l)&&i.push("ming-palace"),ee(l)&&i.push("shen-palace")),i.join(" ")},m=l=>{const o=["star-item",`star-${l.type}`];return l.transformations&&l.transformations.forEach(i=>{o.push(`transform-${i}`)}),o},x=l=>{let o=`${l.name} (${g(`purpleStarChart.starTypes.${l.type}`)})`;return l.brightness&&(o+=` - 亮度: ${l.brightness}`),l.attribute&&(o+=` - 屬性: ${l.attribute}`),l.transformations&&l.transformations.length>0&&(o+=` - 四化: ${l.transformations.map(i=>i).join(", ")}`),l.description&&(o+=`
${l.description}`),o},K=l=>{if(!r.chartData||!r.chartData.palaces||!Array.isArray(r.chartData.palaces)||typeof r.chartData.mingPalaceIndex!="number"||r.chartData.mingPalaceIndex<0||r.chartData.mingPalaceIndex>=r.chartData.palaces.length)return!1;const o=r.chartData.palaces[r.chartData.mingPalaceIndex];return o&&o.zhi===l},ee=l=>{if(!r.chartData||!r.chartData.palaces||!Array.isArray(r.chartData.palaces)||typeof r.chartData.shenPalaceIndex!="number"||r.chartData.shenPalaceIndex<0||r.chartData.shenPalaceIndex>=r.chartData.palaces.length)return!1;const o=r.chartData.palaces[r.chartData.shenPalaceIndex];return o&&o.zhi===l},A=()=>{if(!r.chartData||!r.chartData.palaces||!Array.isArray(r.chartData.palaces)||typeof r.chartData.mingPalaceIndex!="number"||r.chartData.mingPalaceIndex<0||r.chartData.mingPalaceIndex>=r.chartData.palaces.length)return"";const l=r.chartData.palaces[r.chartData.mingPalaceIndex];return(l==null?void 0:l.name)||""},u=()=>{if(!r.chartData||!r.chartData.palaces||!Array.isArray(r.chartData.palaces)||typeof r.chartData.shenPalaceIndex!="number"||r.chartData.shenPalaceIndex<0||r.chartData.shenPalaceIndex>=r.chartData.palaces.length)return"";const l=r.chartData.palaces[r.chartData.shenPalaceIndex];return(l==null?void 0:l.name)||""},n=l=>{var o;if((o=r.chartData)!=null&&o.daXian)return r.chartData.daXian.find(i=>i.palaceZhi===l)},p=l=>{var o;if((o=r.chartData)!=null&&o.xiaoXian)return r.chartData.xiaoXian.find(i=>i.palaceZhi===l)},V=l=>`${l.startAge}-${l.endAge}${g("purpleStarChart.years")}`,I=l=>`${l.age}${g("purpleStarChart.years")}`,R=l=>!1,N=l=>{if(!r.chartData)return"";const o=r.chartData.palaces.find(i=>i.index===l.palaceIndex);return(o==null?void 0:o.name)||""},Z=l=>{const o=c(l);return o?o.stars.filter(F=>F.type==="main").length===0:!1},le=l=>{var re;const o=c(l);if(!o||!Z(l))return;const i=(o.index+6)%12,F=(re=r.chartData)==null?void 0:re.palaces.find(ce=>ce.index===i);if(!F)return;const oe=F.stars.filter(ce=>ce.type==="main");return{name:F.name,mainStars:oe}},ae=l=>!l||!l.fortuneType?"":`palace-fortune-${l.fortuneType}`,se=l=>({命宮:"個人特質與基本運勢",兄弟宮:"手足關係與朋友圈",夫妻宮:"婚姻與伴侶關係",子女宮:"後代與創造力",財帛宮:"財富與物質生活",疾厄宮:"健康與困境",遷移宮:"居所變動與旅行",交友宮:"人際關係與合作",官祿宮:"事業成就與社會地位",田宅宮:"不動產與居家環境",福德宮:"內在幸福與精神追求",父母宮:"長輩關係與根源"})[l]||"人生特定領域",me=l=>{if(l==="center")return;const o=c(l);o&&(B.value=o,v("palaceClick",o))},we=l=>{_.value=l,v("starClick",l)},ke=()=>{_.value=null},he=l=>{C.value=l},De=l=>{k.value=l},X=l=>{E.value=l},fe=l=>({career:"事業分析",wealth:"財富分析",marriage:"婚姻分析",health:"健康分析",education:"學業分析",social:"人際分析"})[l]||l,Ne=l=>({excellent:"極佳",good:"良好",neutral:"中性",challenging:"挑戰",difficult:"困難"})[l]||l;return ge(()=>{const l=document.querySelector(".chart-grid");document.querySelectorAll(".palace-cell").forEach(o=>{o.classList.remove("depth-minimal","depth-compact","depth-standard","depth-comprehensive"),o.classList.add("depth-comprehensive")}),l&&(l.classList.remove("simple"),l.classList.add("detailed")),document.querySelectorAll(".cycles-info").forEach(o=>{o.style.display="block"}),document.querySelectorAll(".star-item").forEach(o=>{o.style.opacity="1"}),document.querySelectorAll(".palace-cell").forEach(o=>{o.style.pointerEvents="auto"})}),be(()=>r.chartData,l=>{l&&(_.value=null,C.value="comprehensive",l.domainAnalyses&&l.domainAnalyses.length>0&&(k.value=l.domainAnalyses[0].domain),l.palaceInterpretations&&l.palaceInterpretations.length>0&&(E.value=l.palaceInterpretations[0].palaceName))}),(l,o)=>(t(),a("div",ps,[l.isLoading?(t(),a("div",vs,[o[10]||(o[10]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(l.$t("purpleStarChart.loading")),1)])):l.error?(t(),a("div",ms,[o[11]||(o[11]=e("div",{class:"error-icon"},"⚠️",-1)),e("h3",null,s(l.$t("purpleStarChart.loadError")),1),e("p",null,s(l.error),1),e("button",{onClick:o[0]||(o[0]=i=>l.$emit("retry")),class:"retry-button"},s(l.$t("purpleStarChart.retry")),1)])):l.chartData?(t(),a("div",gs,[h("",!0),e("div",hs,[e("h2",null,s(l.$t("purpleStarChart.title")),1),e("div",fs,[e("button",{onClick:o[1]||(o[1]=i=>$.value=!0),class:"guide-button"},o[13]||(o[13]=[e("span",{class:"guide-icon"},"💡",-1),Y(" 進階功能說明 ")]))])]),S.value&&L.value?(t(),a("div",ys,[e("div",_s,[e("h3",null,s(l.$t("purpleStarChart.chartSummary")),1),e("button",{onClick:o[2]||(o[2]=i=>S.value=!S.value),class:"toggle-summary-button"},s(l.$t("purpleStarChart.hideSummary")),1)]),e("div",bs,[e("div",$s,[(t(!0),a(T,null,M(L.value.features,(i,F)=>(t(),a("div",{key:`feature-${F}`,class:"feature-item"},[o[14]||(o[14]=e("span",{class:"feature-icon"},"✧",-1)),e("span",ks,s(i),1)]))),128))]),e("div",Ss,[e("p",null,s(L.value.detailedSummary),1)]),f.value?(t(),a("div",ws,[e("div",Ds,[o[16]||(o[16]=e("span",{class:"hint-icon"},"💡",-1)),e("div",Cs,[e("span",As,s(l.$t("purpleStarChart.interactionTips.comprehensive")),1),e("span",Es,[Y(s(l.$t("purpleStarChart.interactionTipDesc"))+" ",1),o[15]||(o[15]=e("span",{class:"swipe-arrow"},"↔️",-1))])]),e("button",{onClick:o[3]||(o[3]=i=>f.value=!1),class:"close-hint"},"×")])])):h("",!0)])])):L.value?(t(),a("div",Is,[e("button",{onClick:o[4]||(o[4]=i=>S.value=!0),class:"show-summary-button"},s(l.$t("purpleStarChart.showSummary")),1)])):h("",!0),e("div",{class:O(["chart-grid",G.value])},[(t(),a(T,null,M(b,(i,F)=>{var oe,re,ce,ye,_e;return e("div",{key:`position-${F}`,class:O(["palace-cell",y(i,F)]),onClick:U=>me(i)},[i==="center"?(t(),a("div",Ts,[e("h4",null,s(l.$t("purpleStarChart.centerPalace")),1),e("div",Ms,[l.chartData.fiveElementsBureau?(t(),a("p",Ls,s(l.chartData.fiveElementsBureau),1)):h("",!0),e("p",null,s(l.$t("purpleStarChart.mingPalace"))+": "+s(A()),1),e("p",null,s(l.$t("purpleStarChart.shenPalace"))+": "+s(u()),1)])])):c(i)?(t(),a("div",{key:1,class:O(["palace-content",ae(c(i))])},[e("div",Gs,[e("span",Vs,s((oe=c(i))==null?void 0:oe.name),1),e("span",Ns,s(i),1),K(i)?(t(),a("span",Os,"命")):h("",!0),ee(i)?(t(),a("span",Fs,"身")):h("",!0),(re=c(i))!=null&&re.fortuneType?(t(),a("span",{key:2,class:O(["fortune-indicator",`fortune-${(ce=c(i))==null?void 0:ce.fortuneType}`])},s((ye=c(i))==null?void 0:ye.fortuneType),3)):h("",!0)]),e("div",xs,[Z(i)?(t(),te(wa,{key:0,"borrowed-palace":le(i),class:"empty-palace-indicator"},null,8,["borrowed-palace"])):h("",!0),(t(!0),a(T,null,M((_e=c(i))==null?void 0:_e.stars,U=>(t(),a("div",{key:U.name,class:O(m(U)),onClick:$e(ne=>we(U),["stop"]),title:x(U)},[e("span",zs,s(U.name),1),U.brightness?(t(),te(Ie,{key:0,brightness:U.brightness},null,8,["brightness"])):h("",!0),U.transformations&&U.transformations.length>0?(t(),a("span",{key:1,class:O(["transformations",{"detailed-transformations":G.value==="detailed"}])},[(t(!0),a(T,null,M(U.transformations,ne=>(t(),a("span",{key:ne,class:O(`transformation-${ne}`)},s(ne),3))),128))],2)):h("",!0),U.attribute?(t(),a("span",{key:2,class:O(["star-attribute",`attribute-${U.attribute}`])},s(U.attribute),3)):h("",!0),U.type==="minor"?(t(),a("span",Bs," 雜 ")):h("",!0)],10,js))),128))]),G.value==="detailed"?(t(),a("div",Rs,[w(us,{palace:c(i),position:i,"is-empty":Z(i),"borrowed-info":le(i)},null,8,["palace","position","is-empty","borrowed-info"])])):h("",!0),G.value==="detailed"?(t(),a("div",Us,[n(i)?(t(),a("div",Zs,[e("small",null,s(V(n(i))),1)])):h("",!0),p(i)?(t(),a("div",Xs,[e("small",null,s(I(p(i))),1)])):h("",!0)])):h("",!0)],2)):h("",!0)],10,Ps)}),64))],2),l.chartData.comprehensiveInterpretation||l.chartData.domainAnalyses?(t(),a("div",Hs,[e("div",Ys,[e("h3",null,s(l.$t("purpleStarChart.interpretation")||"命盤解讀"),1),e("div",qs,[e("button",{onClick:o[5]||(o[5]=i=>he("comprehensive")),class:O([{active:C.value==="comprehensive"},"tab-button"])}," 綜合解讀 ",2),e("button",{onClick:o[6]||(o[6]=i=>he("domain")),class:O([{active:C.value==="domain"},"tab-button"])}," 領域分析 ",2),e("button",{onClick:o[7]||(o[7]=i=>he("palace")),class:O([{active:C.value==="palace"},"tab-button"])}," 宮位解讀 ",2)])]),C.value==="comprehensive"?(t(),te(Tt,{key:0,patterns:l.chartData.keyPatterns,class:"interpretation-panel"},null,8,["patterns"])):h("",!0),C.value==="comprehensive"?(t(),te(va,{key:1,palaces:l.chartData.palaces,class:"interpretation-panel"},null,8,["palaces"])):h("",!0),C.value==="comprehensive"&&l.chartData.comprehensiveInterpretation?(t(),a("div",Ks,[e("div",Js,[o[17]||(o[17]=e("h4",null,"整體生命模式",-1)),e("p",null,s(l.chartData.comprehensiveInterpretation.overallLifePattern),1)]),e("div",Ws,[o[18]||(o[18]=e("h4",null,"生命目的",-1)),e("p",null,s(l.chartData.comprehensiveInterpretation.lifePurpose),1)]),e("div",Qs,[o[19]||(o[19]=e("h4",null,"靈性成長路徑",-1)),e("p",null,s(l.chartData.comprehensiveInterpretation.spiritualGrowthPath),1)]),e("div",en,[o[20]||(o[20]=e("h4",null,"獨特優勢",-1)),e("ul",null,[(t(!0),a(T,null,M(l.chartData.comprehensiveInterpretation.uniqueStrengths,(i,F)=>(t(),a("li",{key:`strength-${F}`},s(i),1))),128))])]),e("div",tn,[o[21]||(o[21]=e("h4",null,"潛在挑戰",-1)),e("ul",null,[(t(!0),a(T,null,M(l.chartData.comprehensiveInterpretation.potentialChallenges,(i,F)=>(t(),a("li",{key:`challenge-${F}`},s(i),1))),128))])]),l.chartData.comprehensiveInterpretation.keyCrossPalacePatterns&&l.chartData.comprehensiveInterpretation.keyCrossPalacePatterns.length>0?(t(),a("div",an,[o[22]||(o[22]=e("h4",null,"關鍵跨宮位模式",-1)),e("ul",null,[(t(!0),a(T,null,M(l.chartData.comprehensiveInterpretation.keyCrossPalacePatterns,(i,F)=>(t(),a("li",{key:`pattern-${F}`},s(i),1))),128))])])):h("",!0),e("div",sn,[o[23]||(o[23]=e("h4",null,"主要生命週期",-1)),e("div",nn,[(t(!0),a(T,null,M(l.chartData.comprehensiveInterpretation.majorLifeCycles,(i,F)=>(t(),a("div",{key:`cycle-${F}`,class:"lifecycle-item"},[e("div",ln,s(i.period),1),e("div",on,[e("div",rn,s(i.theme),1),e("div",cn,"主題："+s(i.focus),1)])]))),128))])]),e("div",dn,[o[24]||(o[24]=e("h4",null,"關鍵命盤模式",-1)),e("ul",null,[(t(!0),a(T,null,M(l.chartData.comprehensiveInterpretation.keyCrossPalacePatterns,(i,F)=>(t(),a("li",{key:`pattern-${F}`},s(i),1))),128))])])])):h("",!0),C.value==="domain"&&l.chartData.domainAnalyses?(t(),a("div",un,[e("div",pn,[(t(!0),a(T,null,M(l.chartData.domainAnalyses,i=>(t(),a("button",{key:i.domain,onClick:F=>De(i.domain),class:O([{active:k.value===i.domain},"domain-tab-button"])},s(fe(i.domain)),11,vn))),128))]),H.value?(t(),a("div",mn,[e("div",gn,[e("h4",null,s(fe(H.value.domain)),1),e("div",{class:O(`fortune-badge fortune-${H.value.overallFortune}`)},s(Ne(H.value.overallFortune)),3)]),e("div",hn,[o[25]||(o[25]=e("h5",null,"關鍵洞見",-1)),e("ul",null,[(t(!0),a(T,null,M(H.value.keyInsights,(i,F)=>(t(),a("li",{key:`insight-${F}`},s(i),1))),128))])]),e("div",fn,[o[26]||(o[26]=e("h5",null,"星曜影響",-1)),e("ul",null,[(t(!0),a(T,null,M(H.value.starInfluences,(i,F)=>(t(),a("li",{key:`influence-${F}`},s(i),1))),128))])]),e("div",yn,[o[27]||(o[27]=e("h5",null,"建議行動",-1)),e("ul",null,[(t(!0),a(T,null,M(H.value.recommendedActions,(i,F)=>(t(),a("li",{key:`action-${F}`},s(i),1))),128))])]),e("div",_n,[e("div",bn,[o[28]||(o[28]=e("h5",null,"有利時期",-1)),e("ul",null,[(t(!0),a(T,null,M(H.value.periods.favorable,(i,F)=>(t(),a("li",{key:`favorable-${F}`},s(i),1))),128))])]),e("div",$n,[o[29]||(o[29]=e("h5",null,"挑戰時期",-1)),e("ul",null,[(t(!0),a(T,null,M(H.value.periods.challenging,(i,F)=>(t(),a("li",{key:`challenging-${F}`},s(i),1))),128))])])])])):h("",!0)])):h("",!0),C.value==="palace"&&l.chartData.palaceInterpretations?(t(),a("div",kn,[e("div",Sn,[(t(!0),a(T,null,M(l.chartData.palaceInterpretations,i=>(t(),a("button",{key:i.palaceName,onClick:F=>X(i.palaceName),class:O([{active:E.value===i.palaceName},"palace-tab-button"])},s(i.palaceName),11,wn))),128))]),D.value?(t(),a("div",Dn,[e("h4",null,s(D.value.palaceName)+"解讀",1),e("div",Cn,[o[30]||(o[30]=e("h5",null,"個性特質",-1)),e("div",An,[(t(!0),a(T,null,M(D.value.personalityTraits,(i,F)=>(t(),a("span",{key:`trait-${F}`,class:"trait-tag"},s(i),1))),128))])]),e("div",En,[o[31]||(o[31]=e("h5",null,"優勢領域",-1)),e("ul",null,[(t(!0),a(T,null,M(D.value.strengthAreas,(i,F)=>(t(),a("li",{key:`strength-${F}`},s(i),1))),128))])]),e("div",In,[o[32]||(o[32]=e("h5",null,"挑戰領域",-1)),e("ul",null,[(t(!0),a(T,null,M(D.value.challengeAreas,(i,F)=>(t(),a("li",{key:`challenge-${F}`},s(i),1))),128))])]),e("div",Pn,[o[33]||(o[33]=e("h5",null,"人生主題",-1)),e("ul",null,[(t(!0),a(T,null,M(D.value.lifeThemes,(i,F)=>(t(),a("li",{key:`theme-${F}`},s(i),1))),128))])]),e("div",Tn,[o[34]||(o[34]=e("h5",null,"星曜影響",-1)),e("ul",null,[(t(!0),a(T,null,M(D.value.keyStarInfluences,(i,F)=>(t(),a("li",{key:`influence-${F}`},s(i),1))),128))])]),e("div",Mn,[o[35]||(o[35]=e("h5",null,"建議",-1)),e("ul",null,[(t(!0),a(T,null,M(D.value.advice,(i,F)=>(t(),a("li",{key:`advice-${F}`},s(i),1))),128))])])])):h("",!0)])):h("",!0)])):h("",!0),l.showCyclesDetail&&l.chartData.daXian?(t(),a("div",Ln,[e("div",Gn,[e("h3",null,s(l.$t("purpleStarChart.majorCycles")),1),o[36]||(o[36]=e("div",{class:"cycles-explanation"},[e("div",{class:"info-icon"},"ℹ️"),e("div",{class:"info-text"}," 大限是紫微斗數命盤中表示人生階段的重要概念，每個大限代表約10年的時間。大限與本命盤星曜互動， 揭示該階段的主要能量流動和關鍵課題。每個大限的宮位和星曜組合，預示著該時期的主要生活主題和機遇挑戰。 ")],-1))]),e("div",Vn,[(t(!0),a(T,null,M(l.chartData.daXian,i=>(t(),a("div",{key:`daxian-${i.startAge}`,class:O(["cycle-item",{current:R()}])},[e("div",Nn,[e("span",On,s(i.startAge)+"-"+s(i.endAge)+s(l.$t("purpleStarChart.years")),1),e("span",Fn,s(i.palaceName),1)]),e("div",xn,s(i.palaceZhi),1),e("div",jn," 大限落在"+s(i.palaceName)+"，著重於"+s(se(i.palaceName))+"主題。 ",1)],2))),128))])])):h("",!0),_.value?(t(),a("div",{key:5,class:"star-detail-modal",onClick:ke},[e("div",{class:"modal-content",onClick:o[8]||(o[8]=$e(()=>{},["stop"]))},[e("div",zn,[e("h3",null,s(_.value.name),1),e("button",{onClick:ke,class:"close-button"},"×")]),e("div",Bn,[e("p",null,[e("strong",null,s(l.$t("purpleStarChart.starType"))+":",1),Y(" "+s(l.$t(`purpleStarChart.starTypes.${_.value.type}`)),1)]),e("p",null,[e("strong",null,s(l.$t("purpleStarChart.palace"))+":",1),Y(" "+s(N(_.value)),1)]),e("div",Rn,[_.value.attribute?(t(),a("div",Un,[o[37]||(o[37]=e("strong",null,"吉凶屬性：",-1)),e("span",{class:O(`attribute-tag attribute-${_.value.attribute}`)},s(_.value.attribute),3)])):h("",!0),_.value.propertyType?(t(),a("div",Zn,[o[38]||(o[38]=e("strong",null,"陰陽屬性：",-1)),e("span",Xn,s(_.value.propertyType),1)])):h("",!0),_.value.element?(t(),a("div",Hn,[o[39]||(o[39]=e("strong",null,"五行屬性：",-1)),e("span",Yn,s(_.value.element),1)])):h("",!0),_.value.strength!==void 0?(t(),a("div",qn,[o[40]||(o[40]=e("strong",null,"星曜強度：",-1)),e("span",Kn,s(_.value.strength)+"/10",1)])):h("",!0)]),_.value.description?(t(),a("div",Jn,[o[41]||(o[41]=e("strong",null,"星曜特點：",-1)),e("p",null,s(_.value.description),1)])):h("",!0),_.value.transformations&&_.value.transformations.length>0?(t(),a("div",Wn,[e("strong",null,s(l.$t("purpleStarChart.transformations"))+":",1),e("ul",null,[(t(!0),a(T,null,M(_.value.transformations,i=>(t(),a("li",{key:i},s(l.$t(`purpleStarChart.transformationTypes.${i}`)),1))),128))])])):h("",!0)])])])):h("",!0),w(Za,{visible:$.value,onClose:o[9]||(o[9]=i=>$.value=!1)},null,8,["visible"])])):h("",!0)]))}}),el=pe(Qn,[["__scopeId","data-v-c693f569"]]),tl={class:"transformation-chart"},al={class:"chart-header"},sl={class:"stars-table"},nl={class:"cell star-name"},ll={class:"cell transformations"},ol={class:"cell palace-name"},rl={class:"cell effect"},il={class:"transformation-flows"},cl={class:"flows-container"},dl={class:"flow-palace"},ul={class:"palace-name"},pl={class:"palace-zhi"},vl={class:"flow-energy"},ml={class:"energy-value"},gl={class:"flow-stars"},hl={class:"star-name"},fl={class:"transformation-combinations"},yl={key:0,class:"combinations-list"},_l={class:"combo-header"},bl={class:"combo-name"},$l={class:"combo-location"},kl={class:"combo-effect"},Sl={key:1,class:"no-combinations-message"},wl={key:0,class:"layered-effects"},Dl={key:0,class:"energy-summary"},Cl={class:"energy-highlight"},Al={class:"highlight-value"},El={class:"energy-description"},Il={class:"layer-selector"},Pl={class:"layer-content"},Tl={key:0,class:"layer-palaces"},Ml={class:"palace-header"},Ll={class:"palace-energy"},Gl={key:1,class:"layer-palaces"},Vl={class:"palace-header"},Nl={class:"palace-energy"},Ol={key:2,class:"layer-palaces"},Fl={class:"palace-header"},xl={class:"palace-energy"},jl={key:3,class:"layer-palaces"},zl={class:"palace-header"},Bl={class:"palace-energy"},Rl={class:"palace-interp"},Ul=ue({__name:"TransformationStarsDisplay",props:{chartData:{},mingGan:{default:""},transformationFlows:{default:()=>({})},transformationCombinations:{default:()=>[]},multiLayerEnergies:{default:()=>({})}},setup(z){const d=z,g=j(!1),r=j("total"),v=j(null);j(window.innerWidth<=768),q(()=>null),q(()=>{var m;let c=0;return d.chartData?(d.mingGan&&d.mingGan.length>0&&(c+=40),((m=d.chartData.palaces)==null?void 0:m.some(x=>x.stars.some(K=>K.transformations&&K.transformations.length>0)))&&(c+=30),d.transformationCombinations&&d.transformationCombinations.length>0&&(c+=15),d.multiLayerEnergies&&Object.keys(d.multiLayerEnergies).length>0&&(c+=15),Math.min(c,100)):0});const G=q(()=>{const c=[];if(d.chartData&&d.chartData.palaces)for(const y of d.chartData.palaces)for(const m of y.stars)m.transformations&&m.transformations.length>0&&c.push(m);return c}),_=q(()=>d.transformationCombinations||[]),B=q(()=>Object.keys(d.multiLayerEnergies||{}).length>0),f=c=>{const y=d.chartData.palaces.find(m=>m.index===c);return y?`${y.name}(${y.zhi})`:"未知宮位"},S=c=>{if(!c.transformations||c.transformations.length===0)return"";const y={祿:"增加財帛和福分",權:"增加權威和地位",科:"增加學業和榮譽",忌:"帶來阻礙和衝突"};return c.transformations.map(m=>y[m]||m).join("，")},$=c=>{const y=d.transformationFlows[c];return y?y.energyScore.toString():"0"},C=c=>{const y=d.transformationFlows[c];if(!y)return{width:"0%",backgroundColor:"#e9ecef"};const m=50,x=y.energyScore,K=m+x*5,ee=Math.max(5,Math.min(100,K));let A="#e9ecef";return x>0?A=x>=5?"#28a745":"#5cb85c":x<0&&(A=x<=-5?"#dc3545":"#f5c6cb"),{width:`${ee}%`,backgroundColor:A}},k=(c,y="")=>{if(y){let m=0;switch(y){case"base":m=L(c,"baseEnergy");break;case"daXian":m=L(c,"daXianEnergy");break;case"liuNian":m=L(c,"liuNianEnergy");break;case"total":m=L(c,"totalEnergy");break;default:m=0}return m>0?"positive-energy":m<0?"negative-energy":"neutral-energy"}else{const m=d.transformationFlows[c];if(!m)return"neutral-energy";const x=m.energyScore;return x>0?"positive-energy":x<0?"negative-energy":"neutral-energy"}},E=c=>c.stars.filter(y=>y.transformations&&y.transformations.length>0),L=(c,y)=>{const m=d.multiLayerEnergies[c];return m&&m[y]||0},H=c=>{const y=d.multiLayerEnergies[c];return y&&y.interpretation||""},D=()=>{let c=-1/0,y="";for(const m in d.multiLayerEnergies){const x=d.multiLayerEnergies[m];x&&typeof x.totalEnergy=="number"&&x.totalEnergy>c&&(c=x.totalEnergy,y=`${x.palaceName} (${c>0?"+":""}${c})`)}return y||"無顯著能量宮位"},b=()=>{let c=0,y=0,m=0,x=0;for(const u in d.multiLayerEnergies){const n=d.multiLayerEnergies[u];n&&typeof n.totalEnergy=="number"&&(m++,x+=n.totalEnergy,n.totalEnergy>0?c++:n.totalEnergy<0&&y++)}if(m===0)return"無法分析能量分佈";const K=c>y?"整體能量偏正向，有利於發展":c<y?"整體能量偏負向，需注意化解阻礙":"正負能量平衡",ee=m>0?(x/m).toFixed(1):"0",A=parseFloat(ee);return`命盤中有 ${c} 個正向能量宮位，${y} 個負向能量宮位。${K}。平均能量值: ${A>0?"+":""}${ee}。`};return ge(()=>{console.log("TransformationStarsDisplay: 組件已掛載"),console.log("TransformationStarsDisplay: Props資料檢查",{chartData:!!d.chartData,mingGan:d.mingGan,transformationFlows:Object.keys(d.transformationFlows||{}).length,transformationCombinations:(d.transformationCombinations||[]).length,multiLayerEnergies:Object.keys(d.multiLayerEnergies||{}).length})}),Ve(()=>{v.value&&(clearInterval(v.value),v.value=null)}),(c,y)=>(t(),a("div",{class:O(["transformation-stars-display",{"animation-active":g.value}])},[y[10]||(y[10]=ve('<div class="display-header" data-v-ac7469a7><h3 data-v-ac7469a7>四化飛星</h3></div><div class="explanation-panel" data-v-ac7469a7><div class="explanation-header" data-v-ac7469a7><span class="info-icon" data-v-ac7469a7>ℹ️</span><h4 data-v-ac7469a7>四化飛星解釋</h4></div><div class="explanation-content" data-v-ac7469a7><p data-v-ac7469a7>四化飛星是紫微斗數中重要的變化星曜，包括<span class="t-lu" data-v-ac7469a7>化祿</span>、<span class="t-quan" data-v-ac7469a7>化權</span>、<span class="t-ke" data-v-ac7469a7>化科</span>和<span class="t-ji" data-v-ac7469a7>化忌</span>，每顆主星會依照命宮天干而有不同的四化狀態。四化飛星對命盤產生的影響如下：</p><ul data-v-ac7469a7><li data-v-ac7469a7><span class="t-lu" data-v-ac7469a7>化祿</span>：代表財帛、福分、名利、物質收穫，對宮位增添吉相</li><li data-v-ac7469a7><span class="t-quan" data-v-ac7469a7>化權</span>：代表權力、地位、決策能力，增強宮位力量感</li><li data-v-ac7469a7><span class="t-ke" data-v-ac7469a7>化科</span>：代表學業、文憑、榮譽、才華，添加智慧和貴人相助</li><li data-v-ac7469a7><span class="t-ji" data-v-ac7469a7>化忌</span>：代表阻礙、病痛、衝突、災厄，使宮位能量受損</li></ul></div></div>',2)),e("div",tl,[e("div",al,[e("span",null,"基於命宮天干「"+s(c.mingGan)+"」的四化飛星",1)]),e("div",sl,[y[4]||(y[4]=ve('<div class="table-header" data-v-ac7469a7><div class="cell" data-v-ac7469a7>星曜</div><div class="cell" data-v-ac7469a7>四化</div><div class="cell" data-v-ac7469a7>所在宮位</div><div class="cell" data-v-ac7469a7>影響</div></div>',1)),(t(!0),a(T,null,M(G.value,m=>(t(),a("div",{key:m.name,class:"table-row"},[e("div",nl,s(m.name),1),e("div",ll,[(t(!0),a(T,null,M(m.transformations,x=>(t(),a("span",{key:x,class:O(`transformation transformation-${x}`)},s(x),3))),128))]),e("div",ol,s(f(m.palaceIndex)),1),e("div",rl,s(S(m)),1)]))),128))])]),e("div",il,[y[5]||(y[5]=e("h4",null,"四化能量流動",-1)),e("div",cl,[(t(!0),a(T,null,M(c.chartData.palaces,(m,x)=>(t(),a("div",{key:`flow-${x}`,class:O(["flow-item",k(m.index)])},[e("div",dl,[e("span",ul,s(m.name),1),e("span",pl,"("+s(m.zhi)+")",1)]),e("div",vl,[e("div",{class:"energy-bar",style:Re(C(m.index))},null,4),e("span",ml,s($(m.index)),1)]),e("div",gl,[(t(!0),a(T,null,M(E(m),K=>(t(),a("div",{key:`flow-star-${K.name}`,class:"flow-star"},[e("span",hl,s(K.name),1),(t(!0),a(T,null,M(K.transformations,ee=>(t(),a("span",{key:`flow-trans-${ee}`,class:O(`trans-indicator trans-${ee}`)},s(ee),3))),128))]))),128))])],2))),128))])]),e("div",fl,[y[7]||(y[7]=e("h4",null,"四化特殊組合",-1)),_.value.length>0?(t(),a("div",yl,[(t(!0),a(T,null,M(_.value,(m,x)=>(t(),a("div",{key:`combo-${x}`,class:O(["combination-item",`significance-${m.significance}`])},[e("div",_l,[e("span",bl,s(m.combination),1),e("span",$l,s(m.palaceName),1)]),e("div",kl,s(m.effect),1)],2))),128))])):(t(),a("div",Sl,y[6]||(y[6]=[e("div",{class:"message-container"},[e("i",{class:"info-icon"},"ℹ️"),e("div",{class:"message-content"},[e("p",null,"未發現四化組合"),e("p",{class:"message-detail"},"當前命盤中的四化飛星分布較為分散，未形成特殊組合。這意味著各宮位的能量可能更均衡，不會因特定組合而產生極端吉凶。")])],-1)])))]),B.value?(t(),a("div",wl,[y[9]||(y[9]=e("h4",null,[Y("大限與流年疊加 "),e("span",{class:"energy-tooltip"},[e("i",{class:"info-tooltip"},"ℹ️"),e("span",{class:"tooltip-content"},"多層次能量疊加分析結合原命盤、大限與流年的四化能量，呈現宮位能量在不同時間維度的變化。")])],-1)),r.value==="total"?(t(),a("div",Dl,[e("div",Cl,[y[8]||(y[8]=e("div",{class:"highlight-title"},"當前最強能量宮位",-1)),e("div",Al,s(D()),1)]),e("div",El,[e("p",null,s(b()),1)])])):h("",!0),e("div",Il,[e("button",{onClick:y[0]||(y[0]=m=>r.value="base"),class:O({active:r.value==="base"})},"本命",2),e("button",{onClick:y[1]||(y[1]=m=>r.value="daXian"),class:O({active:r.value==="daXian"})},"大限",2),e("button",{onClick:y[2]||(y[2]=m=>r.value="liuNian"),class:O({active:r.value==="liuNian"})},"流年",2),e("button",{onClick:y[3]||(y[3]=m=>r.value="total"),class:O({active:r.value==="total"})},"綜合",2)]),e("div",Pl,[r.value==="base"?(t(),a("div",Tl,[(t(!0),a(T,null,M(c.chartData.palaces,(m,x)=>(t(),a("div",{key:`base-${x}`,class:O(["layer-palace",k(m.index,"base")])},[e("div",Ml,s(m.name),1),e("div",Ll,s(L(m.index,"baseEnergy")),1)],2))),128))])):r.value==="daXian"?(t(),a("div",Gl,[(t(!0),a(T,null,M(c.chartData.palaces,(m,x)=>(t(),a("div",{key:`daxian-${x}`,class:O(["layer-palace",k(m.index,"daXian")])},[e("div",Vl,s(m.name),1),e("div",Nl,s(L(m.index,"daXianEnergy")),1)],2))),128))])):r.value==="liuNian"?(t(),a("div",Ol,[(t(!0),a(T,null,M(c.chartData.palaces,(m,x)=>(t(),a("div",{key:`liunian-${x}`,class:O(["layer-palace",k(m.index,"liuNian")])},[e("div",Fl,s(m.name),1),e("div",xl,s(L(m.index,"liuNianEnergy")),1)],2))),128))])):r.value==="total"?(t(),a("div",jl,[(t(!0),a(T,null,M(c.chartData.palaces,(m,x)=>(t(),a("div",{key:`total-${x}`,class:O(["layer-palace",k(m.index,"total")])},[e("div",zl,s(m.name),1),e("div",Bl,s(L(m.index,"totalEnergy")),1),e("div",Rl,s(H(m.index)),1)],2))),128))])):h("",!0)])])):h("",!0)],2))}}),Zl=pe(Ul,[["__scopeId","data-v-ac7469a7"]]),Xl="/api/v1";class Hl{async calculatePurpleStar(d){var g,r,v,G,_,B;try{console.group("紫微斗數API服務調用"),console.log("發送紫微斗數計算請求:",JSON.stringify(d,null,2)),console.log("請求選項:",JSON.stringify(d.options,null,2)),d.options||(d.options={}),d.options.includeFourTransformations===void 0&&(d.options.includeFourTransformations=!0,console.log("自動添加 includeFourTransformations 選項"));const f=await Ee.post(`${Xl}/purple-star/calculate`,d);if(console.log("API響應狀態碼:",f.status),console.log("響應頂層結構:",Object.keys(f.data||{})),(r=(g=f.data)==null?void 0:g.data)!=null&&r.transformations)console.log("四化飛星資料存在，結構:",{flows:f.data.data.transformations.flows?Object.keys(f.data.data.transformations.flows).length:0,combinations:f.data.data.transformations.combinations?f.data.data.transformations.combinations.length:0,layeredEnergies:f.data.data.transformations.layeredEnergies?Object.keys(f.data.data.transformations.layeredEnergies).length:0});else if(console.warn("API響應中缺少四化飛星資料"),(G=(v=f.data)==null?void 0:v.data)!=null&&G.chart){console.log("命盤資料存在"),f.data.data.chart.mingGan?console.log("命宮天干存在:",f.data.data.chart.mingGan):console.warn("命宮天干資料缺失");let S=!1;if(f.data.data.chart.palaces&&Array.isArray(f.data.data.chart.palaces)){console.log("宮位數量:",f.data.data.chart.palaces.length);for(const $ of f.data.data.chart.palaces)if($.stars&&Array.isArray($.stars)){for(const C of $.stars)if(C.transformations&&C.transformations.length>0){S=!0;break}if(S)break}console.log("星曜中包含四化屬性:",S)}}else console.error("API響應中缺少命盤資料");return console.groupEnd(),f.data}catch(f){throw console.groupEnd(),console.group("紫微斗數API錯誤"),console.error("紫微斗數計算失敗:",f),console.error("錯誤類型:",f.constructor.name),f!=null&&f.response?(console.error("HTTP狀態碼:",f.response.status),console.error("錯誤回應資料:",f.response.data),console.error("錯誤響應頭:",f.response.headers)):f!=null&&f.request?console.error("未收到響應的請求:",f.request):console.error("錯誤消息:",f.message),console.error("錯誤堆疊:",f.stack),console.groupEnd(),(B=(_=f==null?void 0:f.response)==null?void 0:_.data)!=null&&B.error?new Error(`紫微斗數API錯誤: ${f.response.data.error}`):f}}}const Yl=new Hl,ie=j({transformationStars:"standard",purpleStar:"standard",baziChart:"standard",integrated:"standard"});function ql(z){let d=!1;const g=q({get:()=>ie.value[z]||"standard",set:S=>{if(d){ie.value[z]=S;return}ie.value[z]=S;try{sessionStorage.setItem(`${z}-display-depth`,S),console.log(`${z} 顯示深度已更新為: ${S}`)}catch($){console.error("無法保存顯示深度設定到 sessionStorage:",$)}window.dispatchEvent(new CustomEvent("module-changed",{detail:{module:z,depth:S}}))}}),r=S=>({minimal:"minimal",compact:"compact",standard:"standard",comprehensive:"comprehensive"})[S]||"standard",v=()=>{g.value="standard"},G=()=>{Object.keys(ie.value).forEach(S=>{ie.value[S]="standard"});try{Object.keys(ie.value).forEach(S=>{sessionStorage.removeItem(`${S}-display-depth`)})}catch(S){console.error("無法清除 sessionStorage 中的顯示深度設定:",S)}};(()=>{try{const S=sessionStorage.getItem(`${z}-display-depth`);S&&["minimal","compact","standard","comprehensive"].includes(S)&&(ie.value[z]=S)}catch(S){console.error(`無法從 sessionStorage 載入 ${z} 的顯示深度設定:`,S)}})();const B=S=>{if(S.detail&&S.detail.module===z&&S.detail.depth!==ie.value[z]){d=!0,ie.value[z]=S.detail.depth;try{sessionStorage.setItem(`${z}-display-depth`,S.detail.depth)}catch($){console.error("無法保存顯示深度設定到 sessionStorage:",$)}d=!1}},f=S=>{if(S.detail&&S.detail.module===z&&S.detail.depth!==ie.value[z]){d=!0,ie.value[z]=S.detail.depth;try{sessionStorage.setItem(`${z}-display-depth`,S.detail.depth)}catch($){console.error("無法保存顯示深度設定到 sessionStorage:",$)}d=!1}};return ge(()=>{window.addEventListener("display-depth-changed",B),window.addEventListener("module-changed",f)}),Ue(()=>{window.removeEventListener("display-depth-changed",B),window.removeEventListener("module-changed",f)}),{displayMode:g,mapDepthToMode:r,resetDisplayMode:v,resetAllModes:G}}const Kl={class:"purple-star-container"},Jl={class:"card-header"},Wl={class:"header-actions"},Ql={class:"view-description"},eo={class:"placeholder"},to={class:"integrated-analysis-sidebar"},ao={key:0,class:"analysis-intro"},so={class:"intro-header"},no={class:"intro-content"},lo={class:"features-grid"},oo={class:"feature-item"},ro={class:"feature-item"},io={class:"feature-item"},co={class:"feature-item"},uo={key:1,class:"analysis-loading"},po={class:"loading-step"},vo={key:2,class:"analysis-results"},mo={class:"result-actions"},go={key:3,class:"analysis-error"},ho=ue({__name:"PurpleStarView",setup(z){Q.getOrCreateSessionId();const d=Xe("globalDisplayState"),g=j(null),r=j(null),v=j({}),G=j([]),_=j({}),{displayMode:B}=ql("purpleStar");be(()=>B.value,n=>{console.log(`PurpleStarView: localDisplayMode 變化為 ${n}`)},{immediate:!0});const f=q(()=>(console.log(`PurpleStarView: 使用本地顯示模式=${B.value}`),B.value));q(()=>{if(!g.value)return 0;let n=0;return g.value.palaces&&g.value.palaces.length>0&&(n+=40),Object.keys(v.value).length>0&&(n+=30),Object.keys(_.value).length>0&&(n+=20),G.value&&G.value.length>0&&(n+=10),Math.min(n,100)});const S=n=>{console.log(`PurpleStarView: changeDisplayMode 被調用，mode=${n}`),B.value=n},$=j(!1),C=j(!1),k=j(null),E=j(null),L=j(0),H=j("正在準備分析...");Ze({mobile:768,tablet:1024}).smaller("mobile");const b=q(()=>k.value?"綜合解讀結果":"綜合人生解讀");q(()=>{var n,p;if(!k.value)return 0;try{const V=((p=(n=k.value.data)==null?void 0:n.analysisInfo)==null?void 0:p.confidence)||0;return Math.round(V*100)}catch(V){return console.error("計算分析完整度時出錯:",V),0}});const c=async()=>{try{await Ae.confirm("確定要清除基本命盤資料嗎？（四化飛星資料將保留）","清除資料",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}),Q.clearAnalysisData("purpleStar"),g.value=null,r.value=null,W.success("紫微斗數基本資料已清除（四化飛星資料已保留）")}catch{try{await Ae.confirm("是否要清除包括四化飛星在內的所有資料？","全部清除",{confirmButtonText:"全部清除",cancelButtonText:"取消",type:"error"}),Q.clearAnalysisData("purpleStarAll"),g.value=null,r.value=null,v.value={},G.value=[],_.value={},W.success("所有紫微斗數資料已清除")}catch{}}},y=async n=>{var p;try{console.group("紫微斗數API調用"),W.info("正在計算紫微斗數命盤..."),r.value=n,Q.saveToStorage(Q.STORAGE_KEYS.PURPLE_STAR_BIRTH_INFO,n);const V={...n,options:{includeMajorCycles:!0,includeMinorCycles:!0,includeAnnualCycles:!0,detailLevel:"advanced",includeFourTransformations:!0,maxAge:100}};console.log("發送請求資料:",V),console.log("請求選項配置:",V.options);const I=await Yl.calculatePurpleStar(V);if(console.log("API 響應狀態:",I?"成功":"空響應"),console.log("API 響應頂層鍵:",Object.keys(I||{})),console.log("API data 存在:",!!(I!=null&&I.data)),console.log("API data 鍵:",Object.keys((I==null?void 0:I.data)||{})),!((p=I==null?void 0:I.data)!=null&&p.chart))throw console.error("API 未返回紫微斗數命盤資料"),new Error("紫微斗數命盤資料缺失");if(console.log("命盤資料:",I.data.chart),console.log("命宮天干:",I.data.chart.mingGan||"未返回命宮天干"),console.log("大限資訊:",I.data.chart.daXian||"無大限資訊"),console.log("小限資訊:",I.data.chart.xiaoXian||"無小限資訊"),console.log("流年太歲資訊:",I.data.chart.liuNianTaiSui||"無流年太歲資訊"),g.value=I.data.chart,console.log("四化飛星資料存在:",!!I.data.transformations),I.data.transformations)v.value=I.data.transformations.flows||{},G.value=I.data.transformations.combinations||[],_.value=I.data.transformations.layeredEnergies||{},console.log("四化飛星資料載入成功:",{flows:Object.keys(v.value).length,combinations:G.value.length,layeredEnergies:Object.keys(_.value).length}),Object.keys(v.value).length===0?console.warn("四化飛星flows資料為空，可能影響顯示"):console.log("四化飛星flows資料樣本:",Object.keys(v.value).slice(0,3));else{console.error("API 未返回四化飛星資料，詳細檢查API響應結構"),console.log("API響應的完整data結構鍵:",Object.keys(I.data));const R=["fourTransformations","sihua","transformedStars","starTransformations"],N=I.data,Z=R.find(le=>N[le]);Z&&console.log(`發現替代四化資料字段: ${Z}`,N[Z]),v.value={},G.value=[],_.value={},W.warning({message:"四化飛星資料缺失，部分分析功能將不可用。請檢查後端API配置。",duration:5e3})}if(Q.saveToStorage(Q.STORAGE_KEYS.PURPLE_STAR_CHART,I.data.chart),I.data.transformations){console.log("保存四化飛星資料到 sessionStorage");const R=I.data.transformations;Q.saveTransformationStarsData(R.stars||null,R.flows||{},R.combinations||[],R.layeredEnergies||{})}else console.warn("API 響應中沒有四化飛星資料，無法保存");console.groupEnd(),W.success("紫微斗數計算完成")}catch(V){console.groupEnd(),console.error("紫微斗數計算錯誤:",V),console.error("錯誤類型:",V.constructor.name),console.error("錯誤訊息:",V.message),console.error("錯誤堆疊:",V.stack);const I=V.message||"未知錯誤";W.error({message:`紫微斗數計算失敗: ${I}`,duration:6e3})}},m=()=>{const n=$.value;if($.value=!n,console.log(`PurpleStarView: 整合分析切換為 ${$.value}`),d){const p=$.value?"integrated":"purpleStar";d.setActiveModule(p),console.log(`PurpleStarView: 立即切換全域模組到 ${p}`)}},x=n=>{C.value?Ae.confirm("分析正在進行中，確定要關閉嗎？","提示",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then(()=>{n()}).catch(()=>{}):n()},K=async()=>{var n,p,V,I,R;if(!r.value){W.warning("請先完成紫微斗數計算");return}try{C.value=!0,E.value=null,L.value=0,H.value="正在準備解讀...";const N=(ae,se)=>{H.value=ae,L.value=se};N("正在計算八字命盤...",20);const Z=typeof r.value.location=="string"?r.value.location:((n=r.value.location)==null?void 0:n.name)||"台北市",le={birthDate:r.value.birthDate,birthTime:r.value.birthTime,gender:r.value.gender,location:Z,options:{useAdvancedAlgorithm:!0,includeCrossVerification:!0,includeRealTimeData:!0,confidenceScoring:!0}};console.log("發送綜合解讀請求:",le),N("正在整合紫微斗數與八字的傳統智慧...",50);try{const ae=await Me.performIntegratedAnalysis(le,!0);N("正在分析人生特質與運勢走向...",80);try{const se=await Me.getConfidenceAssessment(le);console.log("解讀完整度評估結果:",se)}catch(se){console.warn("解讀完整度評估獲取失敗，但不影響主要解讀:",se)}N("正在生成人生指導建議...",95),k.value=ae,Q.saveToStorage(Q.STORAGE_KEYS.INTEGRATED_ANALYSIS,ae),L.value=100,H.value="解讀完成!",W.success("綜合人生解讀完成")}catch(ae){console.error("API 請求失敗:",ae);const se=((V=(p=ae.response)==null?void 0:p.data)==null?void 0:V.error)||ae.message;E.value="綜合解讀API錯誤: "+se,W.error("綜合解讀API錯誤: "+se)}}catch(N){console.error("綜合解讀失敗:",N);const Z=((R=(I=N.response)==null?void 0:I.data)==null?void 0:R.error)||N.message||"綜合解讀失敗";E.value=Z,W.error(Z)}finally{C.value=!1}},ee=()=>{if(!k.value){W.warning("沒有可匯出的解讀結果");return}try{const n={readingDate:new Date().toLocaleDateString("zh-TW"),completeness:k.value.data.analysisInfo.confidence,consensusFindings:k.value.data.integratedAnalysis.consensusFindings,divergentFindings:k.value.data.integratedAnalysis.divergentFindings,recommendations:k.value.data.integratedAnalysis.recommendations,methodsUsed:k.value.data.analysisInfo.methodsUsed},p=JSON.stringify(n,null,2),V=new Blob([p],{type:"application/json"}),I=URL.createObjectURL(V),R=document.createElement("a");R.href=I,R.download=`綜合人生解讀報告_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(I),W.success("解讀報告已匯出")}catch(n){console.error("匯出失敗:",n),W.error("匯出失敗，請稍後再試")}},A=()=>{try{console.log("開始從 sessionStorage 載入紫微斗數資料");const n=Object.keys(sessionStorage).filter(N=>N.startsWith("peixuan_"));console.log("sessionStorage 中的相關鍵:",n);const p=Q.getFromStorage(Q.STORAGE_KEYS.PURPLE_STAR_BIRTH_INFO);p?(console.log("找到保存的紫微斗數出生資訊"),r.value=p):console.log("未找到保存的紫微斗數出生資訊");const V=Q.getFromStorage(Q.STORAGE_KEYS.PURPLE_STAR_CHART);if(V){console.log("找到保存的紫微斗數命盤資料");try{if(!V.palaces||!Array.isArray(V.palaces)||V.palaces.length===0)throw console.warn("保存的紫微斗數命盤資料缺少宮位資訊"),new Error("命盤資料不完整");g.value=V}catch(N){console.error("解析保存的紫微斗數命盤資料時出錯:",N)}}else console.log("未找到保存的紫微斗數命盤資料");const I=Q.getFromStorage(Q.STORAGE_KEYS.INTEGRATED_ANALYSIS);if(I){console.log("找到保存的整合分析結果");try{if(!I.data||!I.data.integratedAnalysis)throw console.warn("保存的整合分析結果缺少必要的分析資料"),new Error("整合分析資料不完整");k.value=I}catch(N){console.error("解析保存的整合分析結果時出錯:",N),Q.clearAnalysisData("integrated")}}else console.log("未找到保存的整合分析結果");console.log("檢查四化飛星資料...");const R=Q.getTransformationStarsData();R.flows&&Object.keys(R.flows).length>0?(console.log("找到保存的四化飛星資料:",{flows:Object.keys(R.flows).length,combinations:R.combinations.length,multiLayerEnergies:Object.keys(R.multiLayerEnergies).length,stars:!!R.stars}),v.value=R.flows,G.value=R.combinations,_.value=R.multiLayerEnergies,R.stars&&console.log("載入四化星曜資料")):(console.log("未找到保存的四化飛星資料"),v.value={},G.value=[],_.value={});try{console.log("使用增強版存儲服務驗證紫微斗數資料"),at.validateStorageData()}catch(N){console.error("驗證紫微斗數資料時出錯:",N)}console.log("從 sessionStorage 載入的紫微斗數資料總結:",{birthInfo:!!r.value,purpleStarChart:!!g.value,integratedAnalysis:!!k.value})}catch(n){console.error("從 sessionStorage 載入紫微斗數資料時出錯:",n),n instanceof Error&&n.message&&n.message.includes("Unexpected token")?(console.warn("檢測到 JSON 解析錯誤，清除可能損壞的資料"),Q.clearAnalysisData("purpleStar")):console.warn("載入錯誤可能是暫時性的，保留現有資料")}},u=()=>{A()};return be(()=>$.value,n=>{if(d){const p=n?"integrated":"purpleStar";d.setActiveModule(p),console.log(`PurpleStarView: 切換到全域模組 ${p}`)}},{immediate:!1}),be(()=>d==null?void 0:d.activeModule.value,n=>{console.log(`PurpleStarView: 全域模組變更為 ${n}`)},{immediate:!0}),ge(()=>{const n=p=>{console.log("PurpleStarView: 收到全域狀態變化事件",p.detail)};window.addEventListener("global-display-state-changed",n),be(()=>null,()=>{window.removeEventListener("global-display-state-changed",n)})}),ge(()=>{console.log("PurpleStarView 組件已掛載");try{if(u(),d){console.log("PurpleStarView: 全域顯示狀態可用，初始化同步"),d.setActiveModule("purpleStar");const n=B.value;console.log(`PurpleStarView: 使用本地深度 ${n}，無需同步到全域狀態`)}else console.warn("PurpleStarView: 全域顯示狀態不可用，使用本地狀態")}catch(n){console.error("紫微斗數組件初始化過程中發生錯誤:",n),n instanceof Error&&(n.name==="SecurityError"||n.message.includes("quota"))?(console.warn("儲存空間問題，清除資料以釋放空間"),Q.clearAnalysisData("purpleStar"),W.warning("因儲存空間問題，已重置分析狀態")):(console.warn("初始化錯誤可能是暫時性的，保留現有資料"),W.info("載入時發生暫時性錯誤，請稍後再試"))}}),(n,p)=>{const V=J("el-button"),I=J("el-alert"),R=J("el-card"),N=J("el-col"),Z=J("el-icon"),le=J("el-row"),ae=J("el-progress"),se=J("el-drawer");return t(),a("div",Kl,[e("div",{class:O(["main-content",{"with-sidebar":$.value}])},[w(le,{gutter:20},{default:P(()=>[w(N,{span:24,class:"mb-4"},{default:P(()=>[w(R,{shadow:"hover"},{header:P(()=>[e("div",Jl,[e("span",null,s(n.$t("astrology.purple_star_detail.title")),1),e("div",Wl,[g.value&&r.value?(t(),te(V,{key:0,type:"success",icon:de(He),onClick:m,loading:C.value},{default:P(()=>[Y(s($.value?"隱藏":"綜合解讀"),1)]),_:1},8,["icon","loading"])):h("",!0),g.value?(t(),te(V,{key:1,type:"danger",icon:de(Ye),onClick:c,size:"small"},{default:P(()=>p[1]||(p[1]=[Y(" 清除資料 ")])),_:1,__:[1]},8,["icon"])):h("",!0)])])]),default:P(()=>[e("div",Ql,[e("p",null,s(n.$t("astrology.purple_star_detail.description")),1),g.value&&!$.value?(t(),te(I,{key:0,title:"💡 提示",description:"您可以點擊右上角「綜合解讀」來獲得八字與紫微斗數的全面人生解讀",type:"info",closable:!1,"show-icon":"",class:"mt-3 text-center-alert",style:{"text-align":"center",display:"flex","justify-content":"center"}})):h("",!0),w(nt,{class:"mt-3"})])]),_:1})]),_:1}),w(N,{xs:24,sm:24,md:12,lg:12,xl:12},{default:P(()=>[w(R,{shadow:"hover"},{header:P(()=>[e("span",null,s(n.$t("astrology.purple_star_detail.inputSection")),1)]),default:P(()=>[w(ot,{onSubmit:y})]),_:1})]),_:1}),w(N,{xs:24,sm:24,md:12,lg:12,xl:12},{default:P(()=>[g.value?(t(),te(R,{key:0,shadow:"hover"},{header:P(()=>p[2]||(p[2]=[e("div",{class:"card-header"},[e("span",null,"分析結果")],-1)])),default:P(()=>[w(el,{chartData:g.value,isLoading:!1,showCyclesDetail:!0,displayDepth:f.value,"onUpdate:displayDepth":S},null,8,["chartData","displayDepth"]),Object.keys(v.value).length>0?(t(),te(Zl,{key:0,chartData:g.value,mingGan:g.value.mingGan||"",displayMode:f.value,transformationFlows:v.value,transformationCombinations:G.value||[],multiLayerEnergies:_.value,"onUpdate:displayMode":S,class:"mt-4"},null,8,["chartData","mingGan","displayMode","transformationFlows","transformationCombinations","multiLayerEnergies"])):f.value!=="minimal"&&Object.keys(v.value).length===0&&g.value?(t(),te(I,{key:1,title:"四化飛星資料缺失",description:`當前命盤缺少四化飛星資料。命宮天干：${g.value.mingGan||"未知"}，請檢查API響應是否包含四化資料。`,type:"warning",closable:!1,class:"mt-4"},null,8,["description"])):h("",!0)]),_:1})):(t(),te(R,{key:1,shadow:"hover"},{default:P(()=>[e("div",eo,[w(Z,{size:64,color:"#c0c4cc"},{default:P(()=>[w(de(qe))]),_:1}),p[3]||(p[3]=e("p",null,"請填寫左側表單開始分析",-1))])]),_:1}))]),_:1})]),_:1})],2),w(se,{modelValue:$.value,"onUpdate:modelValue":p[0]||(p[0]=me=>$.value=me),title:b.value,direction:"rtl",size:"45%","before-close":x},{default:P(()=>[e("div",to,[!k.value&&!C.value?(t(),a("div",ao,[e("div",so,[w(Z,{size:48,color:"#409EFF"},{default:P(()=>[w(de(Ke))]),_:1}),p[4]||(p[4]=e("h3",null,"綜合人生解讀",-1))]),e("div",no,[p[10]||(p[10]=e("p",null,"整合八字與紫微斗數的傳統智慧，為您提供更加全面和深入的人生解讀。",-1)),e("div",lo,[e("div",oo,[w(Z,{color:"#67C23A"},{default:P(()=>[w(de(Je))]),_:1}),p[5]||(p[5]=e("span",null,"多角度全面分析",-1))]),e("div",ro,[w(Z,{color:"#E6A23C"},{default:P(()=>[w(de(We))]),_:1}),p[6]||(p[6]=e("span",null,"深層特質解析",-1))]),e("div",io,[w(Z,{color:"#409EFF"},{default:P(()=>[w(de(Qe))]),_:1}),p[7]||(p[7]=e("span",null,"解讀完整度",-1))]),e("div",co,[w(Z,{color:"#F56C6C"},{default:P(()=>[w(de(et))]),_:1}),p[8]||(p[8]=e("span",null,"個性化建議",-1))])]),w(V,{type:"primary",size:"large",onClick:K,loading:C.value,class:"start-analysis-btn"},{default:P(()=>p[9]||(p[9]=[Y(" 開始綜合解讀 ")])),_:1,__:[9]},8,["loading"])])])):C.value?(t(),a("div",uo,[w(Z,{size:60,class:"is-loading"},{default:P(()=>[w(de(tt))]),_:1}),p[11]||(p[11]=e("h3",null,"正在進行綜合人生解讀...",-1)),p[12]||(p[12]=e("p",null,"系統正在整合八字與紫微斗數，為您準備全面的人生解讀",-1)),w(ae,{percentage:L.value,"show-text":!1},null,8,["percentage"]),e("p",po,s(H.value),1)])):k.value?(t(),a("div",vo,[w(st,{integratedAnalysis:k.value,loading:!1,error:E.value},null,8,["integratedAnalysis","error"]),e("div",mo,[w(V,{onClick:K,loading:C.value},{default:P(()=>p[13]||(p[13]=[Y(" 重新分析 ")])),_:1,__:[13]},8,["loading"]),w(V,{type:"success",onClick:ee},{default:P(()=>p[14]||(p[14]=[Y(" 匯出報告 ")])),_:1,__:[14]})])])):h("",!0),E.value?(t(),a("div",go,[w(I,{title:E.value,type:"error",closable:!1,"show-icon":""},null,8,["title"]),w(V,{type:"primary",onClick:K,class:"retry-btn"},{default:P(()=>p[15]||(p[15]=[Y(" 重試 ")])),_:1,__:[15]})])):h("",!0)])]),_:1},8,["modelValue","title"])])}}}),$o=pe(ho,[["__scopeId","data-v-830a34ae"]]);export{$o as default};
