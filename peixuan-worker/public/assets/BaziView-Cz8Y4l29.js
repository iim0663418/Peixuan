import{d as X,m as le,q as V,w as k,f as _,g as P,e as A,t as o,x as re,E as M,o as c,_ as J,c as f,n as L,z as oe,a as s,F as Y,l as D,i as ie,V as ce,r as q,D as de,j as ee,b as z,s as R,W as ue,k as me,H as T,h as he,L as pe,X as fe,Y as K,Z as ge,U as ve,T as be}from"./index-BkKrQnZY.js";import{S as ye}from"./StorageStatusIndicator-DeMNEoxz.js";class ae{static validateBirthDate(t){const e=[];if(!t)return e.push("è«‹é¸æ“‡å‡ºç”Ÿæ—¥æœŸ"),{isValid:!1,errors:e};if(!/^\d{4}-\d{2}-\d{2}$/.test(t))return e.push("æ—¥æœŸæ ¼å¼éŒ¯èª¤ï¼Œè«‹ä½¿ç”¨ YYYY-MM-DD æ ¼å¼"),{isValid:!1,errors:e};const u=new Date(t);if(isNaN(u.getTime()))return e.push("ç„¡æ•ˆçš„æ—¥æœŸ"),{isValid:!1,errors:e};const m=u.getFullYear();return m<1900||m>2050?(e.push("å‡ºç”Ÿå¹´ä»½æ‡‰åœ¨ 1900-2050 ä¹‹é–“"),{isValid:!1,errors:e}):{isValid:!0,errors:[]}}static validateBirthTime(t){const e=[];return t?/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/.test(t)?{isValid:!0,errors:[]}:(e.push("æ™‚é–“æ ¼å¼éŒ¯èª¤ï¼Œè«‹ä½¿ç”¨ HH:mm æ ¼å¼ï¼ˆ24å°æ™‚åˆ¶ï¼‰"),{isValid:!1,errors:e}):(e.push("è«‹é¸æ“‡å‡ºç”Ÿæ™‚é–“"),{isValid:!1,errors:e})}static validateGender(t){const e=[];return t?["male","female"].includes(t)?{isValid:!0,errors:[]}:(e.push("æ€§åˆ¥å¿…é ˆç‚º male æˆ– female"),{isValid:!1,errors:e}):(e.push("è«‹é¸æ“‡æ€§åˆ¥"),{isValid:!1,errors:e})}static validateLocationForPurpleStar(t){const e=[];return t?(t.longitude===null||t.longitude===void 0?e.push("è«‹è¼¸å…¥å‡ºç”Ÿåœ°ç¶“åº¦ï¼ˆå¯é¸æ“‡åŸå¸‚è‡ªå‹•å¡«å…¥ï¼‰"):typeof t.longitude!="number"?e.push("ç¶“åº¦å¿…é ˆç‚ºæ•¸å­—"):(t.longitude<-180||t.longitude>180)&&e.push("ç¶“åº¦å¿…é ˆåœ¨ -180 åˆ° 180 ä¹‹é–“"),t.latitude===null||t.latitude===void 0?e.push("è«‹è¼¸å…¥å‡ºç”Ÿåœ°ç·¯åº¦ï¼ˆå¯é¸æ“‡åŸå¸‚è‡ªå‹•å¡«å…¥ï¼‰"):typeof t.latitude!="number"?e.push("ç·¯åº¦å¿…é ˆç‚ºæ•¸å­—"):(t.latitude<-90||t.latitude>90)&&e.push("ç·¯åº¦å¿…é ˆåœ¨ -90 åˆ° 90 ä¹‹é–“"),t.timezone?/^(UTC[+-]\d{2}:\d{2}|[A-Za-z\/]+)$/.test(t.timezone)||e.push("æ™‚å€æ ¼å¼ç„¡æ•ˆï¼Œè«‹é¸æ“‡æœ‰æ•ˆçš„æ™‚å€"):e.push("è«‹é¸æ“‡æ™‚å€"),{isValid:e.length===0,errors:e}):(e.push("ç²¾ç¢ºçš„ç´«å¾®æ–—æ•¸è¨ˆç®—éœ€è¦åœ°ç†ä½ç½®è³‡è¨Š"),{isValid:!1,errors:e})}static validateBaziForm(t){const e=[],a=this.validateBirthDate(t.birthDate||""),u=this.validateBirthTime(t.birthTime||""),m=this.validateGender(t.gender||"");return e.push(...a.errors),e.push(...u.errors),e.push(...m.errors),{isValid:e.length===0,errors:e}}static validatePurpleStarForm(t){const e=[],a=this.validateBirthDate(t.birthDate||""),u=this.validateBirthTime(t.birthTime||""),m=this.validateGender(t.gender||"");e.push(...a.errors),e.push(...u.errors),e.push(...m.errors);const h=this.validateLocationForPurpleStar(t.location||{});return e.push(...h.errors),{isValid:e.length===0,errors:e}}static validateLunarConversion(t){const e=[];if(!t)return e.push("è¾²æ›†è½‰æ›å¤±æ•—"),{isValid:!1,errors:e};const a=["year","month","day","yearGan","yearZhi","monthGan","monthZhi","dayGan","dayZhi","timeGan","timeZhi"];for(const u of a)!t[u]&&t[u]!==0&&e.push(`è¾²æ›†è½‰æ›ç¼ºå°‘ ${u} è³‡æ–™`);return t.year&&(t.year<1900||t.year>2050)&&e.push("è¾²æ›†å¹´ä»½è¶…å‡ºæ”¯æ´ç¯„åœï¼ˆ1900-2050ï¼‰"),t.month&&(t.month<1||t.month>12)&&e.push("è¾²æ›†æœˆä»½ç„¡æ•ˆ"),t.day&&(t.day<1||t.day>30)&&e.push("è¾²æ›†æ—¥æœŸç„¡æ•ˆ"),{isValid:e.length===0,errors:e}}static checkLunarLibrary(){const t=[];return typeof window>"u"?{isValid:!0,errors:[]}:((typeof Solar>"u"||typeof Lunar>"u")&&t.push("lunar-javascript åº«æœªæ­£ç¢ºè¼‰å…¥ï¼Œè«‹é‡æ–°æ•´ç†é é¢"),{isValid:t.length===0,errors:t})}}const _e=X({__name:"BaziInputForm",emits:["submit"],setup(C,{emit:t}){const e=t,a=le({birthDate:"",birthTime:"",gender:"male",location:""}),u={birthDate:[{required:!0,message:"è«‹é¸æ“‡å‡ºç”Ÿæ—¥æœŸ",trigger:"change"}],birthTime:[{required:!0,message:"è«‹é¸æ“‡å‡ºç”Ÿæ™‚é–“",trigger:"change"}],gender:[{required:!0,message:"è«‹é¸æ“‡æ€§åˆ¥",trigger:"change"}]},m=()=>{const h=ae.validateBaziForm({birthDate:a.birthDate,birthTime:a.birthTime,gender:a.gender,location:{timezone:"Asia/Taipei"}});if(!h.isValid){M.error(h.errors.join("ã€"));return}const d=ae.checkLunarLibrary();if(!d.isValid){M.error(d.errors.join("ã€"));return}e("submit",a)};return(h,d)=>{const b=P("el-form-item"),r=P("el-date-picker"),n=P("el-time-picker"),i=P("el-radio"),p=P("el-radio-group"),l=P("el-input"),v=P("el-text"),E=P("el-button"),S=P("el-form");return c(),V(S,{ref:"baziForm",model:a,rules:u,onSubmit:re(m,["prevent"])},{default:k(()=>[_(b,{label:h.$t("astrology.bazi_detail.form.title")},null,8,["label"]),_(b,{label:h.$t("astrology.bazi_detail.form.birth_date"),prop:"birthDate"},{default:k(()=>[_(r,{modelValue:a.birthDate,"onUpdate:modelValue":d[0]||(d[0]=g=>a.birthDate=g),type:"date",placeholder:h.$t("astrology.bazi_detail.form.birth_date"),"value-format":"YYYY-MM-DD"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),_(b,{label:h.$t("astrology.bazi_detail.form.birth_time"),prop:"birthTime"},{default:k(()=>[_(n,{modelValue:a.birthTime,"onUpdate:modelValue":d[1]||(d[1]=g=>a.birthTime=g),placeholder:h.$t("astrology.bazi_detail.form.birth_time"),format:"HH:mm","value-format":"HH:mm"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),_(b,{label:h.$t("astrology.bazi_detail.form.gender"),prop:"gender"},{default:k(()=>[_(p,{modelValue:a.gender,"onUpdate:modelValue":d[2]||(d[2]=g=>a.gender=g)},{default:k(()=>[_(i,{value:"male"},{default:k(()=>[A(o(h.$t("form.genderOptions.male")),1)]),_:1}),_(i,{value:"female"},{default:k(()=>[A(o(h.$t("form.genderOptions.female")),1)]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["label"]),_(b,{label:h.$t("astrology.bazi_detail.form.location"),prop:"location"},{default:k(()=>[_(l,{modelValue:a.location,"onUpdate:modelValue":d[3]||(d[3]=g=>a.location=g),placeholder:"å‡ºç”Ÿåœ°é»ï¼ˆé¸å¡«ï¼Œå½±éŸ¿çœŸå¤ªé™½æ™‚è¨ˆç®—ï¼‰"},null,8,["modelValue"]),_(v,{type:"info",size:"small",style:{"margin-top":"5px",display:"block"}},{default:k(()=>d[4]||(d[4]=[A(" è¨»ï¼šå…«å­—è¨ˆç®—ä¸»è¦ä¾è³´æ™‚é–“ï¼Œåœ°é»ç‚ºé¸å¡«é …ç›® ")])),_:1,__:[4]})]),_:1},8,["label"]),_(b,null,{default:k(()=>[_(E,{type:"primary",onClick:m},{default:k(()=>[A(o(h.$t("form.submit")),1)]),_:1})]),_:1})]),_:1},8,["model"])}}}),ke=J(_e,[["__scopeId","data-v-a955d493"]]),Ee={key:0,class:"skeleton-card"},Se={key:1,class:"skeleton-chart"},$e={class:"skeleton-chart-grid"},Pe={class:"skeleton-chart-legend"},Ce={key:2,class:"skeleton-form"},ze={key:3,class:"skeleton-list"},Ye={key:4,class:"skeleton-text"},De={key:5,class:"skeleton-generic"},Te={class:"skeleton-content"},we=X({__name:"SkeletonLoader",props:{variant:{default:"generic"},formItems:{default:4},listItems:{default:3},textLines:{default:3}},setup(C){return(t,e)=>(c(),f("div",{class:L(["skeleton-loader",t.variant])},[t.variant==="card"?(c(),f("div",Ee,e[0]||(e[0]=[oe('<div class="skeleton-header" data-v-97f9069d><div class="skeleton-title" data-v-97f9069d></div><div class="skeleton-subtitle" data-v-97f9069d></div></div><div class="skeleton-content" data-v-97f9069d><div class="skeleton-line" data-v-97f9069d></div><div class="skeleton-line" data-v-97f9069d></div><div class="skeleton-line short" data-v-97f9069d></div></div><div class="skeleton-actions" data-v-97f9069d><div class="skeleton-button" data-v-97f9069d></div><div class="skeleton-button secondary" data-v-97f9069d></div></div>',3)]))):t.variant==="chart"?(c(),f("div",Se,[e[2]||(e[2]=s("div",{class:"skeleton-chart-header"},[s("div",{class:"skeleton-title"})],-1)),s("div",$e,[(c(),f(Y,null,D(12,a=>s("div",{key:a,class:"skeleton-chart-cell"},e[1]||(e[1]=[s("div",{class:"skeleton-char"},null,-1),s("div",{class:"skeleton-char"},null,-1)]))),64))]),s("div",Pe,[(c(),f(Y,null,D(4,a=>s("div",{class:"skeleton-legend-item",key:a})),64))])])):t.variant==="form"?(c(),f("div",Ce,[(c(!0),f(Y,null,D(t.formItems,a=>(c(),f("div",{class:"skeleton-form-item",key:a},e[3]||(e[3]=[s("div",{class:"skeleton-label"},null,-1),s("div",{class:"skeleton-input"},null,-1)])))),128)),e[4]||(e[4]=s("div",{class:"skeleton-submit-button"},null,-1))])):t.variant==="list"?(c(),f("div",ze,[(c(!0),f(Y,null,D(t.listItems,a=>(c(),f("div",{key:a,class:"skeleton-list-item"},e[5]||(e[5]=[s("div",{class:"skeleton-avatar"},null,-1),s("div",{class:"skeleton-list-content"},[s("div",{class:"skeleton-list-title"}),s("div",{class:"skeleton-list-description"})],-1)])))),128))])):t.variant==="text"?(c(),f("div",Ye,[(c(!0),f(Y,null,D(t.textLines,a=>(c(),f("div",{key:a,class:L(["skeleton-text-line",{short:a===t.textLines}])},null,2))),128))])):(c(),f("div",De,[e[6]||(e[6]=s("div",{class:"skeleton-header"},null,-1)),s("div",Te,[(c(),f(Y,null,D(3,a=>s("div",{class:"skeleton-line",key:a})),64))])]))],2))}}),Ae=J(we,[["__scopeId","data-v-97f9069d"]]),Be={class:"bazi-chart-display"},Ge={key:0,class:"loading-state"},Ve={key:1,class:"error-state"},Re={key:2,class:"chart-content"},Le={class:"chart-header"},Me={class:"fixed-mode-indicator"},Fe={class:"bazi-pillars"},Ie={class:"pillars-grid desktop-layout"},Ne=["onClick"],He={class:"pillar-header"},Oe={class:"pillar-stem"},je={class:"pillar-branch"},Ze={key:0,class:"pillar-god"},Ke={class:"pillar-elements"},Ue={class:"pillars-mobile mobile-layout"},qe=["onClick"],We={class:"pillar-card-header"},Xe={class:"pillar-name"},Je={class:"pillar-main"},Qe={class:"pillar-stem"},xe={class:"pillar-branch"},et={class:"pillar-card-content"},tt={key:0,class:"pillar-god-mobile"},at={class:"god-value"},st={class:"pillar-elements-mobile"},nt={class:"element-row"},lt={class:"element-row"},rt={key:0,class:"elements-section"},ot={class:"elements-chart"},it={class:"element-name"},ct={class:"element-bar"},dt={class:"element-count"},ut={key:1,class:"ten-gods-section"},mt={class:"ten-gods-grid"},ht={class:"pillar-name"},pt={key:2,class:"luck-section"},ft={class:"luck-details"},gt={class:"luck-item"},vt={class:"luck-label"},bt={class:"luck-value"},yt={class:"luck-item"},_t={class:"luck-label"},kt={class:"luck-value"},Et={key:3,class:"empty-state"},St=X({__name:"BaziChartDisplay",props:{baziResult:{default:null},tenGods:{default:null},elementsDistribution:{default:null},startLuckInfo:{default:null},isLoading:{type:Boolean,default:!1},error:{default:null},displayMode:{}},emits:["retry","pillar-click","save-record","update:displayMode"],setup(C,{emit:t}){const{t:e}=ie();ce(()=>{console.log("BaziChartDisplay component initializing")});const a=C,u=t,m=q("standard");console.log("å…«å­—å‘½ç›¤åˆå§‹åŒ–ï¼šä½¿ç”¨å›ºå®šæ¨¡å¼ï¼ˆstandardï¼‰"),de(m,l=>{u("update:displayMode",l)},{immediate:!0});const h=ee(()=>{if(!a.baziResult)return[];const l=a.baziResult.yearPillar&&a.baziResult.yearPillar.stem&&a.baziResult.yearPillar.branch,v=a.baziResult.monthPillar&&a.baziResult.monthPillar.stem&&a.baziResult.monthPillar.branch,E=a.baziResult.dayPillar&&a.baziResult.dayPillar.stem&&a.baziResult.dayPillar.branch,S=a.baziResult.hourPillar&&a.baziResult.hourPillar.stem&&a.baziResult.hourPillar.branch;return!l||!v||!E||!S?(console.warn("BaziChartDisplay: ä¸å®Œæ•´çš„å‘½ç›¤è³‡æ–™",a.baziResult),[]):[{name:e("baziChart.yearPillar"),stem:a.baziResult.yearPillar.stem,branch:a.baziResult.yearPillar.branch,stemElement:a.baziResult.yearPillar.stemElement||"",branchElement:a.baziResult.yearPillar.branchElement||""},{name:e("baziChart.monthPillar"),stem:a.baziResult.monthPillar.stem,branch:a.baziResult.monthPillar.branch,stemElement:a.baziResult.monthPillar.stemElement||"",branchElement:a.baziResult.monthPillar.branchElement||""},{name:e("baziChart.dayPillar"),stem:a.baziResult.dayPillar.stem,branch:a.baziResult.dayPillar.branch,stemElement:a.baziResult.dayPillar.stemElement||"",branchElement:a.baziResult.dayPillar.branchElement||""},{name:e("baziChart.hourPillar"),stem:a.baziResult.hourPillar.stem,branch:a.baziResult.hourPillar.branch,stemElement:a.baziResult.hourPillar.stemElement||"",branchElement:a.baziResult.hourPillar.branchElement||""}]}),d=ee(()=>a.elementsDistribution?Object.values(a.elementsDistribution).reduce((l,v)=>l+v,0):0),b=l=>({æœ¨:"wood",ç«:"fire",åœŸ:"earth",é‡‘:"metal",æ°´:"water"})[l]||"default",r=l=>d.value>0?l/d.value*100:0,n=l=>{if(!a.tenGods)return"";const E=["yearStemGod","monthStemGod","dayStemGod","hourStemGod"][l];return a.tenGods[E]||""},i=l=>({yearStemGod:e("baziChart.yearPillar"),monthStemGod:e("baziChart.monthPillar"),dayStemGod:e("baziChart.dayPillar"),hourStemGod:e("baziChart.hourPillar")})[l]||l,p=l=>{u("pillar-click",l)};return(l,v)=>{const E=P("el-icon"),S=P("el-tag");return c(),f("div",Be,[l.isLoading?(c(),f("div",Ge,[_(Ae,{variant:"chart"})])):l.error?(c(),f("div",Ve,[s("h3",null,o(l.$t("baziChart.loadError")),1),s("p",null,o(l.error),1),s("button",{onClick:v[0]||(v[0]=g=>l.$emit("retry")),class:"retry-button"},o(l.$t("baziChart.retry")),1)])):l.baziResult?(c(),f("div",Re,[s("div",Le,[s("h3",null,o(l.$t("baziChart.title")),1),s("div",Me,[_(S,{type:"info",size:"small",effect:"plain"},{default:k(()=>[_(E,null,{default:k(()=>[_(R(ue))]),_:1}),v[1]||(v[1]=A(" å›ºå®šæ¨¡å¼ "))]),_:1,__:[1]}),v[2]||(v[2]=s("span",{class:"mode-description"},"å…«å­—å‘½ç›¤ä¿æŒå®Œæ•´é¡¯ç¤º",-1))])]),s("div",Fe,[s("div",Ie,[(c(!0),f(Y,null,D(h.value,(g,$)=>(c(),f("div",{key:g.name,class:"pillar-column",onClick:w=>p(g.name)},[s("div",He,o(g.name),1),s("div",Oe,o(g.stem),1),s("div",je,o(g.branch),1),l.tenGods?(c(),f("div",Ze,o(n($)),1)):z("",!0),s("div",Ke,[s("span",{class:L(["stem-element",`element-${b(g.stemElement)}`])},o(g.stemElement),3),s("span",{class:L(["branch-element",`element-${b(g.branchElement)}`])},o(g.branchElement),3)])],8,Ne))),128))]),s("div",Ue,[(c(!0),f(Y,null,D(h.value,(g,$)=>(c(),f("div",{key:g.name,class:"pillar-card",onClick:w=>p(g.name)},[s("div",We,[s("h4",Xe,o(g.name),1),s("div",Je,[s("span",Qe,o(g.stem),1),s("span",xe,o(g.branch),1)])]),s("div",et,[l.tenGods?(c(),f("div",tt,[v[3]||(v[3]=s("span",{class:"god-label"},"åç¥ï¼š",-1)),s("span",at,o(n($)),1)])):z("",!0),s("div",st,[s("div",nt,[v[4]||(v[4]=s("span",{class:"element-label"},"å¤©å¹²äº”è¡Œï¼š",-1)),s("span",{class:L(["stem-element",`element-${b(g.stemElement)}`])},o(g.stemElement),3)]),s("div",lt,[v[5]||(v[5]=s("span",{class:"element-label"},"åœ°æ”¯äº”è¡Œï¼š",-1)),s("span",{class:L(["branch-element",`element-${b(g.branchElement)}`])},o(g.branchElement),3)])])])],8,qe))),128))])]),l.elementsDistribution?(c(),f("div",rt,[s("h4",null,o(l.$t("baziChart.elementsDistribution")),1),s("div",ot,[(c(!0),f(Y,null,D(l.elementsDistribution,(g,$)=>(c(),f("div",{key:$,class:"element-item"},[s("span",it,o($),1),s("div",ct,[s("div",{class:L(["element-fill",`element-${b($)}`]),style:me({width:`${r(g)}%`})},null,6),s("span",dt,o(g),1)])]))),128))])])):z("",!0),l.tenGods?(c(),f("div",ut,[s("h4",null,o(l.$t("baziChart.tenGodsAnalysis")),1),s("div",mt,[(c(!0),f(Y,null,D(l.tenGods,(g,$)=>(c(),f("div",{key:$,class:"ten-god-item"},[s("span",ht,o(i($)),1),s("span",{class:L(["god-name",`god-${g}`])},o(g),3)]))),128))])])):z("",!0),l.startLuckInfo?(c(),f("div",pt,[s("h4",null,o(l.$t("baziChart.luckInfo")),1),s("div",ft,[s("div",gt,[s("span",vt,o(l.$t("baziChart.startAge")),1),s("span",bt,o(l.startLuckInfo.age)+o(l.$t("baziChart.years")),1)]),s("div",yt,[s("span",_t,o(l.$t("baziChart.startYear")),1),s("span",kt,o(l.startLuckInfo.year)+o(l.$t("baziChart.yearUnit")),1)])])])):z("",!0)])):(c(),f("div",Et,[s("p",null,o(l.$t("baziChart.noData")),1)]))])}}}),$t=J(St,[["__scopeId","data-v-b83ea8f6"]]),O=["ç”²","ä¹™","ä¸™","ä¸","æˆŠ","å·±","åºš","è¾›","å£¬","ç™¸"],N=["å­","ä¸‘","å¯…","å¯","è¾°","å·³","åˆ","æœª","ç”³","é…‰","æˆŒ","äº¥"],Pt=["ç”²å­","ä¹™ä¸‘","ä¸™å¯…","ä¸å¯","æˆŠè¾°","å·±å·³","åºšåˆ","è¾›æœª","å£¬ç”³","ç™¸é…‰","ç”²æˆŒ","ä¹™äº¥","ä¸™å­","ä¸ä¸‘","æˆŠå¯…","å·±å¯","åºšè¾°","è¾›å·³","å£¬åˆ","ç™¸æœª","ç”²ç”³","ä¹™é…‰","ä¸™æˆŒ","ä¸äº¥","æˆŠå­","å·±ä¸‘","åºšå¯…","è¾›å¯","å£¬è¾°","ç™¸å·³","ç”²åˆ","ä¹™æœª","ä¸™ç”³","ä¸é…‰","æˆŠæˆŒ","å·±äº¥","åºšå­","è¾›ä¸‘","å£¬å¯…","ç™¸å¯","ç”²è¾°","ä¹™å·³","ä¸™åˆ","ä¸æœª","æˆŠç”³","å·±é…‰","åºšæˆŒ","è¾›äº¥","å£¬å­","ç™¸ä¸‘","ç”²å¯…","ä¹™å¯","ä¸™è¾°","ä¸å·³","æˆŠåˆ","å·±æœª","åºšç”³","è¾›é…‰","å£¬æˆŒ","ç™¸äº¥"],U=["æœ¨","ç«","åœŸ","é‡‘","æ°´"],B={ç”²:"æœ¨",ä¹™:"æœ¨",ä¸™:"ç«",ä¸:"ç«",æˆŠ:"åœŸ",å·±:"åœŸ",åºš:"é‡‘",è¾›:"é‡‘",å£¬:"æ°´",ç™¸:"æ°´"},H={å­:"æ°´",ä¸‘:"åœŸ",å¯…:"æœ¨",å¯:"æœ¨",è¾°:"åœŸ",å·³:"ç«",åˆ:"ç«",æœª:"åœŸ",ç”³:"é‡‘",é…‰:"é‡‘",æˆŒ:"åœŸ",äº¥:"æ°´"};class Ct{static calculateBazi(t){try{if(typeof Solar>"u"||typeof Lunar>"u")return console.error("lunar-javascript åº«æˆ–å…¶æ ¸å¿ƒçµ„ä»¶ (Solar, Lunar) æœªæ­£ç¢ºåŠ è¼‰ã€‚"),null;const e=t.solarDate;if(!e||isNaN(e.getTime()))throw console.error("ç„¡æ•ˆçš„æ—¥æœŸå°è±¡:",e),new Error("è¼¸å…¥çš„æ—¥æœŸç„¡æ•ˆï¼Œè«‹ç¢ºä¿æ ¼å¼æ­£ç¢º");const a=e.getFullYear(),u=e.getMonth()+1,m=e.getDate(),h=e.getHours(),d=e.getMinutes(),b=e.getSeconds();if(console.log("è½‰æ›æ—¥æœŸ:",{year:a,month:u,day:m,hour:h,minute:d,second:b}),isNaN(a)||isNaN(u)||isNaN(m))throw console.error("æ—¥æœŸè½‰æ›æ™‚å‡ºç¾NaNå€¼:",{year:a,month:u,day:m}),new Error(`è¾²æ›†è½‰æ›å¤±æ•—: ç„¡æ•ˆçš„å¹´(${a})ã€æœˆ(${u})æˆ–æ—¥(${m})`);const r=Solar.fromYmdHms(a,u,m,h,d,b);if(!r)throw new Error("ç„¡æ³•å‰µå»ºSolarå°è±¡ï¼Œè«‹æª¢æŸ¥æ—¥æœŸæ˜¯å¦æœ‰æ•ˆ");const n=r.getLunar();if(!n)throw new Error("ç„¡æ³•ç²å–è¾²æ›†æ—¥æœŸï¼Œè«‹æª¢æŸ¥lunar-javascriptåº«æ˜¯å¦æ­£ç¢ºå·¥ä½œ");const i=n.getYearGan(),p=n.getYearZhi(),l=n.getMonthGan(),v=n.getMonthZhi(),E=n.getDayGan(),S=n.getDayZhi(),g=n.getTimeInGanZhi(),$=g.substring(0,1),w=g.substring(1,2);return{yearPillar:{stem:i,branch:p,stemElement:B[i],branchElement:H[p]},monthPillar:{stem:l,branch:v,stemElement:B[l],branchElement:H[v]},dayPillar:{stem:E,branch:S,stemElement:B[E],branchElement:H[S]},hourPillar:{stem:$,branch:w,stemElement:B[$],branchElement:H[w]}}}catch(e){throw console.error("å…«å­—è¨ˆç®—éŒ¯èª¤ï¼š",e),e}}}const W={ç”²:!0,ä¹™:!1,ä¸™:!0,ä¸:!1,æˆŠ:!0,å·±:!1,åºš:!0,è¾›:!1,å£¬:!0,ç™¸:!1},j={æœ¨:{æœ¨:0,ç«:1,åœŸ:2,é‡‘:3,æ°´:4},ç«:{ç«:0,åœŸ:1,é‡‘:2,æ°´:3,æœ¨:4},åœŸ:{åœŸ:0,é‡‘:1,æ°´:2,æœ¨:3,ç«:4},é‡‘:{é‡‘:0,æ°´:1,æœ¨:2,ç«:3,åœŸ:4},æ°´:{æ°´:0,æœ¨:1,ç«:2,åœŸ:3,é‡‘:4}};class te{static getTenGodRelation(t,e){const a=B[t],u=B[e],m=W[t],h=W[e],d=j[a][u],b=m===h;return d===0?b?"æ¯”è‚©":"åŠ«è²¡":d===1?b?"é£Ÿç¥":"å‚·å®˜":d===2?b?"åè²¡":"æ­£è²¡":d===3?b?"ä¸ƒæ®º":"æ­£å®˜":b?"åå°":"æ­£å°"}static getMainStemTenGods(t){const e=t.dayPillar.stem;return{yearStemGod:this.getTenGodRelation(e,t.yearPillar.stem),monthStemGod:this.getTenGodRelation(e,t.monthPillar.stem),dayStemGod:this.getTenGodRelation(e,t.dayPillar.stem),hourStemGod:this.getTenGodRelation(e,t.hourPillar.stem)}}}class se{static calculateElementsDistribution(t){const e={æœ¨:0,ç«:0,åœŸ:0,é‡‘:0,æ°´:0},a=[t.yearPillar,t.monthPillar,t.dayPillar,t.hourPillar];for(const u of a)e[u.stemElement]++,e[u.branchElement]++;return e}}class Q{static calculateStartLuck(t,e){try{if(typeof t.getEightChar!="function")return console.warn("FortuneCycleCalculator: lunarDate.getEightChar is not a function."),null;const a=t.getEightChar();if(!a||typeof a.getYun!="function")return console.warn("FortuneCycleCalculator: eightChar is invalid or eightChar.getYun is not a function."),null;const u=t.getYearGanExact(),m=W[u];let h;e===0&&m||e===1&&!m?(h=0,console.log(`FortuneCycleCalculator: Yang Year (${u}) + Male OR Yin Year (${u}) + Female. Forward (é †è¡Œ). Param for getYun: 0`)):(h=1,console.log(`FortuneCycleCalculator: Yin Year (${u}) + Male OR Yang Year (${u}) + Female. Backward (é€†è¡Œ). Param for getYun: 1`));const d=a.getYun(h);if(!d)return console.error("FortuneCycleCalculator: eightChar.getYun(direction) did not return a valid Yun instance."),null;if(typeof d.getStartYear!="function"||typeof d.getStartSolar!="function")return console.error("FortuneCycleCalculator: The Yun instance is missing getStartYear or getStartSolar methods."),null;const b=d.getStartYear(),r=d.getStartSolar();return!r||typeof r.getYear!="function"?(console.error("FortuneCycleCalculator: Yun instance.getStartSolar() did not return a valid Solar date object with getYear method."),null):{age:b,year:r.getYear()}}catch(a){return console.error(`Error during fortune cycle calculation: lunarDate=${t.toString()}, gender=${e}`,a),null}}static calculateDecennialCycles(t,e,a,u=8){try{const h=Solar.fromDate(e).getLunar(),d=this.calculateStartLuck(h,a);if(!d)throw new Error("ç„¡æ³•è¨ˆç®—èµ·é‹æ™‚é–“");const b=t.monthPillar.stem,r=t.monthPillar.branch,n=O.indexOf(b),i=N.indexOf(r),p=t.yearPillar.stem,l=W[p],v=a===0&&l||a===1&&!l,E=[];for(let S=0;S<u;S++){let g=n,$=i;v?(g=(n+S)%O.length,$=(i+S)%N.length):(g=(n-S+O.length)%O.length,$=(i-S+N.length)%N.length);const w=O[g],y=N[$],I=d.age+S*10,Z=I+9,G=d.year+S*10,ne=G+9;E.push({index:S+1,stem:w,branch:y,stemElement:B[w],branchElement:H[y],startAge:I,endAge:Z,startYear:G,endYear:ne})}return E}catch(m){return console.error("è¨ˆç®—å¤§é‹éŒ¯èª¤:",m),[]}}static calculateAnnualLuck(t,e,a=30){try{const u=t.getFullYear(),m=[];for(let h=0;h<a;h++){const d=e+h,b=d-u+1,r=(d-1984+60)%60,n=Pt[r],i=n[0],p=n[1];m.push({year:d,age:b,stem:i,branch:p,stemElement:B[i],branchElement:H[p]})}return m}catch(u){return console.error("è¨ˆç®—æµå¹´éŒ¯èª¤:",u),[]}}}var F;(function(C){C.BASIC="basic",C.INTERMEDIATE="intermediate",C.EXPERT="expert"})(F||(F={}));class x{static generateBasicInterpretation(t){const e=t.dayPillar.stem,a=B[e],u=se.calculateElementsDistribution(t),m=[],h=[],d=Object.entries(u);d.sort((p,l)=>l[1]-p[1]),m.push(d[0][0],d[1][0]),h.push(d[d.length-1][0],d[d.length-2][0]);const b=[],r=[];if(m.includes(a)){const p=[2,3];for(const v of U){const E=j[a][v];p.includes(E)&&b.push(v)}const l=[0,4];for(const v of U){const E=j[a][v];l.includes(E)&&r.push(v)}}else{const p=[0,4];for(const v of U){const E=j[a][v];p.includes(E)&&b.push(v)}const l=[2,3];for(const v of U){const E=j[a][v];l.includes(E)&&r.push(v)}}const n=this.generatePersonalityTraits(t,a),i=this.generateKeyAges(t);return{general:`æ‚¨çš„å…«å­—å‘½ç›¤ä¸­ï¼Œæ—¥ä¸»ç‚º${e}ï¼Œäº”è¡Œå±¬${a}ã€‚å¾æ•´é«”ä¾†çœ‹ï¼Œå‘½ç›¤ä¸­${m.join("ã€")}è¼ƒç‚ºæ—ºç››ï¼Œè€Œ${h.join("ã€")}ç›¸å°è¼ƒå¼±ã€‚`,personalityTraits:n,favorableElements:b,unfavorableElements:r,lifePatterns:[`æ‚¨çš„å‘½ç›¤é¡¯ç¤ºï¼Œäººç”Ÿç™¼å±•æœƒç¶“æ­·${this.generateLifePatternDescription(t)}`,`æ‚¨é©åˆç™¼å±•çš„æ–¹å‘èˆ‡${b.join("ã€")}ç›¸é—œçš„é ˜åŸŸã€‚`],keyAges:i,career:this.generateCareerAdvice(t,b),relationships:this.generateRelationshipAdvice(t),health:this.generateHealthAdvice(t,a),level:F.BASIC}}static generatePersonalityTraits(t,e){const a=[];switch(e){case"æœ¨":a.push("æ€§æ ¼æ­£ç›´é–‹æœ—ï¼Œå…·æœ‰ç†æƒ³å’ŒæŠ±è² ","åšäº‹æœ‰è¨ˆåŠƒæ€§ï¼Œå–„æ–¼çµ„ç¹”å’Œè¦åŠƒ","æœ‰åŒæƒ…å¿ƒå’Œå…¬æ­£æ„Ÿ");break;case"ç«":a.push("ç†±æƒ…æ´‹æº¢ï¼Œå……æ»¿æ´»åŠ›","å–„æ–¼è¡¨é”ï¼Œäººç·£è‰¯å¥½","ç›´è¦ºæ•éŠ³ï¼Œå‰µé€ åŠ›å¼·");break;case"åœŸ":a.push("è¸å¯¦ç©©é‡ï¼Œå¿ èª å¯é ","æ„å¿—å …å®šï¼Œåšäº‹æœ‰è€å¿ƒ","æ€æ…®å‘¨å…¨ï¼Œè™•äº‹åœ“è");break;case"é‡‘":a.push("åšäº‹æœ‰æ¢ç†ï¼Œè™•äº‹å…¬æ­£","æ„å¿—å …å¼·ï¼Œè‡ªå¾‹æ€§é«˜","å–„æ–¼åˆ†æï¼Œåˆ¤æ–·åŠ›å¼·");break;case"æ°´":a.push("æ€ç¶­éˆæ´»ï¼Œé©æ‡‰åŠ›å¼·","å–„æ–¼æºé€šï¼Œæ´å¯ŸåŠ›æ•éŠ³","å¥½å¥‡å¿ƒå¼·ï¼Œæ±‚çŸ¥æ¬²æ—ºç››");break}const u=t.yearPillar.stemElement;u!==e&&a.push(`å—${u}çš„å½±éŸ¿ï¼Œç«¥å¹´æ™‚æœŸå½¢æˆäº†å …éŸŒçš„ç”Ÿå­˜èƒ½åŠ›`);const m=t.monthPillar.stemElement;return m!==e&&a.push(`åœ¨${m}çš„è–°é™¶ä¸‹ï¼ŒåŸ¹é¤Šäº†è‰¯å¥½çš„ç¤¾äº¤èƒ½åŠ›`),a}static generateLifePatternDescription(t){const e=t.yearPillar.branch;return t.monthPillar.branch,t.dayPillar.branch,["å¯…","å¯","è¾°"].includes(e)?"æ—©å¹´æ‰“æ‹¼ï¼Œä¸­å¹´å¹³ç©©ï¼Œæ™šå¹´å®‰é€¸çš„éç¨‹ã€‚":["å·³","åˆ","æœª"].includes(e)?"æ—©å¹´æ³¢æŠ˜ï¼Œä¸­å¹´ç™¼å±•ï¼Œæ™šå¹´æ”¶ç©«çš„æ­·ç¨‹ã€‚":["ç”³","é…‰","æˆŒ"].includes(e)?"æ—©å¹´ç©©å®šï¼Œä¸­å¹´å¥®é¬¥ï¼Œæ™šå¹´è±ç››çš„æ—…ç¨‹ã€‚":"ç¨ç‰¹çš„æˆé•·éšæ®µï¼Œéœ€è¦åœ¨ä¸åŒæ™‚æœŸé©æ‡‰ä¸åŒæŒ‘æˆ°ã€‚"}static generateKeyAges(t){const a=[];return[t.yearPillar.branch,t.monthPillar.branch,t.dayPillar.branch,t.hourPillar.branch].forEach(m=>{const h=N.indexOf(m);h>=0&&a.push(10+h*5)}),Array.from(new Set(a)).sort((m,h)=>m-h)}static generateCareerAdvice(t,e){let a="å¾è·æ¥­é¸æ“‡ä¾†çœ‹ï¼Œ";return e.includes("æœ¨")&&(a+="æ‚¨é©åˆæ•™è‚²ã€æ³•å¾‹ã€æ–‡å­¸ã€æ¤ç‰©ç›¸é—œã€ç’°ä¿ç­‰é ˜åŸŸï¼›"),e.includes("ç«")&&(a+="æ‚¨é©åˆè¨­è¨ˆã€æ¼”è—ã€é¤é£²ã€ç‡ˆå…‰ã€é›»å­ç­‰è¡Œæ¥­ï¼›"),e.includes("åœŸ")&&(a+="æ‚¨é©åˆæˆ¿åœ°ç”¢ã€è¾²æ¥­ã€å»ºç¯‰ã€è¡Œæ”¿ç®¡ç†ç­‰å·¥ä½œï¼›"),e.includes("é‡‘")&&(a+="æ‚¨é©åˆé‡‘èã€ç å¯¶ã€æ©Ÿæ¢°ã€ITã€å¾‹å¸«ç­‰è·æ¥­ï¼›"),e.includes("æ°´")&&(a+="æ‚¨é©åˆç‡ŸéŠ·ã€æ—…éŠã€é‹è¼¸ã€å“²å­¸ã€æ°´ç”¢ç­‰é ˜åŸŸï¼›"),a}static generateRelationshipAdvice(t){const e=t.dayPillar.stem;switch(t.dayPillar.branch,e){case"ç”²":case"ä¹™":return"æ‚¨æ€§æ ¼é–‹æœ—ï¼Œå¾…äººçœŸèª ï¼Œæ˜“çµäº¤æœ‹å‹ï¼Œä½†æœ‰æ™‚å›ºåŸ·å·±è¦‹ã€‚åœ¨äººéš›é—œä¿‚ä¸­ï¼Œå»ºè­°å¤šè½å–ä»–äººæ„è¦‹ï¼ŒåŸ¹é¤ŠåŒ…å®¹å¿ƒã€‚";case"ä¸™":case"ä¸":return"æ‚¨ç†±æƒ…æ´»æ½‘ï¼Œäººç·£è‰¯å¥½ï¼Œå–„æ–¼è¡¨é”ï¼Œä½†æœ‰æ™‚éæ–¼ç›´ç‡ã€‚åœ¨äººéš›é—œä¿‚ä¸­ï¼Œå»ºè­°æ§åˆ¶æƒ…ç·’æ³¢å‹•ï¼Œå¢åŠ è€å¿ƒå’Œç©©å®šæ€§ã€‚";case"æˆŠ":case"å·±":return"æ‚¨ç‚ºäººåšé“ï¼Œé‡è¦–æƒ…èª¼ï¼Œè™•äº‹åœ“èï¼Œä½†æœ‰æ™‚å„ªæŸ”å¯¡æ–·ã€‚åœ¨äººéš›é—œä¿‚ä¸­ï¼Œå»ºè­°å¢å¼·æ±ºæ–·åŠ›ï¼Œæ˜ç¢ºè¡¨é”è‡ªå·±çš„æ„é¡˜ã€‚";case"åºš":case"è¾›":return"æ‚¨è™•äº‹å…¬æ­£ï¼Œé‡è¦–åŸå‰‡ï¼Œè²¬ä»»æ„Ÿå¼·ï¼Œä½†æœ‰æ™‚éæ–¼åš´è‚…ã€‚åœ¨äººéš›é—œä¿‚ä¸­ï¼Œå»ºè­°å¢åŠ éˆæ´»æ€§å’Œå¹½é»˜æ„Ÿã€‚";case"å£¬":case"ç™¸":return"æ‚¨æ€ç¶­æ´»èºï¼Œå–„æ–¼æºé€šï¼Œé©æ‡‰èƒ½åŠ›å¼·ï¼Œä½†æœ‰æ™‚é¡¯å¾—æ·±ä¸å¯æ¸¬ã€‚åœ¨äººéš›é—œä¿‚ä¸­ï¼Œå»ºè­°å¢åŠ çœŸèª åº¦å’Œç©©å®šæ€§ã€‚";default:return"æ‚¨åœ¨äººéš›é—œä¿‚ä¸­å±•ç¾å‡ºç¨ç‰¹çš„ç‰¹è³ªï¼Œå–„æ–¼ç†è§£ä»–äººä¸¦å»ºç«‹æœ‰æ„ç¾©çš„é€£çµã€‚"}}static generateHealthAdvice(t,e){switch(e){case"æœ¨":return"å¥åº·æ–¹é¢éœ€æ³¨æ„è‚è†½ç³»çµ±ã€çœ¼ç›ã€è‚Œè…±ç­‰ã€‚å»ºè­°ä¿æŒæƒ…ç·’å¹³å’Œï¼Œè¦å¾‹ä½œæ¯ï¼Œé©ç•¶é‹å‹•ã€‚";case"ç«":return"å¥åº·æ–¹é¢éœ€æ³¨æ„å¿ƒè‡Ÿã€è¡€æ¶²å¾ªç’°ã€çœ¼ç›ç­‰ã€‚å»ºè­°é¿å…éåº¦å‹ç´¯ï¼Œä¿æŒå……è¶³ç¡çœ ï¼Œæ³¨æ„è¡€å£“ç®¡ç†ã€‚";case"åœŸ":return"å¥åº·æ–¹é¢éœ€æ³¨æ„è„¾èƒƒã€æ¶ˆåŒ–ç³»çµ±ã€è‚Œè‚‰ç­‰ã€‚å»ºè­°é£²é£Ÿè¦å¾‹ï¼Œé¿å…éé£Ÿï¼Œé©ç•¶å¢åŠ æˆ¶å¤–æ´»å‹•ã€‚";case"é‡‘":return"å¥åº·æ–¹é¢éœ€æ³¨æ„è‚ºéƒ¨ã€å‘¼å¸ç³»çµ±ã€çš®è†šç­‰ã€‚å»ºè­°ä¿æŒå‘¼å¸é †æš¢ï¼Œé¿å…ç°å¡µç’°å¢ƒï¼Œæ³¨æ„çš®è†šä¿é¤Šã€‚";case"æ°´":return"å¥åº·æ–¹é¢éœ€æ³¨æ„è…è‡Ÿã€æ³Œå°¿ç³»çµ±ã€è€³æœµç­‰ã€‚å»ºè­°æ³¨æ„ä¿æš–ï¼Œé¿å…éåº¦å‹ç´¯ï¼Œä¿æŒå……è¶³æ°´åˆ†ã€‚";default:return"å¥åº·æ–¹é¢å»ºè­°å®šæœŸé«”æª¢ï¼Œä¿æŒå‡è¡¡é£²é£Ÿå’Œè¦å¾‹ä½œæ¯ï¼Œé©ç•¶åƒåŠ é«”è‚²æ´»å‹•ã€‚"}}static generateAnnualAnalysis(t,e,a=F.BASIC){const u=t.dayPillar.stem,m=e.stem,h=e.branch,d=te.getTenGodRelation(u,m);let b="",r="",n="",i="";switch(b=`${e.year}å¹´ï¼ˆ${m}${h}å¹´ï¼‰ï¼Œæ‚¨${e.age}æ­²ã€‚æ­¤å¹´æµå¹´å¤©å¹²ç‚º${m}ï¼Œåœ°æ”¯ç‚º${h}ï¼Œèˆ‡æ‚¨çš„æ—¥ä¸»${u}å½¢æˆã€Œ${d}ã€çš„é—œä¿‚ã€‚`,d){case"æ¯”è‚©":r="èˆ‡å¿—åŒé“åˆè€…åˆä½œï¼Œå…±åŒç™¼å±•",n="å¯èƒ½é¢è‡¨ç«¶çˆ­ï¼Œéœ€è¦èˆ‡äººå”èª¿åˆä½œ",i="äº‹æ¥­ç™¼å±•ï¼Œåœ˜éšŠåˆä½œï¼Œäººè„ˆæ“´å±•";break;case"åŠ«è²¡":r="ç¨ç«‹è‡ªä¸»ï¼Œæå‡å€‹äººèƒ½åŠ›",n="äººéš›é—œä¿‚å¯èƒ½ç·Šå¼µï¼Œéœ€æ§åˆ¶æƒ…ç·’",i="è‡ªæˆ‘æå‡ï¼Œèƒ½åŠ›å±•ç¾ï¼Œå€‹äººçªç ´";break;case"é£Ÿç¥":r="å‰µæ„ç™¼æ®ï¼Œäº«å—ç”Ÿæ´»",n="å¯èƒ½éæ–¼äº«æ¨‚ï¼Œéœ€è¦å¹³è¡¡å·¥ä½œèˆ‡ä¼‘é–’",i="è—è¡“å‰µä½œï¼Œæ•™è‚²åŸ¹è¨“ï¼Œå¥åº·æ”¹å–„";break;case"å‚·å®˜":r="å­¸ç¿’æ–°çŸ¥ï¼Œæ“´å±•è¦–é‡",n="å¯èƒ½éæ–¼è¡å‹•ï¼Œéœ€æ§åˆ¶è¨€è¡Œ",i="å­¸è¡“ç ”ç©¶ï¼ŒæŠ€èƒ½æå‡ï¼Œå‰µæ–°ç™¼æ˜";break;case"åè²¡":r="å°‹æ‰¾é¡å¤–æ”¶å…¥ï¼ŒæŠ•è³‡ç†è²¡",n="è²¡å‹™ä¸Šå¯èƒ½æœ‰æ³¢å‹•ï¼Œéœ€è¬¹æ…æ±ºç­–",i="æŠ•è³‡ç†è²¡ï¼Œå‰¯æ¥­ç™¼å±•ï¼Œå¶ç„¶ä¹‹è²¡";break;case"æ­£è²¡":r="ç©©å®šæ”¶å…¥ï¼Œç©ç´¯è²¡å¯Œ",n="å·¥ä½œå£“åŠ›å¯èƒ½å¢åŠ ï¼Œéœ€è¦å¹³è¡¡ä»˜å‡ºèˆ‡å›å ±",i="è·ä½æ™‰å‡ï¼Œæ”¶å…¥å¢åŠ ï¼Œè²¡å‹™æ”¹å–„";break;case"ä¸ƒæ®º":r="ç«¶çˆ­çªç ´ï¼Œè¿æ¥æŒ‘æˆ°",n="å¯èƒ½é¢è‡¨æ¬ŠåŠ›è¡çªï¼Œéœ€è¦é©ç•¶å¦¥å”",i="é ˜å°è§’è‰²ï¼Œç«¶çˆ­å„ªå‹¢ï¼Œæ¬Šå¨å»ºç«‹";break;case"æ­£å®˜":r="è¦ç¯„è¡Œç‚ºï¼Œéµå®ˆç´€å¾‹",n="å¯èƒ½å—åˆ°ç´„æŸï¼Œéœ€è¦éµå®ˆè¦å‰‡",i="å®˜æ–¹èªå¯ï¼Œåè­½æå‡ï¼Œæ­£å¼èº«ä»½";break;case"åå°":r="å­¸ç¿’æˆé•·ï¼Œå…§åœ¨æå‡",n="å¯èƒ½æ€æ…®éå¤šï¼Œéœ€è¦å¯¦éš›è¡Œå‹•",i="å­¸è¡“é€²æ­¥ï¼Œæ™ºæ…§å¢é•·ï¼Œéˆæ€§æå‡";break;case"æ­£å°":r="ç©©å®šç™¼å±•ï¼Œæ²‰æ¾±ç©ç´¯",n="å¯èƒ½éæ–¼ä¿å®ˆï¼Œéœ€è¦é©åº¦å‰µæ–°",i="æ–‡æ†‘è­‰æ›¸ï¼ŒçŸ¥è­˜ç©ç´¯ï¼Œå…§åœ¨æˆé•·";break}return{overview:b,focus:r,challenges:n,opportunities:i,level:a}}static generateDecennialAnalysis(t,e,a=F.BASIC){const u=t.dayPillar.stem,m=e.stem,h=e.branch,d=te.getTenGodRelation(u,m),b=`ç¬¬${e.index}å¤§é‹ï¼ˆ${m}${h}ï¼‰ï¼Œå¾${e.startAge}æ­²åˆ°${e.endAge}æ­²ï¼ˆ${e.startYear}å¹´-${e.endYear}å¹´ï¼‰ã€‚æ­¤å¤§é‹å¤©å¹²ç‚º${m}ï¼Œåœ°æ”¯ç‚º${h}ï¼Œèˆ‡æ‚¨çš„æ—¥ä¸»${u}å½¢æˆã€Œ${d}ã€çš„é—œä¿‚ã€‚`;let r="",n="",i="",p="";switch(d){case"æ¯”è‚©":case"åŠ«è²¡":r="äº‹æ¥­ä¸Šå¯èƒ½éœ€è¦èˆ‡äººåˆä½œæˆ–ç«¶çˆ­ï¼Œé©åˆç™¼å±•åœ˜éšŠå”ä½œæˆ–ç¨ç«‹å‰µæ¥­ã€‚",n="èº«é«”å¥åº·ç‹€æ³è‰¯å¥½ï¼Œä½†éœ€æ³¨æ„æƒ…ç·’ç®¡ç†ï¼Œé¿å…éåº¦å‹ç´¯ã€‚",i="äººéš›é—œä¿‚æ´»èºï¼Œå¯èƒ½çµäº¤å¿—åŒé“åˆçš„æœ‹å‹ï¼Œä½†éœ€è™•ç†å¥½ç«¶çˆ­é—œä¿‚ã€‚",p="è²¡é‹æ³¢å‹•ï¼Œæ”¶å…¥ä¸»è¦ä¾†è‡ªå€‹äººåŠªåŠ›å’Œåœ˜éšŠåˆä½œã€‚";break;case"é£Ÿç¥":case"å‚·å®˜":r="é©åˆç™¼å±•å‰µæ„ã€æ•™è‚²ã€è—è¡“æˆ–æŠ€è¡“é¡å·¥ä½œï¼Œæœ‰æ©Ÿæœƒå±•ç¾å€‹äººæ‰è¯ã€‚",n="éœ€æ³¨æ„æ¶ˆåŒ–ç³»çµ±å’Œæƒ…ç·’ç©©å®šï¼Œä¿æŒæ¨‚è§€å¿ƒæ…‹æœ‰åˆ©å¥åº·ã€‚",i="äººç·£è‰¯å¥½ï¼Œå®¹æ˜“å¸å¼•è¿½éš¨è€…ï¼Œä½†éœ€è­¦æƒ•éæ–¼è‡ªæˆ‘è¡¨ç¾ã€‚",p="è²¡é‹ä¸ç©©å®šä½†æœ‰äº®é»ï¼Œå¯èƒ½é€šéæ‰è—æˆ–å‰µæ„ç²å¾—æ”¶å…¥ã€‚";break;case"åè²¡":case"æ­£è²¡":r="äº‹æ¥­ç™¼å±•é †åˆ©ï¼Œæœ‰æ©Ÿæœƒç²å¾—æ™‰å‡æˆ–åŠ è–ªï¼Œè²¡å‹™æ–¹é¢æœ‰æ‰€æ”¹å–„ã€‚",n="éœ€æ³¨æ„å£“åŠ›ç®¡ç†ï¼Œå·¥ä½œèˆ‡ä¼‘æ¯å¹³è¡¡ï¼Œé¿å…éåº¦å‹ç´¯ã€‚",i="äººéš›é—œä¿‚ä»¥å¯¦ç”¨ç‚ºä¸»ï¼Œå¯èƒ½çµè­˜æœ‰åƒ¹å€¼çš„å•†æ¥­å¤¥ä¼´ã€‚",p="è²¡é‹è‰¯å¥½ï¼Œå¯èƒ½æœ‰æ„å¤–æ”¶å…¥æˆ–æŠ•è³‡æ©Ÿæœƒï¼Œä½†éœ€è¬¹æ…ç†è²¡ã€‚";break;case"ä¸ƒæ®º":case"æ­£å®˜":r="äº‹æ¥­ä¸Šå¯èƒ½é¢è‡¨æŒ‘æˆ°ä½†ä¹Ÿæœ‰çªç ´ï¼Œé©åˆå¾äº‹ç®¡ç†ã€æ³•å¾‹æˆ–æ¬Šå¨æ€§å·¥ä½œã€‚",n="éœ€æ³¨æ„å£“åŠ›å’Œæƒ…ç·’ç®¡ç†ï¼Œé¿å…éåº¦ç·Šå¼µå’Œç„¦æ…®ã€‚",i="äººéš›é—œä¿‚å¯èƒ½è¼ƒç‚ºç·Šå¼µï¼Œéœ€è¦è™•ç†å¥½æ¬ŠåŠ›å’Œç«¶çˆ­é—œä¿‚ã€‚",p="è²¡é‹ç©©å®šï¼Œæ”¶å…¥ä¸»è¦ä¾†è‡ªæ­£è·å’Œå°ˆæ¥­èƒ½åŠ›ã€‚";break;case"åå°":case"æ­£å°":r="é©åˆå­¸è¡“ç ”ç©¶ã€æ•™è‚²æˆ–éœ€è¦å°ˆæ¥­çŸ¥è­˜çš„å·¥ä½œï¼Œæœ‰æ©Ÿæœƒæ·±é€ æˆ–è€ƒå–è­‰æ›¸ã€‚",n="éœ€æ³¨æ„è…è‡Ÿå’Œç¥ç¶“ç³»çµ±ï¼Œä¿æŒå……è¶³ä¼‘æ¯å’Œå¿ƒæ…‹å¹³å’Œã€‚",i="äººéš›é—œä¿‚è¼ƒç‚ºå…§æ–‚ï¼Œå¯èƒ½çµè­˜æœ‰å­¸è­˜çš„äººæˆ–å°å¸«ã€‚",p="è²¡é‹ç·©æ…¢ä½†ç©©å®šï¼Œæ”¶å…¥å¯èƒ½ä¾†è‡ªçŸ¥è­˜å’Œå°ˆæ¥­é ˜åŸŸã€‚";break}return{overview:b,career:r,health:n,relationships:i,wealth:p,level:a}}}const zt={class:"bazi-container"},Yt={class:"card-header"},Dt={key:0,class:"header-actions"},Tt={class:"view-description"},wt={class:"interpretation-section"},At={class:"key-ages"},Bt={key:0},Gt={key:1,class:"cycle-details"},Vt={class:"detail-item"},Rt={class:"detail-item"},Lt={class:"detail-item"},Mt={class:"detail-item"},Ft={class:"annual-filter"},It={key:0},Nt={key:1,class:"annual-details"},Ht={class:"detail-item"},Ot={class:"detail-item"},jt={class:"detail-item"},Zt={class:"placeholder"},Kt=X({__name:"BaziView",setup(C){T.getOrCreateSessionId();const t=q(null),e=q(null),a=q(""),u=ee(()=>{var n;if(!((n=t.value)!=null&&n.annualLuck))return[];if(!a.value.trim())return t.value.annualLuck;const r=a.value.trim();return t.value.annualLuck.filter(i=>i.year.toString().includes(r))}),m=()=>{ve.confirm("ç¢ºå®šè¦æ¸…é™¤ç•¶å‰çš„å…«å­—è¨ˆç®—çµæœå—ï¼Ÿ","æ¸…é™¤è³‡æ–™",{confirmButtonText:"ç¢ºå®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(()=>{T.clearAnalysisData("bazi"),t.value=null,e.value=null,M.success("å…«å­—è³‡æ–™å·²æ¸…é™¤")}).catch(()=>{})},h=async r=>{try{if(M.info("æ­£åœ¨è¨ˆç®—å…«å­—..."),e.value=r,T.saveToStorage(T.STORAGE_KEYS.BAZI_BIRTH_INFO,r),!r.birthDate||!r.birthDate.match(/^\d{4}-\d{2}-\d{2}$/))throw new Error("å‡ºç”Ÿæ—¥æœŸæ ¼å¼ç„¡æ•ˆï¼Œè«‹ä½¿ç”¨YYYY-MM-DDæ ¼å¼");if(r.birthTime&&!r.birthTime.match(/^\d{2}:\d{2}$/))throw new Error("å‡ºç”Ÿæ™‚é–“æ ¼å¼ç„¡æ•ˆï¼Œè«‹ä½¿ç”¨HH:MMæ ¼å¼");const n=r.gender==="male"?0:1,i=new Date(r.birthDate);if(isNaN(i.getTime()))throw new Error("ç„¡æ•ˆçš„æ—¥æœŸï¼š"+r.birthDate+"ï¼Œè«‹ç¢ºä¿æ ¼å¼ç‚ºYYYY-MM-DD");if(r.birthTime){const[p,l]=r.birthTime.split(":");if(i.setHours(parseInt(p,10),parseInt(l,10),0,0),isNaN(i.getTime()))throw new Error("ç„¡æ•ˆçš„æ™‚é–“ï¼š"+r.birthTime+"ï¼Œè«‹ç¢ºä¿æ ¼å¼ç‚ºHH:MM")}console.log("ç”¨æ–¼å…«å­—è¨ˆç®—çš„æ—¥æœŸç‰©ä»¶:",i.toString());try{const p=Ct.calculateBazi({solarDate:i});if(!p)throw new Error("å…«å­—è¨ˆç®—å¤±æ•—ï¼Œè«‹æª¢æŸ¥ lunar-javascript åº«æ˜¯å¦æ­£ç¢ºè¼‰å…¥");const l=te.getMainStemTenGods(p),v=se.calculateElementsDistribution(p),S=Solar.fromDate(i).getLunar(),g=Q.calculateStartLuck(S,n),$=Q.calculateDecennialCycles(p,i,n,8);$.forEach(G=>{G.analysis=x.generateDecennialAnalysis(p,G,F.BASIC)});const w=new Date().getFullYear(),y=Q.calculateAnnualLuck(i,w,30);y.forEach(G=>{G.analysis=x.generateAnnualAnalysis(p,G,F.BASIC)});const I=x.generateBasicInterpretation(p),Z={...p,mainTenGods:l,elementsDistribution:v,startLuckInfo:g,decennialCycles:$,annualLuck:y,interpretation:I};t.value=Z,T.saveToStorage(T.STORAGE_KEYS.BAZI_CHART,Z),M.success("å…«å­—è¨ˆç®—å®Œæˆ")}catch(p){throw console.error("å…«å­—è¨ˆç®—éç¨‹ä¸­éŒ¯èª¤:",p),new Error(p instanceof Error?`å…«å­—è¨ˆç®—å¤±æ•—: ${p.message}`:"å…«å­—è¨ˆç®—éç¨‹ä¸­ç™¼ç”ŸæœªçŸ¥éŒ¯èª¤ï¼Œè«‹ç¨å¾Œå†è©¦")}}catch(n){console.error("å…«å­—è¡¨å–®è™•ç†éŒ¯èª¤:",n),M({message:n instanceof Error?n.message:"å…«å­—è¨ˆç®—å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦",type:"error",duration:5e3,showClose:!0})}},d=()=>{try{console.log("é–‹å§‹å¾ sessionStorage è¼‰å…¥å…«å­—è³‡æ–™");const r=Object.keys(sessionStorage).filter(p=>p.startsWith("peixuan_"));console.log("sessionStorage ä¸­çš„ç›¸é—œéµ:",r);const n=T.getFromStorage(T.STORAGE_KEYS.BAZI_BIRTH_INFO);n?(console.log("æ‰¾åˆ°ä¿å­˜çš„å…«å­—å‡ºç”Ÿè³‡è¨Š"),e.value=n):console.log("æœªæ‰¾åˆ°ä¿å­˜çš„å…«å­—å‡ºç”Ÿè³‡è¨Š");const i=T.getFromStorage(T.STORAGE_KEYS.BAZI_CHART);if(i){console.log("æ‰¾åˆ°ä¿å­˜çš„å…«å­—å‘½ç›¤è³‡æ–™");try{if(!i.yearPillar||!i.monthPillar||!i.dayPillar||!i.hourPillar)throw console.warn("ä¿å­˜çš„å…«å­—å‘½ç›¤è³‡æ–™ç¼ºå°‘å¿…è¦çš„æŸ±ä½è³‡è¨Š"),new Error("å‘½ç›¤è³‡æ–™ä¸å®Œæ•´");t.value=i}catch(p){console.error("è§£æä¿å­˜çš„å…«å­—å‘½ç›¤è³‡æ–™æ™‚å‡ºéŒ¯:",p)}}else console.log("æœªæ‰¾åˆ°ä¿å­˜çš„å…«å­—å‘½ç›¤è³‡æ–™");try{console.log("ä½¿ç”¨å¢å¼·ç‰ˆå­˜å„²æœå‹™é©—è­‰å…«å­—è³‡æ–™"),be.validateStorageData()}catch(p){console.error("é©—è­‰å…«å­—è³‡æ–™æ™‚å‡ºéŒ¯:",p)}console.log("å¾ sessionStorage è¼‰å…¥çš„å…«å­—è³‡æ–™ç¸½çµ:",{birthInfo:!!e.value,baziChart:!!t.value})}catch(r){console.error("å¾ sessionStorage è¼‰å…¥å…«å­—è³‡æ–™æ™‚å‡ºéŒ¯:",r),T.clearAnalysisData("bazi")}},b=()=>{d()};return he(()=>{console.log("BaziView çµ„ä»¶å·²æ›è¼‰");try{b()}catch(r){console.error("å…«å­—çµ„ä»¶åˆå§‹åŒ–éç¨‹ä¸­ç™¼ç”ŸéŒ¯èª¤:",r),T.clearAnalysisData("bazi"),M.warning("å…«å­—è³‡æ–™è¼‰å…¥æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œå·²é‡ç½®åˆ†æç‹€æ…‹")}}),(r,n)=>{const i=P("el-button"),p=P("el-alert"),l=P("el-card"),v=P("el-col"),E=P("el-tag"),S=P("el-divider"),g=P("el-input"),$=P("el-icon"),w=P("el-row");return c(),f("div",zt,[_(w,{gutter:20},{default:k(()=>[_(v,{span:24,class:"mb-4"},{default:k(()=>[_(l,{shadow:"hover"},{header:k(()=>[s("div",Yt,[s("span",null,o(r.$t("astrology.bazi_detail.title")),1),t.value?(c(),f("div",Dt,[_(i,{type:"danger",icon:R(pe),onClick:m,size:"small"},{default:k(()=>n[1]||(n[1]=[A(" æ¸…é™¤è³‡æ–™ ")])),_:1,__:[1]},8,["icon"])])):z("",!0)])]),default:k(()=>[s("div",Tt,[s("p",null,o(r.$t("astrology.bazi_detail.description")),1),t.value?(c(),V(p,{key:0,title:"ğŸ’¡ æç¤º",description:"æ‚¨å¯ä»¥ä½¿ç”¨ã€Œå‘½é‹æ´æ‚‰ã€åŠŸèƒ½ä¾†ç²å¾—å…«å­—èˆ‡ç´«å¾®æ–—æ•¸çš„å¤šç¶­åº¦æ´å¯Ÿåˆ†æ",type:"info",closable:!1,"show-icon":"",class:"mt-3 text-center-alert"})):z("",!0)]),_(ye,{class:"mt-3"})]),_:1})]),_:1}),_(v,{xs:24,sm:24,md:12,lg:12,xl:12},{default:k(()=>[_(l,{shadow:"hover"},{header:k(()=>[s("span",null,o(r.$t("astrology.bazi_detail.inputSection")),1)]),default:k(()=>[_(ke,{onSubmit:h})]),_:1})]),_:1}),_(v,{xs:24,sm:24,md:12,lg:12,xl:12},{default:k(()=>[t.value?(c(),V(l,{key:0,shadow:"hover"},{header:k(()=>n[2]||(n[2]=[s("span",null,"åˆ†æçµæœ",-1)])),default:k(()=>[_(R(fe),null,{default:k(()=>[_(R(K),{label:"å…«å­—å‘½ç›¤"},{default:k(()=>[_($t,{baziResult:t.value,tenGods:t.value.mainTenGods,elementsDistribution:t.value.elementsDistribution,startLuckInfo:t.value.startLuckInfo},null,8,["baziResult","tenGods","elementsDistribution","startLuckInfo"])]),_:1}),t.value.interpretation?(c(),V(R(K),{key:0,label:"å‘½ç›¤è§£è®€"},{default:k(()=>[s("div",wt,[n[3]||(n[3]=s("h3",null,"å‘½ç›¤ç¸½è«–",-1)),s("p",null,o(t.value.interpretation.general),1),n[4]||(n[4]=s("h3",null,"æ€§æ ¼ç‰¹è³ª",-1)),s("ul",null,[(c(!0),f(Y,null,D(t.value.interpretation.personalityTraits,(y,I)=>(c(),f("li",{key:I},o(y),1))),128))]),n[5]||(n[5]=s("h3",null,"äº‹æ¥­æ–¹å‘",-1)),s("p",null,o(t.value.interpretation.career),1),n[6]||(n[6]=s("h3",null,"äººéš›é—œä¿‚",-1)),s("p",null,o(t.value.interpretation.relationships),1),n[7]||(n[7]=s("h3",null,"å¥åº·å»ºè­°",-1)),s("p",null,o(t.value.interpretation.health),1),n[8]||(n[8]=s("h3",null,"é‡è¦å¹´é½¡",-1)),s("div",At,[(c(!0),f(Y,null,D(t.value.interpretation.keyAges,y=>(c(),V(E,{key:y,type:"success",effect:"plain",class:"mr-2 mb-2"},{default:k(()=>[A(o(y)+" æ­² ",1)]),_:2},1024))),128))])])]),_:1})):z("",!0),t.value.decennialCycles&&t.value.decennialCycles.length>0?(c(),V(R(K),{key:1,label:"å¤§é‹"},{default:k(()=>[(c(!0),f(Y,null,D(t.value.decennialCycles,y=>(c(),f("div",{key:y.index,class:"decennial-cycle"},[_(S,null,{default:k(()=>[A("ç¬¬ "+o(y.index)+" å¤§é‹",1)]),_:2},1024),s("h4",null,o(y.stem)+o(y.branch)+" ("+o(y.startYear)+"å¹´-"+o(y.endYear)+"å¹´ï¼Œ"+o(y.startAge)+"-"+o(y.endAge)+"æ­²)",1),y.analysis?(c(),f("p",Bt,o(y.analysis.overview),1)):z("",!0),y.analysis?(c(),f("div",Gt,[s("div",Vt,[n[9]||(n[9]=s("h5",null,"äº‹æ¥­",-1)),s("p",null,o(y.analysis.career),1)]),s("div",Rt,[n[10]||(n[10]=s("h5",null,"è²¡å¯Œ",-1)),s("p",null,o(y.analysis.wealth),1)]),s("div",Lt,[n[11]||(n[11]=s("h5",null,"äººéš›é—œä¿‚",-1)),s("p",null,o(y.analysis.relationships),1)]),s("div",Mt,[n[12]||(n[12]=s("h5",null,"å¥åº·",-1)),s("p",null,o(y.analysis.health),1)])])):z("",!0)]))),128))]),_:1})):z("",!0),t.value.annualLuck&&t.value.annualLuck.length>0?(c(),V(R(K),{key:2,label:"æµå¹´"},{default:k(()=>[s("div",Ft,[_(g,{modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=y=>a.value=y),placeholder:"æœå°‹å¹´ä»½...",clearable:""},null,8,["modelValue"])]),(c(!0),f(Y,null,D(u.value,y=>(c(),f("div",{key:y.year,class:"annual-luck"},[_(S,null,{default:k(()=>[A(o(y.year)+"å¹´",1)]),_:2},1024),s("h4",null,o(y.stem)+o(y.branch)+" ("+o(y.age)+"æ­²)",1),y.analysis?(c(),f("p",It,o(y.analysis.overview),1)):z("",!0),y.analysis?(c(),f("div",Nt,[s("div",Ht,[n[13]||(n[13]=s("h5",null,"å¹´åº¦é‡é»",-1)),s("p",null,o(y.analysis.focus),1)]),s("div",Ot,[n[14]||(n[14]=s("h5",null,"æŒ‘æˆ°",-1)),s("p",null,o(y.analysis.challenges),1)]),s("div",jt,[n[15]||(n[15]=s("h5",null,"æ©Ÿé‡",-1)),s("p",null,o(y.analysis.opportunities),1)])])):z("",!0)]))),128))]),_:1})):z("",!0)]),_:1})]),_:1})):(c(),V(l,{key:1,shadow:"hover"},{default:k(()=>[s("div",Zt,[_($,{size:64,color:"#c0c4cc"},{default:k(()=>[_(R(ge))]),_:1}),n[16]||(n[16]=s("p",null,"è«‹å¡«å¯«å·¦å´è¡¨å–®é–‹å§‹åˆ†æ",-1))])]),_:1}))]),_:1})]),_:1})])}}}),Wt=J(Kt,[["__scopeId","data-v-be847998"]]);export{Wt as default};
