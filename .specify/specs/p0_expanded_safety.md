1. **🔴 Blocker Resolution**:
   - [ ] 明確大限宮干計算規則（五虎遁 or 其他？）
   - [ ] 明確流年宮干計算規則（五虎遁 or 其他？）
   - [ ] 準備至少 5 個真實命盤 Golden Standard

2. **🟡 規格修訂**:
   - [ ] 更新 `p0_expanded_implementation.md`，移除矛盾邏輯
   - [ ] 明確三層四化的宮干計算差異（如有）
   - [ ] 添加驗證案例與預期結果

3. **🟢 Pre-Implementation**:
   - [ ] Code Review: 確認 `calculator.ts:671` 參數語義修正
   - [ ] 設計測試案例覆蓋所有 10 個天干
   - [ ] 準備 D1 緩存清理腳本

---

### 📊 **風險矩陣總結**

```
            │ 低影響   │ 中影響   │ 高影響
────────────┼──────────┼──────────┼──────────
高概率      │          │ Phase1   │ 同時修正三層 ← 🚫 不建議
中概率      │          │ Phase3   │ API破壞性變更 ← ⚠️ 已識別
低概率      │ 類型安全 │ Phase2   │
```

**建議執行路徑**: Phase 1 (本命) → Phase 2 (研究) → Phase 3 (完整) ← ✅ **最安全的路徑**

---

## 🎓 **結論**

**擴展的 P0 規格存在以下問題**:
1. ✅ 本命四化修正邏輯**正確**
2. ❌ 大限/流年四化邏輯**仍然錯誤且矛盾**
3. ❌ 參數語義不清（`lifePalaceStem` vs `yearStem`）
4. ❌ 缺乏驗證案例與 Golden Standard

**強烈建議**: 
- **不要**直接按當前規格實施全部三層修正
- **先實施** Phase 1 (本命四化)，累積經驗與驗證方法
- **研究確認** Phase 2 (大限/流年規則)，避免錯誤修正
- **最後實施** Phase 3 (完整三層)，確保正確性

**預估時間**: 
- Phase 1: 5-7 工作日
- Phase 2: 3-5 工作日（研究 + 文檔）
- Phase 3: 7-10 工作日
- **總計**: 15-22 工作日 (3-4.5 週)

---

是否需要我：
1. 生成詳細的 Phase 1 實施計劃？
2. 準備大限/流年宮干計算的命理研究清單？
3. 創建測試案例模板與驗證腳本？
